!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("bsv")):"function"==typeof define&&define.amd?define(["bsv"],e):"object"==typeof exports?exports.Run=e(require("bsv")):t.Run=e(t.bsv)}(window,(function(__WEBPACK_EXTERNAL_MODULE__8__){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=47)}([function(t,e,n){(function(e){const{h:r,g:o,_:i,P:s,O:c,v:a,S:u,A:h,I:f,j:l,R:p,$:y,k:d,C:w,N:g,U:b,D:_,F:m}=n(1),{ua:E}=n(26),v=n(41),P=n(3),{M:O,B:S}=n(13),A=n(10),{G:x}=n(4),{L:I,J:T,W:R,H:j,V:k}=A,$=n(18),C=n(9),U=n(5),N=n(27),M=n(22),F=U.K,D="Code",B=new WeakMap,G={},L=new Map,J={};class Code{constructor(t,e=!0,r=[]){const o=et(t);if(o)return o;const i=new v,s=new W,c=new(n(17))(i);return v.Y(i,c),s.q(c,i),B.set(c,s),C.Z.add(c),t&&s.X(t,e,r),r.push(c),c}toString(){const t=B.get(this);if(!t)return x((()=>this.toString()));const e=t.tt,n=t.et;return t.nt?n.startsWith("class")?`class ${e.name} { [native code] }`:`function ${e.name}() { [native code] }`:n}sync(t={}){if(P.rt&&P.ot(D,"Sync",r(this)),n(24).it)throw new Error("sync disabled during atomic update");const e=B.get(this);if(s(e,"sync unavailable"),e.nt)return;return n(40)(this,t).then((()=>this))}upgrade(t,e=!0,o){const i=n(15),c=n(6);if(P.rt&&P.ot(D,"Upgrade",r(this),"to",r(t)),c.ct.st.length)throw new Error("upgrade unavailable");const a=B.get(this);s(a&&!a.nt,"upgrade unavailable");const u=r(this)+" is non-upgradable";s(x((()=>!f(this,"upgradable")||this.upgradable)),u);const h=new N(this);try{const n=[];a.X(t,e,n,o),c.ct.at((()=>{n.length&&X(...n),i.ut(this,h)}))}catch(t){throw h.ht(t),t}return this}auth(){P.rt&&P.ot(D,"Auth",r(this));const t=B.get(this);s(t,"auth unavailable on non-jigs"),s(!t.nt,"auth unavailable on native jigs");const e=n(6);s(!m(e.ct.ft,this),"auth unavailable on new jigs");return n(15).lt(this),this}destroy(){P.rt&&P.ot(D,"Destroy",r(this));const t=B.get(this);s(t&&!t.nt,"destroy unavailable");return n(15).yt(this),this}[Symbol.hasInstance](t){if("object"!=typeof t||!t)return!1;const e=et(this);return!!e&&x((()=>{let n=Object.getPrototypeOf(t);for(;n;){if(n.constructor.origin&&n.constructor.origin===e.origin)return!0;n=Object.getPrototypeOf(n)}return!1}))}static[Symbol.hasInstance](t){return C.Z.has(t)}}class W{q(t,e){this.dt=void 0,this.tt=e,this.wt=t,this.gt=void 0,this.et=void 0,this._t=!1,this.bt=!1,this.Pt=!1,this.Et="";try{this.Et=o().Ot().network}catch(t){}this.nt=void 0,this.vt=!1}X(t,e=!0,n=[],o){if(P.rt&&P.ot(D,"Install",r(t)),this._t)return p(t===this.dt||t===this.wt),this.St();p(!this.nt);const s=v.At(this.tt);G[this.Et]=G[this.Et]||new Map,G[this.Et].delete(this.dt),e&&G[this.Et].set(t,this.wt);try{this.xt(t,e,n),this.It(),this.jt(this.bt?s:null),this.dt=t,this.gt=t.name,this.et=o||d(this.tt.toString(),this.gt),this.Pt=e,this._t=!1,this.bt=!0,this.nt=!1,this.vt=!1,f(t,"presets")&&(S(this.wt,(t=>{if(t instanceof Code&&t!==this.wt){const e=r(t)+" must have presets";i(!T(t.location).undeployed,e)}})),this.Tt())}catch(e){throw G[this.Et].delete(t),this.local&&G[this.Et].set(this.dt,this.wt),v.Rt(this.tt,s),e}}$t(){s(!this.nt,"Cannot uninstall native code"),this.bt&&(G[this.Et].delete(this.dt),this.bt=!1),this._t&&(L.delete(this.dt),this._t=!1),this.dt&&(I.forEach((t=>{delete this.dt[t]})),delete this.dt.presets),this.dt=void 0,this.Pt=!1}kt(t){if(this._t)return;let e=!0;try{o()}catch(t){e=!1}if(e)this.X(t);else{if(P.rt&&P.ot(D,"Preinstall",r(t)),this.bt||this.nt)throw new Error("Cannot preinstall "+r(t));L.set(t,this.wt);try{this.xt(t,!0),this.dt=t,this.gt=t.name,this.et=d(this.tt.toString(),this.gt),this.Pt=!0,this._t=!0,this.bt=!1,this.nt=!1,this.vt=!1}catch(e){throw L.delete(t),e}}}St(){if(this._t){P.rt&&P.ot(D,"Postinstall",r(this.dt)),this.Et=o().Ot().network;try{L.delete(this.dt),G[this.Et]=G[this.Et]||new Map,G[this.Et].set(this.dt,this.wt),this.It(),this.jt(),this._t=!1,this.bt=!0}catch(t){throw L.set(this.dt,this.wt),G[this.Et].delete(this.dt),this.Et="",t}}}xt(t,e=!1,o=[]){const i=e?q(this.wt,t,e,o)[0]:t,Jig=n(2),Berry=n(7);let c=null;if(y(t,Jig))c=$.ha();else{const e=t.toString().startsWith("class");c=$.Ua(e)}if(M.Dt(this.wt).Ut=c,this.bt){const e=y(this.dt,Jig),n=y(t,Jig);s(e===n,"Cannot change staticness of code in upgrade")}const a="Cannot upgrade from berry class: "+r(this.dt),u="Cannot upgrade to berry class: "+r(t);s(!(this.bt&&y(this.dt,Berry)),a),s(!(this.bt&&y(t,Berry)),u);Object.getOwnPropertyNames(i.prototype).filter((t=>"constructor"!==t)).forEach((t=>{const e=n(17),r=$.Ft(this.wt,!0,!1);i.prototype[t]=new e(i.prototype[t],r)})),v.Rt(this.tt,i)}It(){x((()=>{if(f(this.wt,"presets")){const t=this.wt.presets[this.Et];Object.getOwnPropertyNames(t||{}).forEach((e=>l(this.wt,e,t[e]))),delete this.wt.presets}}))}jt(t){x((()=>{t?I.forEach((e=>l(this.wt,e,t[e]))):f(this.wt,"location")||A.q(this.wt)}))}Mt(t,n=!1){P.rt&&P.ot(D,"Install native",r(t)),p(void 0===this.nt),p(!c(t)),p(!(t.name in J));const[o,i]=U.Bt(t,{},!0,!1);Object.assign(i,t.deps);const s=t.sealed,a=t.upgradable;e.env.COVER&&Object.keys(o).forEach((t=>{delete o[t]})),f(o,"sealed")&&l(o,"sealed",s),f(o,"upgradable")&&l(o,"upgradable",a),v.Rt(this.tt,o),o.origin="native://"+t.name,o.location="native://"+t.name,o.nonce=0,o.owner=null,o.satoshis=null,J[t.name]=this.wt,M.Dt(this.wt).Ut=$.Gt(),this.dt=t,this.gt=t.name,this.et=d(this.tt.toString(),this.gt),this._t=!1,this.bt=!0,this.Pt=!0,this.nt=!0,this.vt=n}Lt(){P.Jt&&P.Wt(D,"Deploy",r(this.wt)),this.St(),s(!this.nt,"Cannot deploy native code"),X(this.wt)}Tt(){if(!this.Pt)return;const t=this.dt;f(t,"presets")||l(t,"presets",{}),f(t.presets,this.Et)||l(t.presets,this.Et,{}),x((()=>{I.forEach((e=>{const n=t.presets[this.Et];f(n,e)||l(n,e,this.wt[e]),f(t,e)||l(t,e,this.wt[e])}))}))}Ht(){return{wt:this.wt,dt:this.dt,gt:this.gt,et:this.et,Vt:v.At(this.tt)}}zt(t){p(this.wt===t.wt),this.dt=t.dt,this.gt=t.gt,this.et=t.et,v.Rt(this.tt,t.Vt)}}function H(t){i("function"==typeof t,"Only functions and classes are supported: "+r(t)),Y(t);const Jig=n(2);y(t,Jig)&&function(t){const e=Object.getOwnPropertyNames(t.prototype),r=w.find((t=>e.includes(t)))||b.find((t=>e.includes(t)))||I.find((t=>e.includes(t)));i(!r,"Must not have any reserved jig words: "+r);const Jig=n(2),o=[];let s=t;for(;s!==Jig;)o.push(s),s=Object.getPrototypeOf(s);const c=/\s+constructor\s*\(/;if(o.some((t=>c.test(t.toString()))))throw new Error("Jig must use init() instead of constructor()")}(t);const Berry=n(7);y(t,Berry)&&function(t){const e=Object.getOwnPropertyNames(t.prototype),r=["location"],o=w.find((t=>e.includes(t)))||r.find((t=>e.includes(t)));i(!o,"Must not have any reserved berry words: "+o);const Berry=n(7),s=[];let c=t;for(;c!==Berry;)s.push(c),c=Object.getPrototypeOf(c);const a=/\s+constructor\s*\(/;if(s.some((t=>a.test(t.toString()))))throw new Error("Berry must use init() instead of constructor()")}(t),i(!t.prototype||t.prototype.constructor===t,"Prototypal inheritance not supported: "+r(t)),i(!a(t),"Anonymous types not supported: "+r(t)),i(t!==Code,"The Code class itself cannot be used in code"),i(-1===t.toString().indexOf("[native code]"),"Cannot install intrinsic: "+r(t)),function(t){const e="Symbol methods not supported";x((()=>{s(!Object.getOwnPropertySymbols(t).length,e),s(!Object.getOwnPropertySymbols(t.prototype).length,e)}))}(t),function(t){const e="Getters and setters not supported",n=t=>s(!("get"in t||"set"in t),e);x((()=>{Object.getOwnPropertyNames(t).map((e=>Object.getOwnPropertyDescriptor(t,e))).forEach((t=>n(t))),Object.getOwnPropertyNames(t.prototype).map((e=>Object.getOwnPropertyDescriptor(t.prototype,e))).forEach((t=>n(t)))}))}(t)}function V(t){f(t,"sealed")&&z(t.sealed),f(t,"upgradable")&&K(t.upgradable)}function z(t){i(!0===t||!1===t||"owner"===t,"Invalid sealed option: "+t)}function K(t){i(!0===t||!1===t,"Invalid upgradable option: "+t)}function Y(t){const e=Object.getOwnPropertyNames(t),n=w.find((t=>e.includes(t)))||g.find((t=>e.includes(t)));i(!n,"Must not have any reserved words: "+n)}function q(t,e,n=!1,r){H(e),function(t,e){if(!e.bt)return;if(s(!e.nt,"Cannot upgrade native code"),i(!(t instanceof Code),"Cannot upgrade to a code jig"),f(t,"presets")){const n=t.presets[e.Et],r="Preset bindings not supported for upgrades",o=t=>s(!(t in n),r);A.L.forEach((t=>o(t)))}const n=x((()=>e.wt.origin));s(n!==A.Kt,"Cannot upgrade undeployed code")}(e,B.get(t));const o=c(e),a=o&&new Code(o,n,r);a&&Code.Yt(a).St(),function(t,e){if(f(t,"deps")){if(i(h(t.deps),"deps must be a basic object"),e){const n=t.deps[e.name],r=et(n);i(!n||_(r,e),"Parent dependency mismatch")}i(!(t.name in t.deps),"Illegal dependency")}}(e,a),function(t){if(!f(t,"presets"))return;const e=t.presets;i(h(e),"presets must be a basic object");for(const t of Object.keys(e)){const n=e[t];i(h(n),`Presets for ${t} network must be an object`);const r=I.some((t=>!u(n[t]))),o=!I.some((t=>u(n[t])));if(i(!r||o,t+" presets not fully defined"),r){const t=T(n.location);i(t.txid&&("vout"in t||"vdel"in t)&&!("berry"in t),"Bad location");const e=T(n.origin);i(e.txid&&("vout"in e||"vdel"in e)&&!("berry"in e),"Bad origin"),R(n.nonce),j(n.owner,!0),k(n.satoshis)}i(!("deps"in n),t+" presets must not contain deps"),i(!("presets"in n),t+" presets must not contain presets"),Y(n),V(n)}}(e),V(e),function(t){const e=Object.getOwnPropertyNames(t),n=I.find((t=>e.includes(t)));i(!n,"Must not have any bindings: "+n)}(e);const p={};a&&(p[a.name]=a);const[y,d]=U.Bt(e,p,!1,!0);Object.defineProperty(y,"name",{value:e.name,configurable:!0});const w=Object.assign({},e),g=O(w,F,(t=>"function"==typeof t?new Code(t,n,r):void 0));return E(g),"deps"in g||(g.deps=new F.Object),a&&(g.deps[a.name]=a),Object.keys(g.deps||{}).forEach((e=>{Object.defineProperty(d,e,{get:()=>t.deps[e],set:n=>{t.deps[e]=n},configurable:!0,enumerable:!0})})),l(d,e.name,t),g.deps=Q(t,d,g.deps),Object.keys(g).forEach((t=>l(y,t,g[t]))),Z(d),[y,d]}function Z(t){if("caller"in t)return;const e=n(6);Object.defineProperty(t,"caller",{get:()=>e.ct.qt(),set:()=>{throw new Error("Cannot set caller")},configurable:!0,enumerable:!0})}function Q(t,e,n){return new F.Proxy(n,{defineProperty:(n,r,o)=>{const i=Reflect.defineProperty(n,r,o);return Object.defineProperty(e,r,{get:()=>t.deps[r],set:e=>{t.deps[r]=e},configurable:!0,enumerable:!0}),i},deleteProperty:(t,n)=>{const r=Reflect.deleteProperty(t,n);return Reflect.deleteProperty(e,n),"caller"===n&&Z(e),r},set:(n,r,o,i)=>{l(n,r,o);return Object.defineProperty(e,r,{get:()=>t.deps[r],set:e=>{t.deps[r]=e},configurable:!0,enumerable:!0}),!0}})}function X(...t){const e=n(15),r=new Set;t.forEach((t=>{const e=B.get(t);p(!e.nt);tt(t=et(t)).forEach((t=>r.add(t)))})),r.size&&e.Lt([...r])}function tt(t,e=new Set){if(p(t instanceof Code),e.has(t))return;Code.Yt(t).St();const r=x((()=>t.location)),{undeployed:o}=T(r);if(!o)return e;const i=c(t);i&&tt(i,e),e.add(t);const s=x((()=>Object.assign({},t))),a=n(9);return S(s,(t=>(t instanceof Code&&tt(t,e),!(t instanceof a)))),e}function et(t){if(B.has(t))return t;if(L.has(t))return L.get(t);let e="";try{e=o().Ot().network}catch(t){}const n=G[e];if(!n)return;if(n.has(t))return n.get(t);const r=f(t,"presets")&&f(t.presets,e)&&t.presets[e].location;if(r)for(const t of n.values())if(x((()=>t.location))===r)return t}Code.Zt=X,Code.Qt=et,Code.Xt=function(t){p(t.startsWith("native://"));const e=t.slice("native://".length),n=J[e];if(n)return p(!B.get(n).vt),n},Code.te=function(){let t="";try{t=o().Ot().network}catch(t){}function e(t,e){U.ee.includes(e.name)||I.forEach((t=>{delete e[t]}))}P.Jt&&P.Wt(D,"Deactivate",t,"bindings"),G[t]&&x((()=>G[t].forEach(e)))},Code.ne=function(){let t="";try{t=o().Ot().network}catch(t){}function e(e,n){f(n,"presets")&&f(n.presets,t)?I.forEach((e=>l(n,e,n.presets[t][e]))):U.ee.includes(n.name)||A.q(n)}P.Jt&&P.Wt(D,"Activate",t,"bindings"),G[t]&&x((()=>G[t].forEach(e)))},Code.re=q,Code.oe=Q,Code.kt=function(t){const e=et(t);if(e)return e;const n=new Code;return Code.Yt(n).kt(t),n},Code.Yt=t=>B.get(et(t)),Code.ie=z,Code.se=K,t.exports=Code}).call(this,n(30))},function(t,e,n){const{ArgumentError,StateError,InternalError,TimeoutError}=n(12),r=n(37),{G:o}=n(4),i=n(9);function s(){const t=n(36);if(!t.ce)throw new Error("Run instance not active");return t.ce}function c(t){return o((()=>{switch(typeof t){case"string":return`"${t.length>20?t.slice(0,20)+"…":t}"`;case"object":{if(!t)return"null";if(!t.constructor.name)return"[anonymous object]";const Jig=n(2),Berry=n(7);return`[${t instanceof Jig?"jig":t instanceof Berry?"berry":"object"} ${t.constructor.name}]`}case"function":{let e=null;const Code=n(0);if(t instanceof Code)e=Code.prototype.toString.apply(t);else{e="function"==typeof t.toString&&!t.toString.toString().startsWith("class")?t.toString():Function.prototype.toString.apply(t)}if(/^\(/.test(e)||/^function\s*\(/.test(e)||/^[a-zA-Z0-9_$]+\s*=>/.test(e))return"[anonymous function]";return/^class\s*{/.test(e)?"[anonymous class]":t.name}case"undefined":return"undefined";default:return t.toString()}}))}function a(t){return"object"==typeof t&&!!t&&2===b(t)}function u(t){return Array.isArray(t)&&3===b(t)}function h(t){const e=n(5),r=e.K;return(t instanceof e.ae.Set||t instanceof r.Set)&&3===b(t)}function f(t){const e=n(5),r=e.K;return(t instanceof e.ae.Map||t instanceof r.Map)&&3===b(t)}function l(t){const e=n(5),r=e.K;return(t instanceof e.ae.Uint8Array||t instanceof r.Uint8Array)&&4===b(t)}function p(t){if("object"!=typeof t||!t)return!1;const Code=n(0);if(!(t.constructor instanceof Code))return!1;if(t instanceof n(2))return!1;return!(t instanceof n(7))}function y(t){const e=n(5);return!!e.ue.has(t)||!!e.he.has(t)}const d=/^class\s*{/,w=/^class\s+(extends)?\s+\S+\s*{/,g=/^function\s*\(/;function b(t){if(!t)return 0;let e=0;do{e++,t=Object.getPrototypeOf(t)}while(t);return e}function _(t,e){const r=n(9),Berry=n(7),{J:i}=n(10);return t instanceof r&&(e instanceof r&&o((()=>{if(t===e)return!0;if(t instanceof Berry||e instanceof Berry)return t instanceof Berry&&(e instanceof Berry&&(!t.location.startsWith("error://")&&(!e.location.startsWith("error://")&&t.location===e.location)));if(i(t.origin).error)return!1;if(i(e.origin).error)return!1;if(t.origin!==e.origin)return!1;if(t.location!==e.location){const n=`${c(t)}: ${t.location}`,r=`${c(e)}: ${e.location}`;throw new Error(`Inconsistent worldview\n\n${n}\n${r}`)}return!0})))}const m=(t,e)=>t.some((t=>_(t,e)));function E(t){if(null===t)return Number.MAX_VALUE;if(-1===t)return Number.MAX_VALUE;if(t===1/0)return Number.MAX_VALUE;if("number"!=typeof t)throw new Error("Invalid limit");if(t<0)throw new Error("Invalid limit");return t}const v=r(P);function P(t,e){if(typeof t!=typeof e)return"symbol"==typeof t?1:-1;"symbol"==typeof t&&(t=t.toString()),"symbol"==typeof e&&(e=e.toString());const n=parseInt(t),r=parseInt(e),o=n.toString()===t,i=r.toString()===e;return o&&!i?-1:i&&!o?1:o&&i?n-r:t<e?-1:e<t?1:0}t.exports={C:["latest","recent","mustBeLatest","mustBeRecent","encryption","blockhash","blocktime","blockheight","recover"],N:["toString","upgrade","sync","destroy","auth","load"],U:["sync"],fa:[],g:s,R:function(t){if(!t)throw new InternalError("assert failed")},_:function(t,e){if(!t)throw new ArgumentError(e)},P:function(t,e){if(!t)throw new StateError(e)},fe:function(t){return t.startsWith("main")?"mainnet":"testnet"},O:function(t){if("function"!=typeof t)return;const e=n(5),Code=n(0),r=e.K.Object,o=e.ae.Object,i=Object.getPrototypeOf(t);return i!==o.getPrototypeOf(o)&&i!==r.getPrototypeOf(r)&&i!==Code.prototype?i:void 0},le:function(t){const e=t.match(/^\s*class\s+[a-zA-Z0-9_$]+\s+extends\s+([a-zA-Z0-9_$]+)\s*{/);return e&&e[1]},$:function(t,e){for(;t;)if((t=Object.getPrototypeOf(t))===e)return!0;return!1},h:c,pe:function(t,e){const n=Object.getPrototypeOf(e);if(n.prototype){const r=/^class\s+[a-zA-Z0-9_$]+\s+extends\s+[a-zA-Z0-9_.$]+\s*{/;return t.replace(r,`class ${e.name} extends ${n.name} {`)}const r=t.match(/^([a-zA-Z0-9_$]+)\s*\(/);return r&&"function"!==r[1]?"function "+t:t},ye:function(t){const e=t.match(/^(function\s+)([a-zA-Z0-9$_]+)(\s*)\((.*)/ms);if(e)return`${e[1]}${e[3]}(${e[4]}`;const n=t.match(/^(class\s+)([a-zA-Z0-9$_]+)(\s*){(.*)/ms);if(n)return`${n[1]}${n[3]}{${n[4]}`;const r=t.match(/^(class\s+)([a-zA-Z0-9$_]+)(\s*)extends(.*)/ms);if(r)return`${r[1]}${r[3]}extends${r[4]}`;throw new Error("Bad source code: "+t)},k:function(t,e){if(n(5).ee.includes(e))return t;const r=t.match(/^(function\s)(.*)/ms);if(r)return`${r[1]}${e}${r[2]}`;const o=t.match(/^(class\s)(.*)/ms);if(o)return`${o[1]}${e}${o[2]}`;throw new Error("Bad source code: "+t)},A:a,de:u,we:h,ge:f,_e:l,be:p,S:function(t){return void 0===t},me:function(t){return"boolean"==typeof t},Pe:y,Ee:function(t){const{B:e}=n(13);let r=!0;try{e(t,(t=>{r=r&&(t=>!(void 0!==t&&"boolean"!=typeof t&&"number"!=typeof t&&"string"!=typeof t&&null!==t&&(y(t)||!a(t)&&!u(t)&&!h(t)&&!f(t)&&!l(t)&&!p(t)&&!(t instanceof i))))(t)}))}catch(t){}return r},v:function(t){if("function"!=typeof t)return!1;if(!t.name)return!0;const e=t.toString();return!e.startsWith("class")&&!e.startsWith("function")||(d.test(e)||w.test(e)||g.test(e))},Oe:b,ve:function(t,e){if(!t||"function"!=typeof t&&"object"!=typeof t)return;const n=Object.getOwnPropertyDescriptor(t,e);return n&&n.value},I:function(t,e){return!(!t||"function"!=typeof t&&"object"!=typeof t)&&("string"==typeof e?Object.getOwnPropertyNames(t).includes(e):"symbol"==typeof e?Object.getOwnPropertySymbols(t).includes(e):void 0)},j:function(t,e,n){let r=Object.getOwnPropertyDescriptor(t,e);(!r||r.get||r.set)&&(r={configurable:!0,enumerable:!0,writable:!0}),r.value=n,Object.defineProperty(t,e,r)},Se:function(t,e,n){Object.defineProperty(t,e,{get:n,configurable:!0,enumerable:!0})},Ae:function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).filter((e=>Object.getOwnPropertyDescriptor(t,e).get))},xe:function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).filter((t=>"constructor"!==t)).filter((e=>"function"==typeof Object.getOwnPropertyDescriptor(t,e).value))},D:_,F:m,Ie:function(t,e){return t.concat(e.filter((e=>!m(t,e))))},je:function(t,e){return t.filter((t=>!m(e,t)))},Te:E,Re:class{constructor(t,e=s().$e){this.ke=new Date,this.Ce=t,this.$e=e}Ne(){if(new Date-this.ke>E(this.$e))throw new TimeoutError(this.Ce+" timeout")}},Ue:v,De:function(t){return Object.keys(t).sort(P)},Fe:P}},function(t,e,n){class JigDeps{static get Me(){return n(15)}static get Be(){return n(10)}static get Ge(){return n(0)}static get Le(){return n(13)}static get Qn(){return n(14)}static get Je(){return n(3)}static get We(){return n(17)}static get He(){return n(1)}static get Ve(){return n(2)}static get ze(){return n(6)}static get Ke(){return n(18)}static get Ye(){return n(5)}static get G(){return n(4).G}static get qe(){return n(40)}static get Ze(){return n(24)}static get Qe(){return"Jig"}static get Fa(){return n(9)}}class Jig{constructor(...t){const e=JigDeps.Me,n=JigDeps.Be,Code=JigDeps.Ge,r=JigDeps.Le.M,o=JigDeps.Fa.Da,i=JigDeps.We,s=JigDeps.Ve,c=JigDeps.ze,a=JigDeps.Ke,u=JigDeps.Ye.K,h=JigDeps.G,f=c.ct;if(this.constructor===s)throw new Error("Jig must be extended");if(!(this.constructor instanceof Code))return f.at((()=>{const e=new Code(this.constructor);return Code.Yt(e).Lt(),new e(...t)}));Code.Yt(this.constructor).Lt(),n.q(this);const l=f.st,p=l.length&&l[l.length-1].en;p&&(this.owner=h((()=>r(p.owner,u))));const y=new i(this,a.Ma());return o.add(y),e.rn(this.constructor,y,t),y}init(){}sync(t={}){const e=JigDeps.Je,n=JigDeps.Qe,r=JigDeps.qe,o=JigDeps.He.h,i=JigDeps.Ve,s=JigDeps.ze.ct;if(JigDeps.Ze.it)throw new Error("sync disabled during atomic update");if(e.rt&&e.ot(n,"Sync",o(this)),!(this instanceof i))throw new Error("sync unavailable");if(s.st.length)throw new Error("sync cannot be called internally");return r(this,t).then((()=>this))}destroy(){const t=JigDeps.Je,e=JigDeps.Qe,n=JigDeps.He.h,r=JigDeps.Ve,o=JigDeps.Me;if(t.rt&&t.ot(e,"Destroy",n(this)),!(this instanceof r))throw new Error("destroy unavailable");return o.yt(this),this}auth(){const t=JigDeps.Je,e=JigDeps.Qe,n=JigDeps.He.h,r=JigDeps.Ve,o=JigDeps.Me,i=JigDeps.ze,s=JigDeps.He.F;if(t.rt&&t.ot(e,"Auth",n(this)),!(this instanceof r))throw new Error("auth unavailable on native jigs");if(s(i.ct.ft,this))throw new Error("auth unavailable on new jigs");return o.lt(this),this}toString(){return`[jig ${this.constructor.name}]`}static load(t){const{g:e,h:n,$:r}=JigDeps.He,o=JigDeps.Qn,i=JigDeps.Ve,s=JigDeps.ze.ct;if(JigDeps.Ze.it)throw new Error("load disabled during atomic update");if(this!==i&&!r(this,i))throw new Error("load unavailable");if(s.st.length)throw new Error("load cannot be called internally");return(async()=>{const r=e(),i=new o(r),s=await i.cr(t);if(s instanceof this)return s;throw new Error(`Cannot load ${t}\n\n${n(s)} not an instance of ${n(this)}`)})()}static[Symbol.hasInstance](t){if(!JigDeps.Fa.Da.has(t))return!1;if(this===JigDeps.Ve)return!0;const e=JigDeps.Ge.Qt(this);return!!e&&JigDeps.G((()=>{let n=Object.getPrototypeOf(t);for(;n;){if(n.constructor.origin===e.origin)return!0;n=Object.getPrototypeOf(n)}return!1}))}}Jig.deps={JigDeps},Jig.sealed=!1,Jig.toString();const r=new JigDeps.Ge;JigDeps.Ge.Yt(r).Mt(Jig,!1),t.exports=r},function(t,e,n){const{Se:r}=n(1),o={};function i(t,e,...n){o.sn&&o.sn[t]&&"function"==typeof o.sn[t]&&o.sn[t]((new Date).toISOString(),t.toUpperCase(),`[${e}]`,...n)}o.cn={warn:console.warn,error:console.error},o.sn=o.cn,o.Wt=(...t)=>i("info",...t),o.an=(...t)=>i("warn",...t),o.un=(...t)=>i("error",...t),o.ot=(...t)=>i("debug",...t);const[s,c,a,u]=Object.keys({Jt:1,hn:2,fn:3,rt:4});r(o,s,(()=>o.sn&&o.sn.info&&"function"==typeof o.sn.info)),r(o,c,(()=>o.sn&&o.sn.warn&&"function"==typeof o.sn.warn)),r(o,a,(()=>o.sn&&o.sn.error&&"function"==typeof o.sn.error)),r(o,u,(()=>o.sn&&o.sn.debug&&"function"==typeof o.sn.debug)),t.exports=o},function(t,e){let n=!1;t.exports={G:function(t){const e=n;try{return n=!0,t()}finally{n=e}},ln:function(){return n}}},function(module,exports,__webpack_require__){(function(process,global){const DeterministicRealm=__webpack_require__(38),{pe:_sandboxSourceCode,ye:_anonymizeSourceCode,Se:_defineGetter}=__webpack_require__(1),Log=__webpack_require__(3),TAG="Sandbox";class Sandbox{constructor(){this.ee=[],Log.rt&&Log.ot(TAG,"Creating deterministic realm"),this.pn=new DeterministicRealm;const compartment=this.pn.makeCompartment();this.K=compartment.evaluate(_getIntrinsicsSrc),this.ae=eval(_getIntrinsicsSrc),this.he=new Set(Object.entries(this.K).map((([t,e])=>e))),this.ue=new Set(Object.entries(this.ae).map((([t,e])=>e)))}Bt(t,e,n=!1,r=!1){if(process.env.COVER&&n||this.ee.includes(t.name)){return[t,void 0!==global?global:window]}const o=_sandboxSourceCode(t.toString(),t),i=r?_anonymizeSourceCode(o):o;return this.yn(i,e)}yn(t,e={}){const n=this.pn.makeCompartment();Object.assign(n.global,this.K,e);const r=t.startsWith("class")?"AnonymousClass":"anonymousFunction",o=`const ${r}=${t};${r}`;"Math"in e||_defineGetter(n.global,"Math",(()=>{throw new ReferenceError("Math is not defined\n\nHint: Math is disabled because it is non-deterministic.")})),"Date"in e||_defineGetter(n.global,"Date",(()=>{throw new ReferenceError("Date is not defined\n\nHint: Date is disabled because it is non-deterministic.")}));return[n.evaluate(o),n.global]}}const _intrinsicNames=["console","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","Object","Function","Boolean","Symbol","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError","Number","BigInt","Math","Date","String","RegExp","Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Map","Set","WeakMap","WeakSet","ArrayBuffer","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"];let _getIntrinsicsSrc="const x = {}\n";_intrinsicNames.forEach((t=>{_getIntrinsicsSrc+=`x.${t} = typeof ${t} !== 'undefined' ? ${t} : undefined\n`})),_getIntrinsicsSrc+="x",module.exports=new Sandbox}).call(this,__webpack_require__(30),__webpack_require__(31))},function(t,e,n){const r=n(8),{crypto:o}=r,Unbound=n(11),{R:i,h:s,P:c,F:a,g:u}=n(1),{J:h,Kt:f}=n(10),{G:l}=n(4),p=n(27),{Me:y}=n(15),d=n(3),w="Record";class g{constructor(){this.wn="record://"+o.Random.getRandomBuffer(32).toString("hex"),this.gn=0,this._n=[],this.st=[],this.un=null,this.ft=[],this.bn=[],this.mn=[],this.Pn=[],this.En=[],this.On=[],this.vn=[],this.Sn=[],this.An=new Map,this.xn=!0,this.Ba=!1,this.jn=!1}Tn(){i(!this.jn),d.rt&&d.ot(w,"Begin"),this.gn++}Rn(){i(this.gn),d.rt&&d.ot(w,"End"),this.gn--,this.gn||!this.xn||this.jn||this.$n()}kn(t){i(!this.jn),i(t instanceof y),d.rt&&d.ot(w,"Push "+t),this.st.push(t)}Cn(){i(this.st.length);const t=this.st.pop();d.rt&&d.ot(w,"Pop "+t),this.st.length||this.jn||this.Nn(t)}Nn(t){if(i(t instanceof y),i(!this.st.length),d.rt&&d.ot(w,"Add "+t),this._n.push(t),l((()=>{for(const[t,e]of this.An){if(a(this.On,t))continue;if(e.Un.owner===t.owner&&e.Un.satoshis===t.satoshis)continue;const n=t.owner instanceof Unbound&&void 0!==t.owner.Dn,r=t.satoshis instanceof Unbound&&void 0!==t.satoshis.Dn;(n||r)&&this.Fn(t)}})),this.Pn.filter((t=>!a(this.On,t))).forEach((t=>this.Fn(t))),this.ft.forEach((t=>this.Mn(t))),this.En.forEach((t=>this.Mn(t))),this.mn.forEach((t=>this.Mn(t))),this.Pn.forEach((t=>this.Mn(t))),!this.Ba){const t=u();this.Sn.forEach((e=>t.Bn("update",e)))}!this.gn&&this.xn&&this.$n()}Fn(t){i(!this.jn),a(this.On,t)||(d.rt&&d.ot(w,"Disable "+s(t)),this.On.push(t))}Mn(t){a(this.Sn,t)||(this.Sn.push(t),l((()=>{const e=a(this.Pn,t)?"_d":"_o";t.location=`${this.wn}${e}${this.Sn.length-1}`,t.origin===f&&(t.origin=t.location)})))}$n(){i(!this.jn);const t=n(25);if(d.rt&&d.ot(w,"Commit"),this.wn===g.ct.wn&&(i(!g.ct.gn),g.ct=new g),!this._n.length)return d.hn&&d.an(w,"No actions found"),i(!this.ft.length),i(!this.mn.length),i(!this.Pn.length),void i(!this.En.length);if(!this._n.length||this.ft.length||this.mn.length||this.Pn.length||this.En.length)try{return new t(this)}catch(t){throw this.ht(t),t}}Gn(t){if(this.la(t,"create"),i(!this.jn),a(this.ft,t))return void this.Ln();d.rt&&d.ot(w,"Create",s(t));const Code=n(0),Jig=n(2);i(t instanceof Code||t instanceof Jig);const e=l((()=>h(t.origin).nativeid));i(!e),i(!a(this.mn,t)),i(!a(this.Pn,t)),i(!a(this.En,t)),i(!a(this.On,t)),this.ft.push(t),this.Jn(t,!1,"create"),this.Wn(t),this.Ln()}_read(t){if(i(!this.jn),a(this.bn,t))return;d.rt&&d.ot(w,"Read",s(t));const e=n(9);i(t instanceof e),this.bn.push(t),this.Jn(t,!0,"read"),this.Wn(t,void 0,!0)}Hn(t,e){if(this.la(t,"update"),i(!this.jn),a(this.mn,t))return this.Vn(t,"update"),void this.Ln();d.rt&&d.ot(w,"Update",s(t));const Code=n(0),Jig=n(2);i(t instanceof Code||t instanceof Jig);const r=l((()=>t.origin===f));i(!r||a(this.ft,t));const o=l((()=>h(t.origin).nativeid));i(!o),this.Vn(t,"update"),this.mn.push(t),this.Jn(t,!1,"update"),this.Wn(t,e),this.Ln()}zn(t){if(this.la(t,"delete"),i(!this.jn),a(this.Pn,t))return this.Vn(t,"delete"),void this.Ln();d.rt&&d.ot(w,"Delete",s(t));const Code=n(0),Jig=n(2);i(t instanceof Code||t instanceof Jig);const e=l((()=>h(t.origin).nativeid));i(!e),this.Vn(t,"delete"),this.Pn.push(t),this.Jn(t,!1,"delete"),this.Wn(t),this.Ln(),l((()=>{t.owner=null,t.satoshis=0}))}lt(t,e=!0){if(this.la(t,"auth"),i(!this.jn),a(this.En,t))return this.Vn(t,"auth"),void(e&&this.Ln());d.rt&&d.ot(w,"Auth",s(t));const Code=n(0),Jig=n(2);i(t instanceof Code||t instanceof Jig),i(!a(this.ft,t)),this.Vn(t,"auth"),this.En.push(t),this.Jn(t,!1,"auth"),this.Wn(t),this.Ln()}Ln(){i(!this.jn),this.st.map((t=>t.en)).filter((t=>!!t)).filter((t=>!a(this.ft,t))).forEach((t=>this.lt(t,!1)))}Vn(t,e){const n=`${e} disabled: ${a(this.Pn,t)?s(t)+" deleted":s(t)+" has an unbound new owner or satoshis value"}`;c(!a(this.On,t),n)}la(t,e){if(!this.st.length)return;const Berry=n(7),r=this.st.some((t=>t.en instanceof Berry)),o=`Cannot ${e} ${s(t)} in berry`;c(!r,o)}Wn(t,e,n){const r=n||!(()=>{try{return u().Ha}catch(t){return!1}})(),o=this.An.get(t);if(o)return!r&&o.Va&&o.za(),void(n||(o.Qa=!1));const i=e||new p(t,r,n);this.An.set(t,i)}Jn(t,e,r){i(!this.jn);const o=l((()=>t.location)),{commitid:c,recordid:a}=h(o);if(a){if(!a.startsWith(this.wn)&&!e)throw new Error(`Cannot ${r} ${s(t)}: open transaction`)}else if(c){const o=n(25).ja(c);if(!o&&!e)throw new Error(`Cannot ${r} ${s(t)}: open transaction`);o&&!this.vn.includes(o)&&this.vn.push(o)}}ht(t){if(this.jn)return;d.rt&&d.ot(w,"Rollback"),this.An.forEach((e=>e.ht(t))),this.wn===g.ct.wn&&(g.ct=new g);const e=u();this.Sn.forEach((t=>e.Bn("update",t))),this.jn=!0}qt(){const{Yn:t}=n(15),e=this.st.filter((e=>e instanceof t));return e.length<2?null:e[e.length-2].en}at(t){try{this.Tn();const e=t();return this.Rn(),e}catch(t){throw this.ht(t),t}}}g.ct=new g,t.exports=g},function(t,e,n){class BerryDeps{static get Me(){return n(15)}static get Ge(){return n(0)}static get Fa(){return n(9)}static get Qn(){return n(14)}static get We(){return n(17)}static get He(){return n(1)}static get Xn(){return n(7)}static get ze(){return n(6)}static get Ke(){return n(18)}static get G(){return n(4).G}static get Ze(){return n(24)}}class Berry{constructor(...t){const e=BerryDeps.Me,n=BerryDeps.Fa.dn,r=BerryDeps.Xn,o=BerryDeps.We,i=BerryDeps.Qn.tr,s=BerryDeps.Ke;if(this.constructor===r)throw new Error("Berry must be extended");this.location=i(this.constructor);const c=s.Ga(),a=new o(this,c);return n.add(a),c.nr=!1,e.pa(this.constructor,a,t),c.nr=!0,a}static[Symbol.hasInstance](t){if(!BerryDeps.Fa.dn.has(t))return!1;if(this===BerryDeps.Xn)return!0;const e=BerryDeps.Ge.Qt(this);return!!e&&BerryDeps.G((()=>{let n=Object.getPrototypeOf(t);for(;n;){if(n.constructor.location===e.location)return!0;n=Object.getPrototypeOf(n)}return!1}))}static async pluck(t,e,n){return new this}static load(t){const{g:e,h:n,$:r}=BerryDeps.He,o=BerryDeps.Qn,i=BerryDeps.Xn,s=BerryDeps.ze.ct;if(BerryDeps.Ze.it)throw new Error("load disabled during atomic update");if(this!==i&&!r(this,i))throw new Error("load unavailable");if(s.st.length)throw new Error("load cannot be called internally");const c=this===i?void 0:this,a=new o(e()).cr(t,c);return(async()=>{const e=await a;if(e instanceof this)return e;throw new Error(`Cannot load ${t}\n\n${n(e)} not an instance of ${n(this)}`)})()}init(...t){}}Berry.deps={BerryDeps},Berry.sealed=!1,Berry.toString();const r=new BerryDeps.Ge;BerryDeps.Ge.Yt(r).Mt(Berry,!1),t.exports=r},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__8__},function(t,e){const n=new WeakSet,r=new WeakSet,o=new WeakSet;class i{static[Symbol.hasInstance](t){return!!n.has(t)||(!!r.has(t)||!!o.has(t))}}i.Da=n,i.Z=r,i.dn=o,t.exports=i},function(t,e,n){const{Address:r,PublicKey:o}=n(8),{h:i,j:s}=n(1),{G:c}=n(4),a=1e8,u=/^(?<protocol>error):\/\/(?<error>.*)/s,h=/^(?<protocol>native):\/\/(?<nativeid>[a-zA-Z0-9_$]+)/s,f=/^(?<protocol>commit):\/\/(?<commitid>[a-f0-9]+)_(?:o(?<vout>[0-9]+)|(?:d(?<vdel>[0-9]+)))$/,l=/^(?<protocol>record):\/\/(?<recordid>[a-f0-9]+)_(?:o(?<vout>[0-9]+)|(?:d(?<vdel>[0-9]+)))$/,p=/^(?<txid>[a-f0-9]+)?_(?:(?:o(?<vout>[0-9]+))|(?:d(?<vdel>[0-9]+)))(?:_(?<berry>.*))?$/s,y="error://Undeployed";t.exports={J:function(t,e){if("string"!=typeof t)throw new Error("Location is not a string: "+i(t));const n=t.match(p)||t.match(f)||t.match(l)||t.match(u)||t.match(h);if(n){const e={},r=n.groups;return"commit"===r.protocol&&(e.commitid="commit://"+r.commitid),"record"===r.protocol&&(e.recordid="record://"+r.recordid),"error"===r.protocol&&(e.error=r.error),"native"===r.protocol&&(e.nativeid="native://"+r.nativeid),void 0!==r.txid&&(e.txid=r.txid),void 0!==r.vout&&(e.vout=parseInt(r.vout)),void 0!==r.vdel&&(e.vdel=parseInt(r.vdel)),void 0!==r.berry&&(e.berry=r.berry),t===y&&(e.undeployed=!0),e}throw new Error("Bad location: "+i(t))},W:function(t){if(Number.isInteger(t)&&t>=1)return t;throw new Error("Invalid nonce: "+i(t))},H:function(t,e=!1,s){const StandardLock=n(32);if("string"==typeof t){try{const e=new o(t,{network:s}),n=s?"testnet"===s:void 0;return new StandardLock(e.toAddress().toString(),n)}catch(t){}try{new r(t,s);return new StandardLock(t,s?"testnet"===s:void 0)}catch(t){}}const{Lock:c}=n(33);if(t instanceof c)return t;if(null===t&&e)return null;throw new Error("Invalid owner: "+i(t))},V:function(t,e=!1){if(null===t&&e)return null;if("number"!=typeof t)throw new Error("satoshis must be a number");if(!Number.isInteger(t))throw new Error("satoshis must be an integer");if(t<0)throw new Error("satoshis must be non-negative");if(t>a)throw new Error("satoshis must be <= 100000000");return t},q:function(t){const Unbound=n(11);c((()=>{s(t,"origin",y),s(t,"location",y),s(t,"nonce",0),s(t,"owner",new Unbound(void 0)),s(t,"satoshis",new Unbound(void 0))}))},L:["location","origin","nonce","owner","satoshis"],Kt:y}},function(t,e,n){const Code=n(0);class Unbound{constructor(t){this.Dn=t}}Unbound.toString();const r=new Code;Code.Yt(r).Mt(Unbound,!0),t.exports=r},function(t,e){class ArgumentError extends Error{constructor(t="Unknown reason"){super(t),this.name=this.constructor.name}}class InternalError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class RequestError extends Error{constructor(t,e,n,r,o){super(`${e} ${n}\n\n${r} ${o}\n\n${t}`),this.reason=t,this.status=e,this.statusText=n,this.method=r,this.url=o,this.name=this.constructor.name}}class StateError extends Error{constructor(t="Unknown reason"){super(t),this.name=this.constructor.name}}class TimeoutError extends Error{constructor(t){super(t),this.name=this.constructor.name}}class UnimplementedError extends Error{constructor(t){super(t),this.name=this.constructor.name}}t.exports={ArgumentError,InternalError,RequestError,StateError,TimeoutError,UnimplementedError}},function(t,e,n){const{de:r,A:o,h:i,we:s,ge:c,_e:a,be:u,P:h,D:f,j:l,De:p,R:y}=n(1),{G:d}=n(4),w=n(5),g=w.ae,b=w.K,_=w.ue,m=w.he,E=g.Object,v=b.Object,P=n(9);t.exports={B:function t(e,n,r=new Set){return d((()=>{if("function"!=typeof e&&"object"!=typeof e||!e)return void n(e);if(r.has(e))return;if(r.add(e),!1===n(e))return;if(e instanceof g.Set||e instanceof b.Set)for(const o of e)t(o,n,r);if(e instanceof g.Map||e instanceof b.Map)for(const[o,i]of e)t(o,n,r),t(i,n,r);p(e).forEach((o=>{t(e[o],n,r)})),"object"!=typeof e||_.has(e.constructor)||m.has(e.constructor)||t(e.constructor,n,r);const o=Object.getPrototypeOf(e);"function"==typeof e&&o!==E.getPrototypeOf(E)&&o!==v.getPrototypeOf(v)&&t(o,n,r)}))},qn:function t(e,r,o=new Map){if("function"!=typeof e&&"object"!=typeof e||!e)return e;if(o.has(e))return o.get(e);let i=!0;const s=r(e,(t=>{i=t}))||e;if(o.set(e,s),"function"!=typeof s&&"object"!=typeof s||!s||!i)return s;const c=n(5),Code=n(0),a=c.ae,u=c.K,h=c.ue,f=c.he,d=a.Object,w=u.Object;if(s instanceof a.Set||s instanceof u.Set){const e=Array.from(s);for(let n=0;n<e.length;n++)e[n]=t(e[n],r,o);s.clear(),e.forEach((t=>s.add(t)))}if(s instanceof a.Map||s instanceof u.Map){const e=Array.from(s);for(let n=0;n<e.length;n++)e[n][0]=t(e[n][0],r,o),e[n][1]=t(e[n][1],r,o);s.clear(),e.forEach((t=>s.set(t[0],t[1])))}if(p(s).forEach((e=>{const n=s[e],i=t(n,r,o);n!==i&&l(s,e,i)})),"object"==typeof s&&!h.has(s.constructor)&&!f.has(s.constructor)){const e=t(s.constructor,r,o);Object.getPrototypeOf(s)!==e.prototype&&Object.setPrototypeOf(s,e.prototype)}const g=Object.getPrototypeOf(s);if("function"==typeof s&&g!==d.getPrototypeOf(d)&&g!==w.getPrototypeOf(w)){const e=t(g,r,o);if(g!==e){y(s!==e),Object.setPrototypeOf(s,e);const t=s instanceof Code?Object.getPrototypeOf(s.prototype):s.prototype;Object.setPrototypeOf(t,e.prototype)}}return s},M:function t(e,f,y,d=new Map){if("symbol"==typeof e)throw new Error("Cannot clone: "+i(e));if("function"!=typeof e&&"object"!=typeof e||!e)return e;if(d.has(e))return d.get(e);if(y){const t=y(e);if(t)return d.set(e,t),t}const w=n(5),g=n(9),b=w.ae,_=w.ue,m=w.he;if(f=f||b,e instanceof g)return e;if("function"==typeof e)throw new Error("Cannot clone non-code function: "+i(e));if(_.has(e)||m.has(e))throw new Error("Cannot clone intrinsic: "+i(e));let E=null;if(r(e)&&(E=new f.Array),o(e)&&(E=new f.Object),a(e))return new f.Uint8Array(f.Array.from(e));s(e)&&(E=new f.Set),c(e)&&(E=new f.Map);let v=!1;if(E||(v=!0,E=new f.Object),!E)throw new Error("Cannot clone: "+i(e));if(d.set(e,E),E instanceof f.Set)for(const n of e){const e=t(n,f,y,d);E.add(e)}if(E instanceof f.Map)for(const n of e){const e=t(n[0],f,y,d),r=t(n[1],f,y,d);E.set(e,r)}if(p(e).forEach((n=>{if("symbol"==typeof n)throw new Error("Cannot clone: "+i(n));l(E,n,t(e[n],f,y,d))})),!_.has(e.constructor)&&!m.has(e.constructor)){const n=t(e.constructor,f,y,d);Object.setPrototypeOf(E,n.prototype)}return v&&h(u(E),"Cannot clone: "+i(e)),E},Zn:function t(e,n,i={}){if(typeof e!=typeof n)return!1;if("number"==typeof e&&isNaN(e)&&isNaN(n))return!0;if(e instanceof P)return n instanceof P&&!!f(e,n);if("object"!=typeof e||!e||!n)return e===n;const u=Object.getOwnPropertyNames(e),h=Object.getOwnPropertyNames(n),l=Object.getOwnPropertyDescriptors(e),p=Object.getOwnPropertyDescriptors(n),y=u.filter((t=>l[t].enumerable)),d=h.filter((t=>p[t].enumerable));if(y.length!==d.length)return!1;if(i.ya)for(let r=0;r<y.length;r++){const o=y[r],i=d[r];if(o!==i)return!1;if(!t(e[o],n[i]))return!1}else{if(y.some((t=>!d.includes(t))))return!1;if(y.some((r=>!t(e[r],n[r],i))))return!1}if(o(e))return!!o(n);if(r(e))return!!r(n);if(s(e))return!!s(n)&&(e.size===n.size&&!!t(Array.from(e.entries()),Array.from(n.entries())));if(c(e))return!!c(n)&&(e.size===n.size&&!!t(Array.from(e.entries()),Array.from(n.entries())));if(a(e))return!!a(n);throw new Error("Unsupported: "+e)}}},function(t,e,n){(function(e){const r=n(8),{Transaction:o}=r,i=n(3),{R:s,$:c,h:a,P:u,_:h,Re:f}=n(1),{J:l,Kt:p}=n(10),{G:y}=n(4),d=n(5),{ArgumentError}=n(12),Code=n(0),w=d.K,g=d.ae,b="Loader",_=new Map;let m=null,E=null;class v{constructor(t,e=new f("load",t.$e)){s(t),this.rr=new Map,this.La=new Map,this.sr=[],this.g=t,this.$e=e}async cr(t,e,n=!1){if(this.$e.Ne(),!e){const e=this.rr.get(t);if(e)return e}const r=this.ar(t,e);e||this.rr.set(t,r);const o=await r;if(!n)for(;this.sr.length;){const t=this.sr;this.sr=[],await Promise.all(t)}return o}async ar(t,e){this.$e.Ne(),e?i.Jt&&i.Wt(b,"Load",t,"with",a(e)):i.Jt&&i.Wt(b,"Load",t);const n=new Date;try{if(e)return await this.ur(t,e);const r=l(t),o="Bad location: "+t;return h(!r.error,o),h(!r.commitid,o),h(!r.recordid,o),r.nativeid?this.hr(t):(h(r.txid,o),void 0!==r.berry?await this.lr(t):await this.pr(t))}finally{i.rt&&i.ot(b,"Load (end): "+(new Date-n)+"ms")}}async lr(t){this.$e.Ne();const{yr:e}=n(19),r="berry://"+t,o=await e(r,void 0,this);if(o)return this.sr.push(o.wr),o.Dn;const i=t.slice(0,t.lastIndexOf("_")),s=new v(this.g,this.$e),c=await s.cr(i),a=l(t).berry;return this.dr(a,c)}async pr(t){this.$e.Ne();const{txid:e,vout:r,vdel:i}=l(t),s=await this.g.Ot().fetch(e),c=new o(s),a=P(c),u="number"==typeof r&&r>=1&&r<=a.out.length,f="number"==typeof i&&i>=0&&i<a.del.length;h(u||f,"Jig does not exist: "+t);const p=u?a.out[r-1]:a.del[i],y="jig://"+t,{yr:d}=n(19),w=await d(y,p,this);return w?(this.sr.push(w.wr),w.Dn):this.gr(c,a,t)}async gr(t,e,r){this.$e.Ne(),u(!this.g._r,`Cannot load ${r}\n\nOnly cached jigs may be loaded in client mode`);const{txid:o,vout:i,vdel:s}=l(r);let c=null;if(this.La.has(o))c=await this.La.get(o);else{if(_.has(o))return await _.get(o),await this.pr(r);try{const r=n(28),i=!0,s=null,a=!1,u=r(t,o,e,this.g,i,s,this.$e,a);this.La.set(o,u),_.set(o,u),c=await u}finally{this.La.delete(o),_.delete(o)}}if(c.br.forEach((t=>this.g.Bn("load",t))),c.Pn.forEach((t=>this.g.Bn("load",t))),"number"==typeof i&&i>=1&&i<=c.br.length)return c.br[i-1];if("number"==typeof s&&s>=0&&s<=c.Pn.length-1)return c.Pn[s];throw new ArgumentError("Jig not found: "+r)}async ur(t,e){this.$e.Ne();const Berry=n(7),{yr:r}=n(19);h(c(e,Berry),"Berry class must extend from Berry"),h("string"==typeof t,"Berry path must be a string");const o=new Code(e),i=y((()=>o.location)),s=l(i),a=!s.commitid&&!s.recordid&&!s.error&&s.txid?`${i}_${t}`:void 0;if(a){const t=this.rr.get(a);if(t)return t}const u=(async()=>{const e="berry://"+a,n=await r(e,void 0,this);return n?(this.sr.push(n.completer),n.Dn):this.dr(t,o)})();return a&&this.rr.set(a,u),u}async dr(t,e){this.$e.Ne(),s(e instanceof Code),i.Jt&&i.Wt(b,"Pluck",a(e),t);const r=n(6),o={b:this.g.Ot(),se:t=>{r.ct.un=t}},[c]=d.yn("async function(txid) {\n      try {\n        return await b.fetch(txid)\n      } catch (e) {\n        se(e)\n        throw e\n      }\n    }",o);Object.freeze(c);const h=m,f=E;try{const o=!!y((()=>l(e.location))).txid,i=o?`${y((()=>e.location))}_${t}`:p;E=i,m=e;const s=e.pluck(t,c),d="pluck method must be async";u(s instanceof w.Promise||s instanceof g.Promise,d);const b=await s;if(u(b&&b.constructor===e,"Berry must be an instance of "+a(e)),o){const{da:t}=n(19),e=t(b),r="berry://"+i;await this.g.oo().set(r,e)}return b}finally{r.ct=new r,E=f,m=h}}hr(t){this.$e.Ne();const{nativeid:e}=l(t),n=Code.Xt(e);h(n,"Native code not found: "+e);const r=Code.Yt(n);return h(!r.vt,a(n)+" cannot be a dependency"),n}}function P(t){const{mr:r}=n(16),o="Not a run transaction: invalid op_return protocol",i="Not a run transaction: invalid run payload";u(t.outputs.length,o);const s=t.outputs[0].script.chunks;u(s.length>=6,o),u(0===s[0].opcodenum,o),u(106===s[1].opcodenum,o),u("run"===s[2].buf.toString(),o);const c=e.from([r]).toString("hex");u(s[3].buf.toString("hex")===c,"Not a run transaction: unsupported run version");try{const t=s[5].buf.toString("utf8"),e=JSON.parse(t);return u("number"==typeof e.in,i),u(Array.isArray(e.ref),i),u(Array.isArray(e.out),i),u(Array.isArray(e.del),i),u(Array.isArray(e.cre),i),u(Array.isArray(e.exec),i),u(!e.ref.some((t=>"string"!=typeof t)),i),u(!e.out.some((t=>"string"!=typeof t)),i),u(!e.del.some((t=>"string"!=typeof t)),i),u(!e.exec.some((t=>"object"!=typeof t)),i),e}catch(t){u(!1,i)}}v.Pr=P,v.tr=function(t){if(!m||m!==t)throw new Error("Must only create berry from its berry class");if(!E)throw new Error("Must only pluck one berry at a time");const e=E;return E=null,e},t.exports=v}).call(this,n(34).Buffer)},function(t,e,n){const{Er:r}=n(17),{L:o,J:i}=n(10),{R:s,h:c,O:a,F:u,I:h,P:f}=n(1),{B:l,M:p}=n(13),{StateError,UnimplementedError}=n(12),{G:y}=n(4),d=n(3),w=n(22),g="Action";class b{constructor(t){this.en=t}toString(){return""+this.constructor.name}op(){throw new UnimplementedError}data(){throw new UnimplementedError}}class _ extends b{constructor(){super(null),this.Or=[],this.vr=[]}toString(){return`Deploy (count: ${this.Or.length})`}op(){return"DEPLOY"}data(){s(this.Or.length===this.vr.length);const t=[];for(let e=0;e<this.Or.length;e++){const n=this.Or[e],r=this.vr[e];t.push(n),t.push(r)}return t}}class m extends b{constructor(t,e,n){super(t),this.et=e,this.Un=n}toString(){return"Upgrade "+c(this.en)}op(){return"UPGRADE"}data(){const t=[];return t.push(this.en),t.push(this.et),t.push(this.Un),t}}class E extends b{toString(){return"Destroy "+c(this.en)}op(){return"DESTROY"}data(){return this.en}}class v extends b{toString(){return"Auth "+c(this.en)}op(){return"AUTH"}data(){return this.en}}class P extends b{constructor(t,e,n){super(t),this.Ce=e,this.Sr=n}toString(){return`Call ${c(this.en)} ${this.Ce}`}op(){return"CALL"}data(){const t=[];return t.push(this.en),t.push(this.Ce),t.push(this.Sr),t}}class O extends b{constructor(t,e,n){super(e),this.Ar=t,this.Sr=n}toString(){return"New "+c(this.en)}op(){return"NEW"}data(){const t=[];return t.push(this.Ar),t.push(this.Sr),t}}class S extends b{constructor(t,e,n){super(e),this.wa=t,this.Sr=n}toString(){return"Pluck "+c(this.en)}}function A(t,e){const Code=n(0),r=n(6).ct,o=a(t);if(!o)return;A(o,e);if(Code.Yt(o).nt)return;const i=h(o,"sealed")?o.sealed:"owner";switch(i){case"owner":u(r.ft,o)||r.lt(o);break;case!0:throw new StateError(`Cannot ${e}: ${c(o)} is sealed`);case!1:break;default:throw new StateError("Invalid sealed option: "+i)}}function x(t){const e=n(9),r=n(6),Unbound=n(11),o=r.ct;l(t,(t=>t!==Unbound&&(t instanceof e?(o._read(t),!1):void 0)))}t.exports={Me:b,Ir:_,jr:m,Tr:E,Rr:v,Yn:P,$r:O,ga:S,Lt:function(t){const Code=n(0),e=n(6).ct;s(t.length),s(t.every((t=>t instanceof Code))),d.rt&&d.ot(g,"Deploy",t.map((t=>c(t))).join(", ")),e.at((()=>{t.forEach((t=>e.Gn(t))),t.forEach((t=>A(t,"deploy")));const n=new _;for(const e of t){const t=e.toString(),r=y((()=>p(Object.assign({},e))));x(r),o.forEach((t=>delete r[t])),s(!r.presets),n.Or.push(t),n.vr.push(r)}e.Nn(n)}))},ut:function(t,e){const Code=n(0),r=n(6).ct;s(t instanceof Code),d.rt&&d.ot(g,"Upgrade",c(t));const a="vdel"in i(y((()=>t.location)));f(!a,"Cannot upgrade destroyed jig"),r.at((()=>{A(t,"upgrade");const n=t.toString(),i=y((()=>p(Object.assign({},t))));x(i),o.forEach((t=>delete i[t])),s(!i.presets);const c=new m(t,n,i);r.Hn(t,e),r.Nn(c)}))},yt:function(t){const e=n(6),Code=n(0),Jig=n(2),r=e.ct;s(t instanceof Code||t instanceof Jig),d.Jt&&d.Wt(g,"Destroy",c(t)),"vdel"in i(y((()=>t.location)))||r.at((()=>{if(r.zn(t),r.st.length)return;const e=new E(t);r.Nn(e)}))},lt:function(t){const e=n(6).ct,Code=n(0),Jig=n(2);s(t instanceof Code||t instanceof Jig),d.Jt&&d.Wt(g,"Auth",c(t));const r="vdel"in i(y((()=>t.location)));f(!r,"Cannot auth destroyed jigs"),e.at((()=>{if(e.lt(t),e.st.length)return;const n=new v(t);e.Nn(n)}))},kr:function(t,e,r,o){const i=n(6).ct;d.Jt&&d.Wt(g,"Call",c(t),e),i.at((()=>{x(r);const n=new P(t,e,r);i.kn(n),o(),i.Cn()}))},rn:function(t,e,o){const Jig=n(2),i=n(6).ct;d.Jt&&d.Wt(g,"New",c(t)),i.at((()=>{let n=t;for(;n!==Jig;)i._read(n),n=Object.getPrototypeOf(n);const s=r(e,o);x(s);const c=new O(t,e,s);i.Gn(e),i.kn(c);const a=e.init(...s);f(void 0===a,"init must not return a value"),i.Cn(),w.Dt(e).Ut.Cr.push("init")}))},pa:function(t,e,o){const Berry=n(7),i=n(6).ct;d.Jt&&d.Wt(g,"Pluck",c(t)),i.at((()=>{let n=t;for(;n!==Berry;)i._read(n),n=Object.getPrototypeOf(n);const s=r(e,o);x(s);const c=new S(t,e,s);i.kn(c);const a=e.init(...s);f(void 0===a,"init must not return a value"),i.Cn(),w.Dt(e).Ut.Cr.push("init")}))}}},function(t,e,n){const r=n(8),o=n(14),{R:i,h:s,fe:c,Ie:a,P:u,Re:h,g:f}=n(1),{B:l}=n(13),{StateError}=n(12),p=n(3),y=n(23),{J:d,H:w}=n(10),{G:g}=n(4),b=n(39),{Transaction:_,Script:m}=r,E="Publish",v=new b;async function P(t){try{p.rt&&p.ot(E,"Publish",t.wn);const e=new Date,r=t.g;t.Dr()||t.Ra(!0);const o=new h("publish",r.$e);await O(t,o),o.Ne(),await S(t),o.Ne(),A(t);const i=x(t),c=await I(t,o);o.Ne();const a=T(c),f=R(t,i),l=j(t,a,f,i),y=k(t,l);await async function(t,e,r,o,i,s){if(t.Fr){p.Jt&&p.Wt(E,"Preverify");const c=new Date;try{const c=n(28),a="0000000000000000000000000000000000000000000000000000000000000000",u=!1,h=null,f=new c.Mr(e,r);await c(i,a,o,t,u,h,s,f)}catch(t){throw p.fn&&p.un(E,t),new Error("Pre-verification failed: "+t.message)}p.rt&&p.ot(E,"Preverify (end): "+(new Date-c)+"ms")}}(r,t,c,l,y,o),o.Ne();const d=await v.Br((async()=>{const e=await C(y,t);o.Ne();const n=await M(e,t);o.Ne(),F(n,t);const r=await D(t,n,o);return u("string"==typeof r&&64===r.length,"Invalid txid: "+s(r)),o.Ne(),r}));o.Ne(),$(t,d),await B(t,c,d),o.Ne(),r.Wr.add(d),t.Hr(),p.rt&&p.ot(E,"Publish (end): "+(new Date-e)+"ms")}catch(e){t.Vr(e)}}async function O(t,e){const n=await t.zr();for(const e of t.Kr){const r=t.Yr.get(e);if(!(r.Un.origin in n))continue;const o=n[r.Un.origin][1];u(r.Un.nonce>=o,"Time travel for "+s(e))}}async function S(t){p.rt&&p.ot(E,"Assign owners");const Unbound=n(11),e=n(9);if(t.ft.map((e=>t.qr.get(e).Un.owner)).some((t=>t instanceof Unbound&&!t.Dn))){for(let e=0;e<t.ft.length;e++){const n=t.ft[e],r=t.qr.get(n),o=r.Un.owner;if(!(o instanceof Unbound)||o.Dn)continue;const i=await t.g.Zr().nextOwner();r.Un.owner=new Unbound(i)}const n=t.ft.map((e=>t.qr.get(e).Un.owner));l(n,(t=>{if(t instanceof e){const e=g((()=>t.location)),{txid:n,nativeid:r}=d(e);u(n||r,t.name+" must first be deployed")}}))}}function A(t){const Unbound=n(11);t.br.forEach((e=>{const n=t.qr.get(e).Un;n.owner instanceof Unbound&&(n.owner=n.owner.Dn),n.satoshis instanceof Unbound&&(n.satoshis=n.satoshis.Dn||0),t.Qr(e)||g((()=>{e.owner instanceof Unbound&&(e.owner=n.owner),e.satoshis instanceof Unbound&&(e.satoshis=n.satoshis||0)}))})),t.Pn.forEach((e=>{g((()=>{const n=t.qr.get(e).Un;n.owner instanceof Unbound&&(n.owner=n.owner.Dn),n.satoshis instanceof Unbound&&(n.satoshis=n.satoshis.Dn||0),e.owner instanceof Unbound&&(e.owner=e.owner.Dn),e.satoshis instanceof Unbound&&(e.satoshis=e.satoshis.Dn||0),i(null===e.owner),i(0===e.satoshis)}))}))}function x(t){let e=a(t.Xr,t.Kr);return e=a(e,t.ft),e}async function I(t,e){const{_a:r}=n(19),o=new Map,i=t.br.concat(t.Pn);for(const n of i){const i=await r(n,t,e);o.set(n,i)}return o}function T(t){const{ba:e}=n(19),r=new Map;for(const[n,o]of t){if(r.has(n))continue;const t=e(o);r.set(n,t)}return r}function R(t,e){const n=(new y).eo((t=>{const n=e.indexOf(t);return i(n>=0),n}));return t._n.map((t=>({op:t.op(),data:n.no(t.data())})))}function j(t,e,n,r){const o=t.br.map((t=>e.get(t))),s=t.Pn.map((t=>e.get(t))),c=(new y).eo((t=>{const e=r.indexOf(t);return i(e>=0),e})),a=t.ft.map((e=>t.qr.get(e).Un.owner)),u=c.no(a),h=t.Kr.map((e=>t.Yr.get(e).Un.location)),f={in:t.Xr.length,ref:h,out:o,del:s,cre:u,exec:n};return p.rt&&p.ot(E,"Payload",JSON.stringify(f,0,2)),f}function k(t,e){p.rt&&p.ot(E,"Create partial tx");const n=new _,o=r.deps.Buffer,i=o.from("run","utf8"),s=o.from([5],"hex"),a=o.from(t.g.ro,"utf8"),u=o.from(JSON.stringify(e),"utf8"),h=m.buildSafeDataOut([i,s,a,u]),f=new _.Output({script:h,satoshis:0});n.addOutput(f);const l=c(t.g.Ot().network);for(const e of t.Xr){const r=t.Yr.get(e),i=r.Un.location,{txid:s,vout:c}=d(i),a=r.Un.satoshis,u=r.Un.owner,h=w(u,false,l),f=o.from(h.script()),p={txid:s,vout:c,script:m.fromBuffer(f),satoshis:a};n.from(p)}for(const e of t.br){const r=t.qr.get(e),i=Math.max(_.DUST_AMOUNT,r.Un.satoshis),s=r.Un.owner,c=w(s,false,l),a=o.from(c.script()),u=m.fromBuffer(a);n.addOutput(new _.Output({script:u,satoshis:i}))}return n}function $(t,e){t.br.forEach(((n,r)=>{const o=r+1,i=t.qr.get(n),s=`${e}_o${o}`;i.Un.origin.startsWith("commit://")&&(i.Un.origin=s),i.Un.location=s,g((()=>{n.origin.startsWith("commit://")&&(n.origin=s),t.Qr(n)||(n.location=s)}))})),t.Pn.forEach(((n,r)=>{const o=t.qr.get(n),i=`${e}_d${r}`;o.Un.origin.startsWith("commit://")&&(o.Un.origin=i),o.Un.location=i,g((()=>{n.origin.startsWith("commit://")&&(n.origin=i),n.location=i}))}))}async function C(t,e){const n=r.deps.Buffer,o=U(e),i=await N(t,e),s=o.map((t=>n.alloc(t.domain()))),c=[...Array(o.length).keys()].filter((e=>!t.inputs[e].script.toBuffer().length));c.forEach((e=>t.inputs[e].setScript(s[e])));const a=t.toString("hex"),u=await e.g.Jr().pay(a,i),h=new _(u);return c.forEach((t=>h.inputs[t].setScript(""))),h}function U(t){return t.Xr.map((e=>t.Yr.get(e))).map((t=>t.Un.owner)).map((t=>w(t)))}async function N(t,e){const n=r.deps.Buffer,o=e.Xr.map((t=>e.Yr.get(t))).map((t=>t.Un.owner)).map((t=>w(t))).map((t=>n.from(t.script()))).map((t=>t.toString("hex"))),i=e.Xr.map((t=>e.Yr.get(t))).map((t=>Math.max(t.Un.satoshis,_.DUST_AMOUNT))),s=o.map(((t,e)=>({script:t,satoshis:i[e]}))),c=t.inputs.slice(e.Xr.length),a=(await Promise.all(c.map((t=>f().Ot().fetch(t.prevTxId.toString("hex")))))).map((t=>new r.Transaction(t))),u=c.map(((t,e)=>a[e].outputs[t.outputIndex])),h=u.map((t=>t.script.toHex())),l=u.map((t=>t.satoshis)),p=h.map(((t,e)=>({script:t,satoshis:l[e]})));return s.concat(p)}async function M(t,e){const n=U(e),r=await N(t,e),o=t.toString("hex"),i=await e.g.Zr().sign(o,r,n);return new _(i)}function F(t,e){e.Xr.forEach(((n,r)=>{if(t.inputs[r].isFullySigned())return;const o=e.Yr.get(n),i=`${"origin: "+o.Un.origin}\n${"location: "+o.Un.location}\n${"owner: "+o.Un.owner}`,c=t.inputs[r].script.toBuffer().length?"Bad signature":"Missing signature";throw new StateError(`${c} for ${s(n)}\n\n${i}`)}))}async function D(t,e,r){let i=null;try{await t.g.Jr().broadcast(e.toString("hex"))}catch(t){p.fn&&p.un(E,t.toString())}try{i=await t.g.Ot().broadcast(e.toString("hex"))}catch(i){throw await async function(t,e,r,i){const s=t.toString();let c="Broadcast failed: "+t.message;if(-1!==s.indexOf("tx has no inputs")||-1!==s.indexOf("insufficient priority")){c=`${c}\n\n${"Hint: Is the purse funded to pay for this transaction?"}`}if(-1!==s.indexOf("Missing inputs")||-1!==s.indexOf("txn-mempool-conflict"))for(const s of r.inputs)try{const r=s.prevTxId.toString("hex"),a=s.outputIndex,u=`${r}_o${a}`,h=await e.g.Ot().spends(r,a);if(!h)continue;let f="Payment";try{const t=new o(e.g,i),r=await t.cr(u);f=r instanceof n(0)?r.name:r.toString()}catch(t){}c=`${c}\n\n${f} was spent in another transaction\n`,c=`${c}\nLocation: ${u}`,c=`${c}\nSpending Tx: ${h}`}catch(t){}return new Error(c)}(i,t,e,r)}return i}async function B(t,e,n){const r=[];for(let o=0;o<t.br.length;o++){const s=t.br[o],c=e.get(s);i(c);const a=`jig://${n}_o${o+1}`;r.push(t.g.oo().set(a,c))}for(let o=0;o<t.Pn.length;o++){const s=t.Pn[o],c=e.get(s);i(c);const a=`jig://${n}_d${o}`;r.push(t.g.oo().set(a,c))}await Promise.all(r)}P.mr=5,P.io=O,P.so=S,P.co=A,P.ao=x,P.uo=I,P.ho=T,P.fo=R,P.lo=j,P.po=k,P.yo=v,P.do=C,P.wo=M,P._o=F,P.Ta=D,P.bo=$,P.mo=B,t.exports=P},function(t,e,n){const{ln:r,G:o}=n(4),{R:i,P:s,h:c,I:a,j:u,Ee:h,C:f,N:l,U:p,fa:y,ve:d,Fe:w,we:g,ge:b}=n(1),{J:_,H:m,V:E,L:v}=n(10),{M:P,B:O}=n(13),S=n(5),A=S.K,x=n(22),{ua:I}=n(26),T=n(18),R=n(9),Code=n(0),j=()=>n(6).ct,k=new WeakMap;let $=new Set;function C(t){const Code=n(0),e=t===Symbol.hasInstance?"Symbol.hasInstance":`'${t}'`,r=`function ${t===Symbol.hasInstance?"hasInstance":t} (...args) { return Code.prototype[${e}].apply(this, args) }`,o=S.yn(r,{Code})[0];return Object.freeze(o)}const U={toString:C("toString"),sync:C("sync"),upgrade:C("upgrade"),destroy:C("destroy"),auth:C("auth"),[Symbol.hasInstance]:C(Symbol.hasInstance)},N=["toString","sync","upgrade","destroy","auth",Symbol.hasInstance],M=["init","sync"],F=["init"];class D{constructor(t,e=new T){return this.Eo=new x(t,this),this.Ut=e,this.en=e.Oo||this.Eo,this.Eo}vo(t,e,r){return this.So()?Reflect.apply(t,e,r):this.Ao((()=>{this.xo(),this.Ut.Io&&(e=void 0),this.jo()&&j()._read(this.en);let u=x.Dt(e);const f=u&&u.Ut.Cr,l=f&&f.includes(t.name);s(!l,t.name+" disabled");let p=!u||!u.Ut.To||!this.Ut.Ro;const Jig=n(2);if(!p||"function"!=typeof e||e instanceof Jig||(e=new Code(e),u=x.Dt(e),p=!u||!u.Ut.To||!this.Ut.Ro),p)return Reflect.apply(t,e,r);const y=j().st,w=!y.length||e!==y[y.length-1].en;let g=$;return j().at((()=>{y.length||(r=B(e,r)),y.length&&u.$o("",r);let f=null;const l=this.ko(u,r);if(!u.Ho(t.name,!0))throw new Error("Cannot call private method "+t.name);n(15).kr(e,t.name,r,(()=>{const n=`Cannot call ${t.name} on ${c(e)}`,[r,u]=function(t,e,n,r){const c=e.name;if(!t)return[e,r];if(!(t instanceof R))return[null,null];if(!t[c]||"function"!=typeof t[c])return[null,null];if(t[c]===n)return[e,r];let u=t;for(;u&&!a(u,c);)u=Object.getPrototypeOf(u);if(i(u),u="function"==typeof u?u:u.constructor,o((()=>u.origin===r.origin)))return o((()=>s(u.nonce>=r.nonce,"Method time travel"))),[x.Co(t[c]),u];const h=j().st;if(h.length<2||h[h.length-2].en!==t)return[null,null];let f=Object.getPrototypeOf(t);for(;f;){const t=d(f,c);if(t===n)return[e,r];const i="function"==typeof f?f:f.constructor;if(t&&o((()=>i.origin===r.origin)))return o((()=>s(i.nonce>=r.nonce,"Method time travel"))),[x.Co(t),i];f=Object.getPrototypeOf(f)}return[null,null]}(e,t,this.Eo,this.en);s(r,n),this.jo()&&j()._read(u);const h=$;try{w&&(g=new Set),$=g,f=Reflect.apply(r,e,l)}finally{$=h}})),s(!(f instanceof Promise||f instanceof A.Promise),"async methods not supported"),s(h(f),"Return value not serializable");return this.No(f,e,!1,!0,g)}))}))}Uo(t,e,n){return this.So()?Reflect.construct(t,e,n):this.Ao((()=>(this.xo(),this.jo()&&j()._read(this.en),Reflect.construct(t,e,n))))}Do(t,e,r){return this.So()?Reflect.defineProperty(t,e,r):this.Ao((()=>{if(this.xo(),"__proto__"===e)throw new Error("define __proto__ disabled");if(this.Fo()&&j().Hn(this.en),s("value"in r,"Descriptor must have a value"),s(!("get"in r),"Getters are not supported"),s(!("set"in r),"Getters are not supported"),s(r.configurable,"Descriptor must be configurable"),s(r.writable,"Descriptor must be writable"),s(r.enumerable,"Descriptor must be enumerable"),this.Mo(e))throw new Error("Cannot define "+e);if(this.Bo(e))throw new Error("Cannot define "+e);if(this.ma(e))throw new Error("Cannot define "+e);if(this.Pa(e))throw new Error("Cannot define "+e);if(this.$o(e,r.value),this.Lo(e,r.value),this.Jo(t,e,r.value),this.Wo(e,"define"),!this.Ho(e))throw new Error("Cannot define private property "+e);if(this.Ut.nr)throw new Error("defineProperty disabled");this.Vo(),t=this.zo()||t,r.value=this.ko(this,r.value),this.Ko(r.value);const Unbound=n(11);return!this.Yo(e)||r.value instanceof Unbound||(r.value=new Unbound(r.value)),r.value instanceof R||(r.value=x.Co(r.value)||r.value),Reflect.defineProperty(t,e,r)}))}qo(t,e){return this.So()?Reflect.deleteProperty(t,e):this.Ao((()=>{if(this.xo(),"__proto__"===e)throw new Error("delete __proto__ disabled");if(this.Fo()&&j().Hn(this.en),this.Mo(e))throw new Error("Cannot delete "+e);if(this.Bo(e))throw new Error("Cannot delete "+e);if(this.ma(e))throw new Error("Cannot delete "+e);if(this.Pa(e))throw new Error("Cannot delete "+e);if(this.Yo(e))throw new Error("Cannot delete "+e);if(!this.Ho(e))throw new Error("Cannot delete private property "+e);if(this.Ut.nr)throw new Error("delete disabled");return this.Vo(),t=this.zo()||t,Reflect.deleteProperty(t,e)}))}Kn(t,e,r){return this.So()?Reflect.get(t,e,r):this.Ao((()=>{this.xo();const o=e===Symbol.hasInstance&&t[Symbol.hasInstance]!==A.Function.prototype[Symbol.hasInstance];if(this.Mo(e)&&!o)return U[e];if(this.ma(e)&&p.includes(e)){const Jig=n(2);let o=Reflect.get(t,e,r);return o=this.Zo(o,Jig,!0),o}if(this.Pa(e)&&y.includes(e)){const Berry=n(7);let o=Reflect.get(t,e,r);return o=this.Zo(o,Berry,!0),o}if("function"==typeof t&&"prototype"===e||"constructor"===e||"symbol"==typeof e)return Reflect.get(t,e,r);if(this.jo()&&j()._read(this.en),this.Qo(t,e),!this.Ho(e))throw new Error("Cannot access private property "+e);let i=Reflect.get(t,e,r);if(this.Xo(i))return i;if(i instanceof R)return i;const Unbound=n(11);this.Yo(e)&&i instanceof Unbound&&(i=i.Dn);const s=this.ti(e),c=s===this.en;return i=this.No(i,s,c,!1),i}))}ei(t,e){return this.So()?Reflect.getOwnPropertyDescriptor(t,e):this.Ao((()=>{this.xo(),this.jo()&&j()._read(this.en);if("function"==typeof t&&"prototype"===e||"constructor"===e||"symbol"==typeof e)return Reflect.getOwnPropertyDescriptor(t,e);if(this.Mo(e))return;if(this.ma(e))return;if(this.Pa(e))return;if(this.Qo(t,e),!this.Ho(e))throw new Error("Cannot access private property "+e);const r=Reflect.getOwnPropertyDescriptor(t,e);if(!r)return;if(this.Xo(r.value))return r;if(r.value instanceof R)return r;const Unbound=n(11);this.Yo(e)&&r.value instanceof Unbound&&(r.value=r.value.Dn);return r.value=this.No(r.value,this.en,!0,!1),r}))}ni(t){return this.So()?Reflect.getPrototypeOf(t):this.Ao((()=>(this.xo(),this.jo()&&j()._read(this.en),Reflect.getPrototypeOf(t))))}ri(t,e){return this.So()?Reflect.has(t,e):this.Ao((()=>{if(this.xo(),this.jo()&&j()._read(this.en),this.Mo(e))return!0;if(this.ma(e))return!0;if(this.Pa(e))return!0;if(!this.Ho(e))throw new Error("Cannot access private property "+e);return Reflect.has(t,e)}))}oi(t){return this.So()?Reflect.isExtensible(t):this.Ao((()=>(this.xo(),!0)))}ii(t){return this.So()?Reflect.ownKeys(t):this.Ao((()=>{this.xo(),this.jo()&&j()._read(this.en);let e=Reflect.ownKeys(t);return e=e.sort(w),e=e.filter((t=>this.Ho(t))),e}))}si(t){return this.So()?Reflect.preventExtensions(t):this.Ao((()=>{throw this.xo(),new Error("preventExtensions disabled")}))}ci(t,e,r,i){return this.So()?(u(t,e,r),!0):this.Ao((()=>{if(this.xo(),"__proto__"===e)throw new Error("set __proto__ disabled");if(i!==this.Eo)return u(i,e,r),!0;if(this.Fo()&&j().Hn(this.en),this.Mo(e))throw new Error("Cannot set "+e);if(this.Bo(e))throw new Error("Cannot set "+e);if(this.ma(e))throw new Error("Cannot set "+e);if(this.Pa(e))throw new Error("Cannot set "+e);if(this.$o(e,r),this.Lo(e,r),this.Jo(t,e,r),this.Wo(e,"set"),!this.Ho(e))throw new Error("Cannot set private property "+e);if(this.Ut.nr)throw new Error("set disabled");this.Vo(),t=this.zo()||t,r=this.ko(this,r),this.Ko(r);const Unbound=n(11);return!this.Yo(e)||r instanceof Unbound||(r=new Unbound(r)),r instanceof R||(r=x.Co(r)||r),o((()=>u(t,e,r))),!0}))}ai(t,e){return this.So()?Reflect.setPrototypeOf(t,e):this.Ao((()=>{throw this.xo(),new Error("setPrototypeOf disabled")}))}ui(){if(!this.So())return this.Ao((()=>{this.xo(),this.jo()&&j()._read(this.en)}))}hi(t){return this.So()?t:this.Ao((()=>{if(this.xo(),this.Xo(t))return t;if(t instanceof R)return t;return t=this.No(t,this.en,!0,!1)}))}fi(t){return this.So()?t:this.Ao((()=>(this.xo(),t instanceof R?t:(this.$o("",t),t=this.ko(this,t),this.Ko(t),t=x.Co(t)||t))))}li(){if(!this.So())return this.Ao((()=>{this.xo(),this.jo()&&j()._read(this.en)}))}pi(){if(!this.So())return this.Ao((()=>{if(this.xo(),this.Fo()&&j().Hn(this.en),this.Ut.nr)throw new Error("Immutable");this.Vo(),this.zo()}))}xo(){if(!this.Ut.yi)return;const t=x.Co(this.en);if(!a(t,"location"))return;const{error:e,undeployed:n}=_(t.location);if(e&&!n)throw new Error(e)}Ao(t){const e=j();try{const n=t();if(e.un)throw e.un;return n}catch(t){throw e.st.length&&!e.un&&(e.un=t),t}}Vo(){if(!this.Ut.di)return;const t=j().st;if(!t.length||t[t.length-1].en!==this.en)throw new Error("Updates must be performed in a method")}$o(t,e){s("symbol"!=typeof t,"Symbol names are not serializable"),s(h(e),"Not serializable: "+c(e)),O(e,(t=>s(h(t),"Not serializable: "+c(t))))}Qo(t,e){if(this.Yo(e))try{if("location"===e||"origin"===e||"nonce"===e){const n=Reflect.get(t,e),r=_("nonce"===e?t.location:n);if(s(!r.undeployed,"Hint: Sync the jig to deploy it"),s(!r.error,"A previous error occurred\n\n"+r.error),r.nativeid)return;const o="Hint: Sync the jig to assign it in a transaction";s(r.txid,o)}if("owner"===e||"satoshis"===e){const r=Reflect.get(t,e),Unbound=n(11),o=r instanceof Unbound&&void 0===r.Dn;s(!o,"Hint: Sync the jig to assign it in a transaction");const i=!0;"owner"===e&&m(r instanceof Unbound?r.Dn:r,i),"satoshis"===e&&E(r instanceof Unbound?r.Dn:r,i)}}catch(t){throw new Error(`Cannot read ${e}\n\n${t.message}`)}}Jo(t,e,r){if(!this.Yo(e))return;s("origin"!==e,"Cannot set origin"),s("location"!==e,"Cannot set location"),s("nonce"!==e,"Cannot set nonce");const Unbound=n(11),o=`Cannot set ${e}\n\nHint: Sync the jig to bind it in a transaction`,i=this.Yo(e)&&t[e]instanceof Unbound&&t[e].Dn;s(!i,o);"owner"===e&&m(r,!1),"satoshis"===e&&E(r)}Lo(t,e){this.Ut.gi&&("sealed"===t&&Code.ie(e),"upgradable"===t&&Code.se(e))}Wo(t,e){if(!this.Ut._i)return;const n=`Cannot ${e} ${t}: reserved`;s(!f.includes(t),n),this.Ut.bi&&s(!p.includes(t),n),this.Ut.gi&&s(!l.includes(t),n),this.Ut.Ea&&s(!y.includes(t),n)}Ho(t,e=!1){if(!this.Ut.mi)return!0;if("string"!=typeof t||!t.startsWith("_"))return!0;if("__proto__"===t)return!0;const Jig=n(2),Berry=n(7),r=j().st;if(!r.length)return!e;const o=r[r.length-1].en;return"function"==typeof this.en?o===this.en||o.constructor===this.en:(i(this.en instanceof Jig||this.en instanceof Berry),o.constructor===this.en.constructor||o===this.en.constructor)}No(t,e,n,r,i,s=new Set){if(s.has(t))return t;if(!e)return t;if(!this.Pi(t))return t;if(t instanceof R)return t;const c=j().st,a=c.length&&c[c.length-1].en===this.en;if(a&&$.has(t))return t;return a||!r||i.has(t)?(t=this.Zo(t,e,n),a||(t=this.Ei(t)),t):(s.add(t),o((()=>{!function(t,e){if(Object.keys(t).forEach((n=>{u(t,n,e(t[n]))})),g(t)){const n=Array.from(t.values());t.clear(),n.forEach((n=>t.add(e(n))))}if(b(t)){const n=Array.from(t.entries());t.clear(),n.forEach((([n,r])=>t.set(e(n),e(r))))}}(t,(t=>this.No(t,e,n,r,i,s)))})),t)}Zo(t,e,n){if(x.Co(t))return t;if(k.has(e)||k.set(e,new WeakMap),k.get(e).has(t))return k.get(e).get(t);const r="function"==typeof t,o=T.Ft(e,r,n),i=new D(t,o);return k.get(e).set(t,i),i}Ei(t){if(!this.Ut.Oi)return t;if("function"==typeof t)return t;const e=j().st;if(e.length&&e[e.length-1].en===this.en)return t;const n=T.vi();return new D(t,n)}ko(t,e){if(!t.Ut.di)return e;const n=j().st;if(!(!n.length||n[n.length-1].en!==t.en))return e;if(!t.Pi(e))return e;if(e instanceof R)return e;const r=T.vi();return new D(e,r)}Ko(t){O(t,(t=>{if(t instanceof R)return!1;const e=x.Dt(t);if(e){if(e.Ut.Oo===this.en)return!1;const n=`Ownership violation\n\n${c(this.en)} claimed ${c(t)} owned by ${c(e.Ut.Oo)}`;s(!e.Ut.Oo,n),e.zo();const r="function"==typeof t,o=!0;e.Ut=T.Ft(this.en,r,o),e.en=this.en}else j().st.length&&$.add(t)}))}zo(){if(!this.Ut.vi)return;const t=x.Co(this.Eo),e=P(t,A);return x.Si(this.Eo,e),this.Ut.vi=!1,e}ti(t){let e=this.en,n=this.Eo;for(;!a(n,t);)n=Object.getPrototypeOf(n),i(n),e="object"==typeof n?n.constructor:n,e instanceof R||(e=null),e&&this.jo()&&x.Dt(e).jo()&&j()._read(e);return e}So(){return this.Ut.ln&&r()}Bo(t){return this.Ut.gi&&"deps"===t}Mo(t){return this.Ut.gi&&N.includes(t)}ma(t){return this.Ut.bi&&M.includes(t)}Pa(t){return this.Ut.Ea&&F.includes(t)}jo(){return this.Ut.Ai&&j().st.length}Fo(){return this.Ut.xi&&j().st.length}Yo(t){return!!this.Ut.wi&&((!this.Ut.Ea||"location"===t)&&v.includes(t))}Pi(t){return t&&("object"==typeof t||"function"==typeof t)}Xo(t){return["undefined","boolean","number","string","symbol"].includes(typeof t)||null===t}}function B(t,e){const Code=n(0);t instanceof Code&&Code.Yt(t).Lt();const r=P(e,A,(t=>{if("function"==typeof t&&!(t instanceof R)){const e=new Code(t);return Code.Yt(e).Lt(),e}t instanceof Code&&Code.Yt(t).Lt()}));return I([t,r],[t]),r}D.Er=B,t.exports=D},function(t,e,n){const{R:r}=n(1),o=n(22);class i{constructor(){this.Oo=!1,this.ln=!1,this.yi=!1,this.wi=!1,this._i=!1,this.gi=!1,this.bi=!1,this.Ea=!1,this.mi=!1,this.nr=!1,this.Ai=!1,this.xi=!1,this.Ro=!1,this.To=!1,this.di=!1,this.Io=!1,this.vi=!1,this.Oi=!1,this.Cr=[]}static ha(){const t=new i;return t.Oo=null,t.ln=!0,t.yi=!0,t.wi=!0,t._i=!0,t.gi=!0,t.bi=!1,t.Ea=!1,t.mi=!0,t.nr=!1,t.Ai=!0,t.xi=!0,t.Ro=!0,t.To=!0,t.di=!0,t.Io=!1,t.vi=!1,t.Oi=!1,t.Cr=[],t}static Ua(t){const e=new i;return e.Oo=null,e.ln=!0,e.yi=!0,e.wi=!0,e._i=!0,e.gi=!0,e.bi=!1,e.Ea=!1,e.mi=!1,e.nr=!0,e.Ai=!0,e.xi=!1,e.Ro=!1,e.To=!1,e.di=!1,e.Io=!t,e.vi=!1,e.Oi=!1,e.Cr=[],e}static Gt(){const t=new i;return t.Oo=null,t.ln=!0,t.yi=!0,t.wi=!0,t._i=!1,t.gi=!0,t.bi=!1,t.Ea=!1,t.mi=!1,t.nr=!0,t.Ai=!1,t.xi=!1,t.Ro=!1,t.To=!1,t.di=!0,t.Io=!1,t.vi=!1,t.Oi=!1,t.Cr=[],t}static Ma(){const t=new i;return t.Oo=null,t.ln=!0,t.yi=!0,t.wi=!0,t._i=!0,t.gi=!1,t.bi=!0,t.Ea=!1,t.mi=!0,t.nr=!1,t.Ai=!0,t.xi=!0,t.Ro=!0,t.To=!0,t.di=!0,t.Io=!1,t.vi=!1,t.Oi=!1,t.Cr=[],t}static Ga(){const t=new i;return t.Oo=null,t.ln=!0,t.yi=!0,t.wi=!0,t._i=!0,t.gi=!1,t.bi=!1,t.Ea=!0,t.mi=!1,t.nr=!0,t.Ai=!0,t.xi=!1,t.Ro=!1,t.To=!1,t.di=!1,t.Io=!1,t.vi=!1,t.Oi=!1,t.Cr=[],t}static vi(){const t=new i;return t.Oo=null,t.ln=!0,t.yi=!0,t.wi=!1,t._i=!1,t.gi=!1,t.bi=!1,t.Ea=!1,t.mi=!1,t.nr=!1,t.Ai=!1,t.xi=!1,t.Ro=!1,t.To=!1,t.di=!1,t.Io=!1,t.vi=!0,t.Oi=!1,t.Cr=[],t}static Ft(t,e,n){const s=o.Dt(t);r(s);const c=s.Ut,a=new i;return a.Oo=c.vi?null:t,a.ln=c.ln,a.yi=c.yi,a.wi=!1,a._i=!1,a.gi=!1,a.bi=!1,a.Ea=!1,a.mi=c.mi,a.nr=c.nr||e,a.Ai=c.Ai,a.xi=c.xi,a.Ro=c.Ro,a.To=!1,a.di=c.di,a.Io=c.Io&&n,a.vi=c.vi,a.Oi=c.Oi,a.Cr=[],a}}t.exports=i},function(t,e,n){const r=n(8),o=n(3),{g:i,R:s,le:c,D:a,P:u,h,j:f,Ue:l}=n(1),{J:p}=n(10),{StateError}=n(12),{G:y}=n(4),Code=n(0),d=n(17),w=n(18),g=n(23),b=n(5),{Da:_,dn:m}=n(9),E="State",v="04";class P{constructor(t,e){s(e instanceof Promise),this.Dn=t,this.wr=e}}t.exports={_a:async function(t,e,r){o.rt&&o.ot(E,"Capture",h(t));const i=e.qr.get(t);s(i);const c=await e.zr(r);r.Ne();const u=(new g).eo((t=>{const r=e.br.findIndex((e=>a(t,e)));if(r>=0)return"_o"+(r+1);const o=e.Pn.findIndex((e=>a(t,e)));if(o>=0)return"_d"+o;const i=e.Kr.find((e=>a(t,e)));if(i)return e.Yr.get(i).Un.location;const Berry=n(7),u=y((()=>t instanceof Berry?t.location:t.origin));if(u.startsWith("native://"))return u;const h=c[u]&&c[u][0];return s(h),h})),f={};i.Fi&&(f.cls=u.no(i.Fi)),f.kind=i.Mi;const l=Object.assign({},i.Un),p=e.br.findIndex((e=>a(e,t))),d=e.Pn.findIndex((e=>a(e,t))),w=-1===p?"_d"+d:"_o"+(p+1);return s(!l.origin.startsWith("commit://")||l.origin.startsWith(e.wn)),(l.origin.startsWith(e.wn)||l.origin.startsWith(e.Bi))&&(l.origin=w),l.location=w,f.props=u.no(l),i.et&&(f.src=i.et),f.version=v,f},da:function(t){const e=(new g).eo((t=>{const e=p(t.location);return s(e.txid&&!e.recordid&&!e.commitid&&!e.error),t.location})),n={};n.cls=e.no(t.constructor),n.kind="berry";const r=Object.assign({},t);return n.props=e.no(r),n.version=v,n},yr:async function(t,e,s){const a=n(14);s=s||new a(i());const h=await s.g.oo().get(t);if(!h)return;if(o.Jt&&o.Wt(E,"Recreate",t),u(h.version===v,"Unsupported state version: "+h.version),e){const n=l(h),o=new r.deps.Buffer(n,"utf8"),i=r.crypto.Hash.sha256(o).toString("hex");u(i===e,"State hash mismatch for "+t)}const p=new Map,O=(new g).Ui().Ni((t=>(p.set(t,null),(t=>{class e{}return e.location=t,e})(t)))),S=O.Di(h.props);h.cls&&O.Di(h.cls);const A=t.split("//")[1].split("_")[0];switch(h.kind){case"code":return async function(t,e,n,r,o){const i={},s=c(t.src);if(s){const t=e.deps[s].location,c=t.startsWith("_")?r+t:t,a=await o.cr(c,void 0,!0);n.set(t,a),i[s]=a}const a=new Code,h=b.yn(t.src,i)[0],[l,p]=Code.re(a,h),d=!1;Code.Yt(a).X(l,d);const w=(async()=>{for(const t of n.keys()){if(n.get(t))continue;const e=t.startsWith("_")?r+t:t,i=await o.cr(e,void 0,!0);n.set(t,i)}function e(t){const e=n.get(t),o=t.startsWith("_")?r+t:t;return u(e,"Jig not loaded: "+o),e}const i=(new g).Ui().Ni(e).Di(t.props);y((()=>{Object.keys(a).forEach((t=>{delete a[t]})),Object.keys(i).forEach((t=>f(a,t,i[t])))})),y((()=>{a.origin.startsWith("_")&&(a.origin=r+a.origin),a.location.startsWith("_")&&(a.location=r+a.location)})),y((()=>{const t=Code.oe(a,p,a.deps);f(a,"deps",t),Object.keys(i.deps||{}).forEach((t=>{a.deps[t]=i.deps[t]}))})),o.g.Bn("load",a)})();return new P(a,w)}(h,S,p,A,s);case"jig":return async function(t,e,n,r,o){const i=w.Ma(),s=new d(e,i);async function c(){for(const t of n.keys()){if(n.get(t))continue;const e=t.startsWith("_")?r+t:t,i=await o.cr(e,void 0,!0);n.set(t,i)}const e=n.get(t.cls.$jig);function i(t){const e=n.get(t),o=t.startsWith("_")?r+t:t;return u(e,"Jig not loaded: "+o),e}y((()=>Object.setPrototypeOf(s,e.prototype)));const c=(new g).Ui().Ni(i).Di(t.props);y((()=>{Object.keys(c).forEach((t=>{f(s,t,c[t])}))})),y((()=>{s.origin.startsWith("_")&&(s.origin=r+s.origin),s.location.startsWith("_")&&(s.location=r+s.location)})),o.g.Bn("load",s)}_.add(s);const a=c();return new P(s,a)}(h,S,p,A,s);case"berry":return async function(t,e,n,r){const o=w.Ga(),i=new d(e,o);async function s(){for(const t of n.keys()){if(n.get(t))continue;const e=await r.cr(t,void 0,!0);n.set(t,e)}const e=n.get(t.cls.$jig);function o(t){const e=n.get(t);return u(e,"Jig not loaded: "+t),e}y((()=>Object.setPrototypeOf(i,e.prototype)));const s=(new g).Ui().Ni(o).Di(t.props);y((()=>{Object.keys(s).forEach((t=>{f(i,t,s[t])}))})),r.g.Bn("load",i)}m.add(i);const c=s();return new P(i,c)}(h,S,p,s);default:throw new StateError("Unknown jig kind: "+h.kind)}},ba:function(t){const e=l(t),n=r.deps.Buffer.from(e,"utf8");return r.crypto.Hash.sha256(n).toString("hex")}}},function(t,e,n){const r=n(3),{RequestError,TimeoutError}=n(12),{Te:o}=n(1),i="REST";class s{static async Kn(t,e=s.$e,n={}){for(let o=0;o<=s.Ii;o++)try{return await s.ji(t,"GET",void 0,e,n)}catch(e){if(o===s.Ii)throw e;r.hn&&r.an(e.toString()),r.hn&&r.Wt(i,"GET",t,`(Retry ${o+1}/${s.Ii})`)}}static async Ti(t,e,n=s.$e,o={}){for(let c=0;c<=s.Ii;c++)try{return await s.ji(t,"POST",e,n,o)}catch(e){if(c===s.Ii)throw e;r.hn&&r.an(e.toString()),r.hn&&r.Wt(i,"POST",t,`(Retry ${c+1}/${s.Ii})`)}}static async ji(t,e,n,o,s){r.Jt&&r.Wt(i,e,t);let a=null;try{a=await c(t,e,n,o,s)}catch(n){throw n.message+=`\n\n${e} ${t}`,n}const{data:u,status:h,statusText:f}=a;if(h>=200&&h<300)return u;const l=u.message?u.message.message||u.message:u,p=u.name&&l?`${u.name}: ${l}`:u.name||l;throw new RequestError(p,h,f,e,t)}}let c=null;c=async function(t,e,n,r,i){const{AbortController:s,fetch:c}=window,a=new s;i.accept="application/json",n&&(i["content-type"]="application/json");const u={method:e,body:JSON.stringify(n),headers:i,signal:a.signal};let h=!1;const f=setTimeout((()=>{h=!0,a.abort()}),o(r));try{const e=await c(t,u);let n=null;const r=e.headers.get("content-type");return n=r&&r.includes("application/json")?await e.json():await e.text(),{data:n,status:e.status,statusText:e.statusText}}catch(t){if(h)throw new TimeoutError(`Request timed out after ${r}ms`);throw t}finally{clearTimeout(f)}},s.$e=3e4,s.Ii=2,t.exports=s},function(t,e,n){(function(e){const r=n(8),{Script:o,Transaction:i}=r,{Interpreter:s}=o,{Input:c}=i,{ECDSA:a,Hash:u,Signature:h}=r.crypto,{BufferReader:f,BufferWriter:l}=r.encoding,{BN:p}=r.deps.bnjs;t.exports={Ri:function(t){if(t.$i)return;t.$i=!0,i.FEE_PER_KB=500;const e=i.prototype.sign;i.prototype.sign=function(...t){const n=c.prototype.isValidSignature;c.prototype.isValidSignature=()=>!0;const r=e.call(this,...t);return c.prototype.isValidSignature=n,r},c.prototype.clearSignatures=()=>{},c.prototype.getSignatures=()=>[],c.prototype.isFullySigned=function(){return!!this.script.toBuffer().length},i.prototype.isFullySigned=function(){return!this.inputs.some((t=>!t.isFullySigned()))},i.prototype.isValidSignature=function(t){const e=new s,n=t.inputIndex,r=this.inputs[n],o=s.SCRIPT_VERIFY_STRICTENC|s.SCRIPT_VERIFY_DERSIG|s.SCRIPT_VERIFY_LOW_S|s.SCRIPT_VERIFY_NULLDUMMY|s.SCRIPT_VERIFY_SIGPUSHONLY|s.SCRIPT_ENABLE_MONOLITH_OPCODES|s.SCRIPT_ENABLE_MAGNETIC_OPCODES|s.SCRIPT_ENABLE_SIGHASH_FORKID;return e.verify(r.script,r.output.script,this,n,o,r.output.satoshisBN)}},ki:function(t){const{Hash:e}=r.crypto;return t._hash=t._hash||e.sha256(t.toBuffer()).reverse().toString("hex"),t._hash},Ci:function(t,n,r,o,i,c=h.SIGHASH_ALL){c|=h.SIGHASH_FORKID;const y=new p(o),d=(s.SCRIPT_ENABLE_SIGHASH_FORKID,function(t,n,r,o,i){const s=t.inputs[r];function c(e){const n=new l;if(void 0===e){if(t._hashOutputsAll)return t._hashOutputsAll;t.outputs.forEach((t=>{t.toBufferWriter(n)}))}else t.outputs[e].toBufferWriter(n);const r=n.toBuffer(),o=u.sha256sha256(r);return void 0===e&&(t._hashOutputsAll=o),o}let a=e.alloc(32),p=e.alloc(32),y=e.alloc(32);n&h.SIGHASH_ANYONECANPAY||(a=function(){if(t._hashPrevouts)return t._hashPrevouts;const e=new l;t.inputs.forEach((t=>{e.writeReverse(t.prevTxId),e.writeUInt32LE(t.outputIndex)}));const n=e.toBuffer();return t._hashPrevouts=u.sha256sha256(n),t._hashPrevouts}()),n&h.SIGHASH_ANYONECANPAY||(31&n)===h.SIGHASH_SINGLE||(31&n)===h.SIGHASH_NONE||(p=function(){if(t._hashSequence)return t._hashSequence;const e=new l;t.inputs.forEach((t=>{e.writeUInt32LE(t.sequenceNumber)}));const n=e.toBuffer();return t._hashSequence=u.sha256sha256(n),t._hashSequence}()),(31&n)!==h.SIGHASH_SINGLE&&(31&n)!==h.SIGHASH_NONE?y=c():(31&n)===h.SIGHASH_SINGLE&&r<t.outputs.length&&(y=c(r));const d=new l;d.writeInt32LE(t.version),d.write(a),d.write(p),d.writeReverse(s.prevTxId),d.writeUInt32LE(s.outputIndex),d.writeVarintNum(o.toBuffer().length),d.write(o.toBuffer()),d.writeUInt64LEBN(i),d.writeUInt32LE(s.sequenceNumber),d.write(y),d.writeUInt32LE(t.nLockTime),d.writeUInt32LE(n>>>0);const w=d.toBuffer(),g=u.sha256sha256(w);return new f(g).readReverse()}(t,c,n,r,y)),w=a.sign(d,i,"little"),g=e.from(w.toDER());return e.concat([g,e.from([255&c])]).toString("hex")}}}).call(this,n(34).Buffer)},function(t,e,n){const{we:r,ge:o,_e:i,Ae:s,xe:c,R:a}=n(1),u=n(5),h=u.K,f=new WeakMap,l=new WeakMap,p=new WeakMap,y=new WeakMap,d=s(Set.prototype),w=s(Map.prototype),g=s(Uint8Array.prototype).concat(s(Object.getPrototypeOf(Uint8Array.prototype))),b=c(Set.prototype),_=c(Map.prototype),m=c(Uint8Array.prototype).concat(c(Object.getPrototypeOf(Uint8Array.prototype))),E=["add","clear","copyWithin","delete","fill","reverse","set","sort"],v=["entries","every","filter","find","findIndex","forEach","get","has","includes","indexOf","join","keys","lastIndexOf","map","reduce","reduceRight","slice","some","subarray","toLocaleString","toString","values",Symbol.iterator];class P{constructor(t,e){const n=new h.Proxy(t,this);return f.set(n,t),l.set(t,e),l.set(n,e),p.set(n,this),this.Gi=e,this.Li=t,this.Ji=r(t),this.Wi=o(t),this.Hi=i(t),n}apply(t,e,n){return this.Gi.vo?this.Gi.vo(this.Li,e,n):Reflect.apply(this.Li,e,n)}construct(t,e,n){return this.Gi.Uo?this.Gi.Uo(this.Li,e,n):Reflect.construct(this.Li,e,n)}defineProperty(t,e,n){return this.Gi.Do?this.Gi.Do(this.Li,e,n):Reflect.defineProperty(this.Li,e,n)}deleteProperty(t,e){return this.Gi.qo?this.Gi.qo(this.Li,e):Reflect.deleteProperty(this.Li,e)}getOwnPropertyDescriptor(t,e){return this.Gi.ei?this.Gi.ei(this.Li,e):Reflect.getOwnPropertyDescriptor(this.Li,e)}getPrototypeOf(t){return this.Gi.ni?this.Gi.ni(this.Li):Reflect.getPrototypeOf(this.Li)}has(t,e){return this.Gi.ri?this.Gi.ri(this.Li,e):Reflect.has(this.Li,e)}isExtensible(t){return this.Gi.oi?this.Gi.oi(this.Li):Reflect.isExtensible(this.Li)}ownKeys(t){return this.Gi.ii?this.Gi.ii(this.Li):Reflect.ownKeys(this.Li)}preventExtensions(t){return this.Gi.si?this.Gi.si(this.Li):Reflect.preventExtensions(this.Li)}set(t,e,n,r){return this.Gi.ci?this.Gi.ci(this.Li,e,n,r):Reflect.set(this.Li,e,n,r)}setPrototypeOf(t,e){return this.Gi.ai?this.Gi.ai(this.Li,e):Reflect.setPrototypeOf(this.Li,e)}get(t,e,n){if(this.Ji&&d.includes(e)||this.Wi&&w.includes(e)||this.Hi&&g.includes(e))return this.Gi.ui&&this.Gi.ui(),Reflect.get(this.Li,e,this.Li);if(this.Ji&&b.includes(e)||this.Wi&&_.includes(e)||this.Hi&&m.includes(e)){const t=Reflect.get(this.Li,e,n);if(this.Gi.ui&&this.Gi.ui(),y.has(t))return y.get(t);const r=new O(this.Ji,this.Wi,this.Hi,e),o=new Proxy(t,r);return y.set(t,o),o}return this.Gi.Kn?this.Gi.Kn(this.Li,e,n):Reflect.get(this.Li,e,n)}static Dt(t){return l.get(t)}static Co(t){return f.get(t)}static Si(t,e){const n=f.get(t),r=l.get(t),o=p.get(t);a(n),o.Li=e,l.delete(n),l.set(e,r),f.set(t,e)}}class O{constructor(t,e,n,r){this.Ji=t,this.Wi=e,this._e=n,this.Vi=r,this._read=v.includes(r),this.Hn=E.includes(r),this.zi=t&&["add"].includes(r)||e&&["set"].includes(r)||n&&["copyWithin","fill","reverse","sort"].includes(r),this.Ki=t&&["entries","values",Symbol.iterator].includes(r)||e&&["entries","keys","values",Symbol.iterator].includes(r),this.Yi=this.Ki&&"entries"===r,this.qi=e&&"get"===r,this.Zi=t&&["add","delete","has"].includes(r)||e&&["delete","get","has","set"].includes(r),this.Qi=e&&"set"===r,this.Xi=t&&"forEach"===r||e&&"forEach"===r}apply(t,e,n){const r=P.Dt(e);r&&(r.li&&this._read&&r.li(),r.pi&&this.Hn&&r.pi()),this.Xi&&(n[0]=t=>r&&r.hi&&t?r.hi(t):t),this.Zi&&n[0]&&r&&r.fi&&(n[0]=r.fi(n[0])),this.Qi&&n[1]&&r&&r.fi&&(n[1]=r.fi(n[1]));const o=P.Co(e)||e,i=Reflect.apply(t,o,n);return this.zi?e:this.qi?r&&r.hi&&i?r.hi(i):i:this.Ki?new A(i,r,this.Yi):i}}class S{constructor(t,e,n){this.ts=t,this.Gi=e,this.es=n}next(){const t=this.ts.next(),e={};if(e.done=t.done,e.value=t.value,this.Gi&&this.Gi.hi)if(this.es&&e.value){const t=e.value[0]?this.Gi.hi(e.value[0]):e.value[0],n=e.value[1]?this.Gi.hi(e.value[1]):e.value[1];e.value=[t,n]}else e.value=e.value?this.Gi.hi(e.value):e.value;return e}[Symbol.iterator](){return this}}const A=u.Bt(S,{},!0,!1)[0];t.exports=P},function(t,e,n){(function(e){const{h:r,A:o,de:i,we:s,ge:c,_e:a,S:u,De:h}=n(1),f=n(9),l=n(5),p=l.K,y=l.ae,d=l.he,w=l.ue,g=new Set;"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split("").forEach((t=>g.add(t)));const b=t=>{throw new Error("Cannot encode "+r(t))},_=t=>{throw new Error("Cannot decode "+r(JSON.stringify(t)))};t.exports=class{constructor(){this.ns=y,this.rs=void 0,this.os=void 0,this.ss=new Map,this.cs=new Map,this.us=null}no(t){return this.ss=new Map,this.hs(t,[])}Di(t){return this.cs=new Map,this.us=t,this.fs(t)}Ui(){return this.ns=p,this}eo(t){return this.rs=t,this}Ni(t){return this.os=t,this}hs(t,e){switch(typeof t){case"undefined":{const t=this.ls();return t.$und=1,t}case"string":case"boolean":return t;case"number":if(isNaN(t)||!isFinite(t)||Object.is(t,-0)){const e=this.ls();return isNaN(t)&&(e.$nan=1),t===1/0&&(e.$inf=1),t===-1/0&&(e.$ninf=1),Object.is(t,-0)&&(e.$n0=1),e}return t;case"symbol":break;case"object":case"function":if(!t)return null;if(this.ss.has(t)){const e=this.ls();return e.$dup=this.ns.Array.from(this.ss.get(t)),e}return this.ss.set(t,e),this.ps(t,e)}b(t)}ps(t,n){if((d.has(t)||w.has(t))&&b(t),o(t)){const e=h(t).some((t=>t.startsWith("$"))),r=this.ls();let o=r,i=n;return e&&(r.$obj=this.ls(),o=r.$obj,i=n.concat(["$obj"])),h(t).forEach((e=>{o[e]=this.hs(t[e],i.concat([e.toString()]))})),r}if(i(t)){const e=h(t);if(e.length===t.length){const r=this.ys();return e.forEach((e=>r.push(this.hs(t[e],n.concat([e.toString()]))))),r}{const r=this.ls(),o=this.ls(),i=n.concat(["$arr"]);return e.forEach((e=>{o[e]=this.hs(t[e],i.concat([e.toString()]))})),r.$arr=o,r}}if(s(t)){const e=this.ls();e.$set=this.ys();let r=0;const o=n.concat(["$set"]);for(const n of t)e.$set.push(this.hs(n,o.concat([r.toString()]))),r++;if(h(t).length){e.props=this.ls();const r=n.concat(["props"]);h(t).forEach((n=>{e.props[n]=this.hs(t[n],r.concat([n.toString()]))}))}return e}if(c(t)){const e=this.ls();e.$map=this.ys();let r=0;const o=n.concat(["$map"]);for(const[n,i]of t){const t=this.ys();t.push(this.hs(n,o.concat([r.toString(),"0"]))),t.push(this.hs(i,o.concat([r.toString(),"1"]))),e.$map.push(t),r++}if(h(t).length){e.props=this.ls();const r=n.concat(["props"]);h(t).forEach((n=>{e.props[n]=this.hs(t[n],r.concat([n.toString()]))}))}return e}if(a(t)){h(t).length!==t.length&&b(t);const n=this.ls(),r=e.from(new Uint8Array(t));return n.$ui8a=r.toString("base64"),n}if(this.rs){if(t instanceof f){const e=this.ls();return e.$jig=this.rs(t),e}const e=this.ls(),r=Object.assign({},t),o=n.concat(["$arb"]),i=n.concat(["T"]);return e.$arb=this.hs(r,o),e.T=this.hs(t.constructor,i),e}b(t)}fs(t){switch(typeof t){case"string":case"boolean":return t;case"number":if(isNaN(t)||!isFinite(t))break;return Object.is(t,-0)?0:t;case"object":case"function":return t?this.ds(t):null}_(t)}ds(t){if(o(t)){let n;if(h(t).forEach((e=>{e.startsWith("$")&&(n&&_(t),n=e)})),"$und"===n&&1===t.$und)return;if("$n0"===n&&1===t.$n0)return-0;if("$nan"===n&&1===t.$nan)return NaN;if("$inf"===n&&1===t.$inf)return 1/0;if("$ninf"===n&&1===t.$ninf)return-1/0;if(!n){const e=this.ls();return this.cs.set(t,e),h(t).forEach((n=>{e[n]=this.fs(t[n])})),e}if("$obj"===n){const e=t.$obj;o(e)&&e||_(t);const n=this.ls();return this.cs.set(t,n),h(e).forEach((t=>{n[t]=this.fs(e[t])})),n}if("$arr"===n){o(t.$arr)&&t.$arr||_(t);const e=this.ys();this.cs.set(t,e);const n=t.$arr;return h(n).forEach((t=>{e[t]=this.fs(n[t])})),e}if("$dup"===n){const e=t.$dup;i(e)||_(t);let n=this.us;for(let r=0;r<e.length;r++){const o=e[r];o in n||_(t),n=n[o]}this.cs.has(n)||_(t);const r=this.cs.get(n);return this.cs.set(t,r),r}if("$set"===n){i(t.$set)||_(t),u(t.props)||o(t.props)||_(t);const e=this.ws();this.cs.set(t,e);for(const n of t.$set)e.add(this.fs(n));const n=t.props;return n&&h(n).forEach((t=>{e[t]=this.fs(n[t])})),e}if("$map"===n){i(t.$map)||_(t),u(t.props)||o(t.props)||_(t);const e=this.gs();this.cs.set(t,e);for(const n of t.$map)i(n)&&2===n.length||_(t),e.set(this.fs(n[0]),this.fs(n[1]));const n=t.props;return n&&h(n).forEach((t=>{e[t]=this.fs(n[t])})),e}if("$ui8a"===n){"string"!=typeof t.$ui8a&&_(t),t.$ui8a.split("").some((t=>!g.has(t)))&&_(t);const n=e.from(t.$ui8a,"base64"),r=new this.ns.Uint8Array(n);return this.cs.set(r,r),r}}if(i(t)){const e=this.ys();this.cs.set(t,e);for(const n of t)e.push(this.fs(n));return e}if(this.os){if(o(t)&&!u(t.$jig)){const e=this.os(t.$jig);if(e)return this.cs.set(t,e),e}if(o(t)&&!u(t.$arb)&&!u(t.T)){const e=this.ls();this.cs.set(t,e),Object.assign(e,this.fs(t.$arb));const n=this.fs(t.T);return Object.setPrototypeOf(e,n.prototype),e}}_(t)}ls(){return new this.ns.Object}ys(){return new this.ns.Array}ws(){return new this.ns.Set}gs(){return new this.ns.Map}}}).call(this,n(34).Buffer)},function(t,e,n){const r=n(6),o=n(28),i=n(25),s=n(3),{R:c,P:a,h:u,g:h,Re:f,_:l}=n(1),{Pr:p}=n(14),y="Transaction";class d{constructor(){this.bs=new r,this.bs.Ba=!1,this.bs.xn=!1,this.$n=null,this.Ps=null,this.Aa=null,this.Ja=null,this.Wa=null,this.Es=null,this.Os=null,this.vs=!1}get outputs(){return i.Ka(this.bs)[1]}get deletes(){return[...this.bs.Pn]}update(t){if(l("function"==typeof t,"Invalid callback"),s.Jt&&s.Wt(y,"Update"),a(!d.it,"update disabled during atomic update"),this.Es)throw new Error("update disabled during export");if(this.Os)throw new Error("update disabled during publish");if(this.Ja)throw new Error("update disabled during pay");if(this.Wa)throw new Error("update disabled during sign");if(this.Aa)throw new Error("update disabled during build");if(this.vs)throw new Error("update disabled once published");this.$n&&this.$n.Ss(),this.$n=null,this.Ps=null;const e=r.ct;try{r.ct=this.bs,r.ct.Tn();let n=null;try{d.it=!0,n=t()}finally{d.it=!1}if(n instanceof Promise)throw new Error("async transactions not supported");return r.ct.Rn(),n}catch(t){throw this.rollback(),t}finally{r.ct=e}}pay(){if(a(!d.it,"pay disabled during atomic update"),this.Wa)throw new Error("pay disabled during sign");if(this.Es)throw new Error("pay disabled during export");if(this.Os)throw new Error("pay disabled during publish");if(this.Ja)return this.Ja;if(this.Aa)throw new Error("pay disabled during build");const t=new f("pay"),e=async()=>{const{yo:e,do:r}=n(16);await e.Br((async()=>{this.Ps=await r(this.Ps,this.$n),t.Ne()}))};return this.Ja=this.xa(t,!1).then((()=>e())),this.Ja.then((()=>{this.Ja=null})).catch((t=>{throw this.Ja=null,t})),this.Ja}sign(){if(a(!d.it,"sign disabled during atomic update"),this.Ja)throw new Error("sign disabled during pay");if(this.Es)throw new Error("sign disabled during export");if(this.Os)throw new Error("sign disabled during publish");if(this.Wa)return this.Wa;if(this.Aa)throw new Error("sign disabled during build");const t=new f("sign"),e=async()=>{const{yo:e,wo:r}=n(16);await e.Br((async()=>{this.Ps=await r(this.Ps,this.$n),t.Ne()}))};return this.Wa=this.xa(t,!1).then((()=>e())),this.Wa.then((()=>{this.Wa=null})).catch((t=>{throw this.Wa=null,t})),this.Wa}publish(t={}){s.Jt&&s.Wt(y,"Publish");const e=new Date;if(a(!d.it,"publish disabled during atomic update"),this.Ja)throw new Error("publish disabled during pay");if(this.Wa)throw new Error("publish disabled during sign");if(this.Es)throw new Error("publish disabled during export");if(this.Os)return this.Os;if(this.vs)return!0;if(this.Aa)throw new Error("publish disabled during build");l(void 0===t.pay||"boolean"==typeof t.pay,"Invalid pay: "+u(t.pay)),l(void 0===t.sign||"boolean"==typeof t.sign,"Invalid sign: "+u(t.sign));const n=void 0===t.pay||t.pay,r=void 0===t.sign||t.sign,o=new f("publish");this.Os=this.xa(o,!0).then((()=>this.As(n,r,o)));return this.Os.then((()=>{s.rt&&s.ot(y,"Publish (end): "+(new Date-e)+"ms"),this.vs=!0,this.Os=null})).catch((t=>{throw this.Os=null,t})),this.Os}export(t={}){s.Jt&&s.Wt(y,"Export");const e=new Date;if(a(!d.it,"export disabled during atomic update"),this.Ja)throw new Error("export disabled during pay");if(this.Wa)throw new Error("export disabled during sign");if(this.Os)throw new Error("export disabled during publish");if(this.Es)return this.Es;l(void 0===t.pay||"boolean"==typeof t.pay,"Invalid pay: "+u(t.pay)),l(void 0===t.sign||"boolean"==typeof t.sign,"Invalid sign: "+u(t.sign));const n=void 0===t.pay||t.pay,r=void 0===t.sign||t.sign,o=new f("export");this.Es=this.xa(o,!1).then((()=>this.js(n,r,o)));return this.Es.then((t=>(s.rt&&s.ot(y,"Export (end): "+(new Date-e)+"ms"),this.Es=null,t))).catch((t=>{throw this.Es=null,t})),this.Es}rollback(){if(s.Jt&&s.Wt(y,"Rollback"),a(!d.it,"rollback disabled during atomic update"),this.Es)throw new Error("rollback disabled during export");if(this.Os)throw new Error("rollback disabled during publish");if(this.Ja)throw new Error("rollback disabled during pay");if(this.Wa)throw new Error("rollback disabled during sign");if(this.Aa)throw new Error("rollback disabled during build");if(this.vs)throw new Error("rollback disabled once published");this.bs.ht(),this.bs=new r,this.bs.Ba=!1,this.bs.xn=!1}static async Is(t,e){s.Jt&&s.Wt(y,"Replay");const n=p(t),r=h(),i=await o(t,e,n,r,!1,null,undefined,!1),c=new d;return c.bs=i.bs,c.$n=i,c.Ps=t,c}xa(t,e){if(this.$n&&this.Ps)return e&&this.$n.Ra(!0),Promise.resolve();if(c(!this.$n&&!this.Ps),this.Aa)return this.Aa;const n=this.bs.$n();if(!n)throw new Error("Nothing to commit");return e&&n.Ra(!0),this.Aa=this.Ia(n,t),this.Aa.then((t=>(this.Aa=null,t))).catch((t=>{throw this.Aa=null,t})),this.Aa}async Ia(t,e){try{await t.$a(),c(!t.Nr.length);const{io:r,so:o,co:i,ao:s,uo:a,ho:u,fo:h,lo:f,po:l}=n(16);await r(t,e),e.Ne(),await o(t),e.Ne(),i(t);const p=s(t),y=await a(t,e);e.Ne();const d=u(y),w=h(t,p),g=l(t,f(t,d,w,p));this.$n=t,this.Ps=g}catch(e){throw t.Dr()&&t.Vr(e),t.Ss(),e}}async As(t,e,r){const{uo:o,yo:i,do:s,wo:c,_o:h,Ta:f,bo:l,mo:p}=n(16);this.$n.Dr()||this.$n.Ra(!0);try{const n=await o(this.$n,r);r.Ne();const y=await i.Br((async()=>{const n=this.Ps,o=t?await s(n,this.$n):n;r.Ne();const i=e?await c(o,this.$n):o;r.Ne(),h(i,this.$n);const l=await f(this.$n,i,r);return a("string"==typeof l&&64===l.length,"Invalid txid: "+u(l)),r.Ne(),l}));r.Ne(),l(this.$n,y),await p(this.$n,n,y),r.Ne(),this.$n.g.Wr.add(y),this.$n.Hr()}catch(t){throw this.$n.Vr(t),t}}async js(t,e,r){const{yo:o,do:i,wo:s}=n(16),c=await o.Br((async()=>{const n=this.Ps,o=t?await i(n,this.$n):n;r.Ne();const c=e?await s(o,this.$n):o;return r.Ne(),c}));return r.Ne(),c.toString("hex")}}d.it=!1,t.exports=d},function(t,e,n){const{R:r,g:o,D:i,Ie:s,je:c}=n(1),{G:a}=n(4),{B:u}=n(13),{L:h}=n(10),f=n(27),l=n(3),p=n(16),y="Commit",d=new Map;class w{constructor(t){const e=t.wn.split("record://")[1];this.wn="commit://"+e,l.rt&&l.ot(y,"Create",this.wn),this.bs=t;const[n,i,s]=w.Ka(t);this.Xr=n,this.br=i,this.Kr=s,this.ft=[...t.ft],this.Pn=[...t.Pn],this._n=[...t._n],r(this._n.length),r(this.Xr.length||this.br.length||this.Pn.length),this.Nr=t.vn.filter((t=>!t.vs)),this.Cs=[],this.Nr.forEach((t=>t.Cs.push(this))),this.Ns(),this.Us(),this.Yr=new Map(t.An),this.qr=new Map;this.br.concat(this.Pn).forEach((t=>{const e=new f(t);this.qr.set(t,e)})),this.Rs=t.Ds,this.Bi=null,this.ka=[],this.Ca=[],this.vs=!1,this.g=o(),this.bs.xn&&(this.Ra(!0),this.$a().then((()=>p(this)))),this.bs.Ba||(this.br.forEach((t=>this.g.Bn("update",t))),this.Pn.forEach((t=>this.g.Bn("update",t))))}Ra(t){t?(r(!this.vs),r(!d.has(this.wn)),d.set(this.wn,this)):(d.delete(this.wn),r(!this.Ca.length),r(!this.Cs.length))}Dr(){return d.has(this.wn)}$a(){return this.Nr.length?new Promise(((t,e)=>this.ka.push({resolve:t,reject:e}))):Promise.resolve()}Na(){return r(this.Dr()),new Promise(((t,e)=>this.Ca.push({resolve:t,reject:e})))}Ns(){this.Ms=new Map,a((()=>{this.br.forEach(((t,e)=>{const n={};n.location=t.location,n.origin=t.origin,n.nonce=t.nonce,this.Ms.set(t,n)})),this.Pn.forEach(((t,e)=>{const n={};n.location=t.location,n.origin=t.origin,n.nonce=t.nonce,this.Ms.set(t,n)}))}))}Ss(){a((()=>{for(const[t,e]of this.Ms.entries())Object.assign(t,e)}))}Us(){a((()=>{this.br.forEach(((t,e)=>{const n=`${this.wn}_o${e+1}`,r=t.origin!==t.location;t.origin=r?t.origin:n,t.location=n,t.nonce=t.nonce+1})),this.Pn.forEach(((t,e)=>{const n=`${this.wn}_d${e}`,r=t.origin!==t.location;t.origin=r?t.origin:n,t.location=n,t.nonce=t.nonce+1}))}))}Bs(t){const Unbound=n(11);this.Nr=this.Nr.filter((e=>e!==t));for(const[e,n]of t.qr){const t=this.Xr.find((t=>i(t,e)))||this.Kr.find((t=>i(t,e)));if(!t)continue;const r=this.Yr.get(t);r&&h.forEach((t=>{r.Un[t]=n.Un[t]}));const o=this.qr.get(t);if(o){const t=o.Un;o.Un.origin=n.Un.origin,t.owner instanceof Unbound&&!t.owner.Dn&&(t.owner=n.Un.owner),t.satoshis instanceof Unbound&&!t.satoshis.Dn&&(t.satoshis=n.Un.satoshis)}const s=this.Ms.get(t);s&&(s.origin=n.Un.origin),this.Qr(t)||a((()=>{t.owner instanceof Unbound&&!t.owner.Dn&&(t.owner=n.Un.owner),t.satoshis instanceof Unbound&&!t.satoshis.Dn&&(t.satoshis=n.Un.satoshis)}))}this.Nr.length||(this.ka.forEach((t=>t.resolve())),this.ka=[])}Qr(t){for(const e of this.Cs)for(const n of e.Xr)if(i(t,n))return!0;return!1}async zr(t){if(this.Rs)return this.Rs;const e=new(n(14))(this.g,t),r=this.Xr.concat(this.Kr).map((t=>this.Yr.get(t).Un.location)),o=await Promise.all(r.map((t=>e.cr(t))));return this.Rs=w.Ya(o,t),this.Rs}static async Ya(t,e){l.rt&&l.ot(y,"Build refmap");const Jig=n(2),Code=n(0),Berry=n(7),r={};return u(t,(e=>e instanceof Jig||e instanceof Code?(a((()=>{(!(e.origin in r)||r[e.origin][1]<=e.nonce)&&(r[e.origin]=[e.location,e.nonce])})),t.includes(e)):e instanceof Berry?(a((()=>{r[e.location]=[e.location,0]})),t.includes(e)):void 0)),r}Hr(){this.vs=!0,this.Ca.forEach((t=>t.resolve())),this.Ca=[],this.Cs.forEach((t=>t.Bs(this))),this.Cs=[],this.Ra(!1),this.br.filter((t=>!this.Qr(t))).forEach((t=>this.g.Bn("publish",t))),this.Pn.filter((t=>!this.Qr(t))).forEach((t=>this.g.Bn("publish",t)))}Vr(t){r(t),this.vs=!1,this.Cs.forEach((e=>e.Vr(t)));const e=t&&0===this.Ca.length;l.fn&&l.un(y,e?"Unhandled":"",t),l.rt&&l.ot(y,"Rollback "+this.wn);for(const[,e]of this.Yr)e.ht(t);if(e){const e="error://Unhandled "+t;a((()=>{this.br.forEach((t=>{t.location=e})),this.Pn.forEach((t=>{t.location=e}))}))}this.bs.Ba||(this.br.forEach((t=>this.g.Bn("update",t))),this.Pn.forEach((t=>this.g.Bn("update",t)))),t&&(this.Ca.forEach((e=>e.reject(t))),this.Ca=[]),this.Ra(!1)}}w.ja=t=>d.get(t),w.Gs=async()=>{const t=[];for(const e of d.values())t.push(e.Na());return Promise.all(t)},w.Ka=function(t){const e=c(s(s(t.mn,t.En),t.Pn),t.ft),n=c(s(e,t.ft),t.Pn);return[e,n,c(c(c(t.bn,e),n),t.Pn)]},t.exports=w},function(t,e,n){const r=n(9),{h:o,P:i,R:s,I:c}=n(1),{B:a,qn:u}=n(13),{G:h}=n(4),{StateError}=n(12);let f=!0;t.exports={Oa:function(t,e,i){return h((()=>{const Berry=n(7),c=t=>t instanceof Berry?t.location:t.origin,h=t.concat(e),f={};h.forEach((t=>{const e=c(t),n=f[e];if(n){const e="1st location: "+t.location,r="2nd location: "+n.location,i=`Inconsistent reference: ${o(t)}\n\n${e}\n${r}`;throw new StateError(i)}f[e]=t}));const l={},p=new Set,y=new Map;h.forEach((t=>{l[c(t)]=t})),a(h,(t=>{if(t instanceof r){p.add(t);const e=c(t),n=f[e];if(n&&t.nonce>n.nonce){const e="1st location: "+t.location,r="2nd location: "+n.location;throw new StateError(`Time travel: ${o(t)}\n\n${e}\n${r}`)}const r=l[e];(!r||t.nonce>r.nonce)&&(l[e]=t)}})),i&&(l[i.origin]=i),u(i,((t,e)=>{if(t!==i&&t instanceof r){e(!1);const n=c(t);return l[n]}}));for(const e of p){const n=new Map;u(e,((t,o)=>{if(t!==e&&t instanceof r){const e=c(t),r=l[e];return t!==r&&n.set(r,t),s(r),o(!1),r}})),t.includes(e)||y.set(e,n)}const d={};return Object.entries(l).forEach((([t,e])=>{d[t]=[e.location,e.nonce]})),{Rs:d,va:y}}))},Sa:function(t){h((()=>{for(const[e,n]of t.entries())u(e,((t,o)=>{if(t!==e&&t instanceof r)return o(!1),n.get(t)||t}))}))},ua:function(t,e=[]){if(!f)return;const Berry=n(7),l=t=>h((()=>{const e=t instanceof Berry?"location":"origin";return!c(t,e)||t[e].startsWith("error://")?t:t[e]}));return h((()=>{const n=new Map;return e.forEach((t=>{s(t instanceof r);const e=l(t),c=!n.has(e)||n.get(e).nonce===t.nonce;i(c,"Cannot unify inconsistent "+o(t)),n.set(e,t)})),a(t,(t=>{if(t instanceof r){const r=l(t),i=n.get(r)||t;if(n.has(r)||n.set(r,t),t.nonce>i.nonce){if(e.includes(i)){const e="1st location: "+t.location,n="2nd location: "+i.location;throw new Error(`Cannot unify inconsistent ${o(t)}\n\n${e}\n${n}`)}n.set(r,t)}}})),u(t,(t=>{if(t instanceof r)return n.get(l(t))}))}))},qa:function(t){f=t}}},function(t,e,n){const{h:r,j:o}=n(1),{M:i}=n(13),{G:s}=n(4),{Kt:c}=n(10),a=n(5).K,u=n(3);t.exports=class{constructor(t,e,n){u.rt&&u.ot("Snapshot","Snapshot",r(t),e?"(bindings only)":""),this.en=t,e?this.Za(n):this.za()}Za(t){const Berry=n(7),e=this.en,r=this.Un={};this.Va=!0,this.Qa=t,s((()=>{r.location=e.location,r.origin=e.origin,r.nonce=e.nonce,e instanceof Berry||(r.owner=i(e.owner,a),r.satoshis=e.satoshis)}))}za(){const t=this.en;this.Va=!1,this.Qa=!1;const Jig=n(2),Code=n(0),Berry=n(7);if(t instanceof Jig)this.Mi="jig";else if(t instanceof Code)this.Mi=Code.Yt(t).nt?"native":"code";else{if(!(t instanceof Berry))throw new Error("Must only snapshot jigs: "+r(t));this.Mi="berry"}if(s((()=>{const e=Object.assign({},t),n=i(e,a);this.Un=n})),"jig"!==this.Mi&&"berry"!==this.Mi||(this.Fi=s((()=>t.constructor))),"code"===this.Mi){const e=Code.Yt(t);this.et=e.et,this._s=e.Ht()}}ht(t){if("native"!==this.Mi&&!this.Qa)return s((()=>{if(this.Va)if(t){const e="error://A previous error occurred\n\n"+t;o(this.en,"location",e)}else o(this.en,"location",c);else{if("code"===this.Mi){n(0).Yt(this.en).zt(this._s)}if(Object.keys(this.en).forEach((t=>{delete this.en[t]})),Object.keys(this.Un).forEach((t=>{o(this.en,t,this.Un[t])})),t){const Jig=n(2);if(this.en instanceof Jig&&this.Un.location===c){const e="error://Deploy failed\n\n"+t;o(this.en,"origin",e),o(this.en,"location",e)}}}}))}}},function(t,e,n){const{h:r,P:o,Ie:i,Ue:s,Re:c}=n(1),a=n(3),u=n(14),h=n(6),{Oa:f,Sa:l,qa:p}=n(26),{G:y}=n(4),d=n(23),{ao:w,co:g,uo:b,ho:_,fo:m,lo:E,po:v,bo:P,mo:O}=n(16),S="Replay";async function A(t,e,A,x,I,T,R,j){const k=n(54);a.Jt&&a.Wt(S,"Replay",e);const $=new Date;(R=R||new c("replay",x.$e)).Ne();const C=A.exec.some((t=>"DEPLOY"===t.op)),U=A.exec.some((t=>"UPGRADE"===t.op));if(!j&&(C||U)&&!x.Wr.has(e)&&!x.Wr.has("*")){throw new Error(`Cannot load untrusted code: ${e}\n\n${"Hint: Trust this txid using run.trust if you know it is safe"}`)}let N=[],M=[];const F=new u(x,R),D=t=>{j||x.Wr.has(t)||x.Wr.add(t)};for(let e=0;e<A.in;e++){const n=t.inputs[e],r=n.prevTxId.toString("hex");D(r);const o=`${r}_o${n.outputIndex}`,i=F.cr(o);N.push(i)}for(let t=0;t<A.ref.length;t++){const e=A.ref[t];e.startsWith("native://")||D(e.slice(0,64));const n=F.cr(e);M.push(n)}if(N=await Promise.all(N),M=await Promise.all(M),T){const t=`${r(T)} not found in the transaction\n\ntxid: ${e}\njig: ${T.location}`;o(N.some((t=>t.location===T.location)),t)}const{Rs:B,va:G}=f(N,M,T);T&&(N[N.findIndex((t=>t.location===T.location))]=T);const L=new h;L.Ba=!0,L.xn=!1;const J=h.ct;p(!1);try{N.forEach((t=>L.Hn(t))),M.forEach((t=>L._read(t))),h.ct=L,a.rt&&a.Wt(S,"Replay",e);for(const t of A.exec){const{op:e,data:n}=t;o(2===Object.keys(t).length,"Invalid exec"),o("string"==typeof e,"Invalid op: "+e),o("object"==typeof n&&n,"Invalid data: "+n);k(e,n,i(i(N,M),L.ft))}}catch(t){throw L.ht(t),t}finally{h.ct=J,p(!0)}let W=null;try{return W=L.$n(),o(W,"Invalid payload: no commit generated"),W.Rs=B,await async function(t,e,r,i,c,u,h){a.rt&&a.ot(S,"Verify",r);const f=new Date,l=w(t);(function(t,e,r){const Unbound=n(11),i=(new d).Ui().Ni((t=>r[t])),s=e.cre.map((t=>i.Di(t)));o(t.ft.length===e.cre.length,"Invalid locks");for(let e=0;e<s.length;e++){const n=new Unbound(s[e]),r=t.ft[e],o=t.qr.get(r);y((()=>{r.owner=n})),o.Un.owner=n}})(t,i,l),g(t);const p=await b(t,u);u.Ne();const A=_(p),x=m(t,l),I=E(t,A,x,l),T=v(t,I);s(I)!==s(i)&&function(t,e,n,r,o){a.fn&&a.un(S,"Expected payload:",JSON.stringify(t,0,3));a.fn&&a.un(S,"Actual payload:",JSON.stringify(e,0,3));function i(t,e,n,o){if(t===e)return;const i=r.get(n);o?(a.un(S,"Expected state:",JSON.stringify(o,0,3)),a.un(S,"Actual state:",JSON.stringify(i,0,3))):a.un(S,"State mismatch:",JSON.stringify(i,0,3))}a.fn&&t.out.length===e.out.length&&t.del.length===e.del.length&&(t.out.forEach(((t,r)=>{i(t,e.out[r],n.br[r],o&&o.ks(r))})),t.del.forEach(((t,r)=>{i(t,e.del[r],n.Pn[r],o&&o.zn(r))})));throw new Error("Payload mismatch\n\nHint: See logs")}(i,I,t,p,h);for(let t=0;t<I.in;t++){const n=e.inputs[t],r=T.inputs[t],i=n.prevTxId.toString("hex"),s=r.prevTxId.toString("hex");o(i===s,"Txid mismatch on input "+t),o(n.outputIndex===r.outputIndex,"Vout mismatch on input "+t)}for(let t=1;t<=I.out.length;t++){const n=e.outputs[t],r=T.outputs[t],i=n.script.toString("hex"),s=r.script.toString("hex");o(i===s,"Script mismatch on output "+t),o(n.satoshis===r.satoshis,"Satoshis mismatch on output "+t)}t.Bi=r,P(t,r),a.rt&&a.ot(S,"Verify (end): "+(new Date-f)+"ms");c&&(await O(t,p,r),u.Ne())}(W,t,e,A,I,R,j),l(G),W}finally{a.rt&&a.ot(S,"Replay (end): "+(new Date-$)+"ms")}}A.Mr=class{constructor(t,e){this.$n=t,this.$s=e}ks(t){return this.$s.get(this.$n.br[t])}zn(t){return this.$s.get(this.$n.Pn[t])}},t.exports=A},function(t,e,n){const{Address:r,Script:o,Transaction:i}=n(8),{fe:s,h:c}=n(1),{UnimplementedError}=n(12),{ki:a}=n(21),{Cache:u}=n(33),h=n(3);class f{async Ls(t){throw new UnimplementedError}async Js(t){throw new UnimplementedError}async Ws(t,e){throw new UnimplementedError}constructor(t={}){this.network=l(t.network),this.api=p(t.api),this.apiKey=function(t){if("string"==typeof t||void 0===t)return t;throw new Error("Unsupported apiKey: "+t)}(t.apiKey),this.cache=y(t.cache),this.bsvNetwork=s(this.network),this.Hs=new Map,this.Vs=[],this.zs=1e4,this.Ks(t.lastBlockchain)}async broadcast(t){const e=new i(t),n=e.hash;if(t=e.toString("hex"),0===e.inputs.length)throw new Error("tx has no inputs");if(0===e.outputs.length)throw new Error("tx has no outputs");if(!0!==e.verify())throw new Error(e.verify());await this.Ls(t);const r=[];if(!await this.cache.get("time://"+n)){const t=this.cache.set("time://"+n,Date.now());t instanceof Promise&&t.catch((t=>{})),r.push(t)}for(const t of e.inputs){const e=`${t.prevTxId.toString("hex")}_o${t.outputIndex}`;r.push(this.cache.set("spend://"+e,n))}return r.push(this.cache.set("tx://"+n,t)),await Promise.all(r),this.Vs.filter((([t])=>Date.now()-t.time<this.zs)),e.time=Date.now(),this.Vs.push([e,n]),n}async fetch(t){const e=await this.cache.get("tx://"+t);if(e)return e;const{rawtx:n}=await this.Ys(t);return n}async utxos(t){if("string"==typeof t)try{t=o.fromAddress(t)}catch(e){t=new o(t)}else if(t instanceof r)t=o.fromAddress(t);else if(!(t instanceof o))throw new Error("Invalid script: "+c(t));const e=a(t),n=this.Hs.get(e);if(n)return new Promise(((t,e)=>n.push({resolve:t,reject:e})));this.Hs.set(e,[]);try{const n=await this.Ws(e,t.toString("hex"));if(!Array.isArray(n))throw new Error(`Received invalid utxos for ${t}\n\n: Type: ${typeof n}\n\nNetwork: ${this.network}`);const r=this.qs(n),o=await this.Zs(r,t);return this.Hs.get(e).forEach((t=>t.resolve(o))),o}catch(t){throw this.Hs.get(e).forEach((e=>e.reject(t))),t}finally{this.Hs.delete(e)}}async time(t){const e=await this.cache.get("time://"+t);if(e)return e;const{time:n}=await this.Ys(t);return n}async spends(t,e){const n=await this.cache.get(`spend://${t}_o${e}`);if(n)return n;const{spends:r}=await this.Ys(t);return r[e]}async Ys(t){const e=this.Hs.get(t);if(e)return new Promise(((t,n)=>e.push({resolve:t,reject:n})));this.Hs.set(t,[]);try{const{rawtx:e,time:n,spends:r}=await this.Js(t),o=[];if(o.push(this.cache.set("tx://"+t,e)),!await this.cache.get("time://"+t)){const e=this.cache.set("time://"+t,Date.now());e instanceof Promise&&e.catch((t=>{})),o.push(e)}r.forEach(((e,n)=>{e&&o.push(this.cache.set(`spend://${t}_o${n}`,e))}));const s=new i(e);for(const e of s.inputs){const n=`${e.prevTxId.toString("hex")}_o${e.outputIndex}`;o.push(this.cache.set("spend://"+n,t))}await Promise.all(o);const c={rawtx:e,time:n,spends:r};return this.Hs.get(t).forEach((t=>t.resolve(c))),c}catch(e){throw this.Hs.get(t).forEach((t=>t.reject(e))),e}finally{this.Hs.delete(t)}}Ks(t){t&&this.network===t.network&&(this.cache=t.cache,this.Vs=t.Vs)}qs(t){const e=new Set;return t.filter((t=>{const n=`${t.txid}_o${t.vout}`;return e.has(n)?(h.hn&&h.an("RemoteBlockchain","Duplicate utxo returned from server:",n),!1):(e.add(n),!0)}))}async Zs(t,e){this.Vs.filter((([t])=>Date.now()-t.time<this.zs)),this.Vs.forEach((([n,r])=>{n.outputs.forEach(((n,o)=>{n.script.equals(e)&&!t.some((t=>t.txid===r&&t.vout===o))&&t.push({txid:r,vout:o,script:n.script,satoshis:n.satoshis})}))})),this.Vs.forEach((([e])=>{t=t.filter((t=>!e.inputs.some((e=>((t,e)=>t.prevTxId.toString("hex")===e.txid&&t.outputIndex===e.vout)(e,t)))))}));const n=t.map((t=>t.txid+"_o"+t.vout)).map((t=>this.cache.get("spend://"+t))),r=await Promise.all(n);return t=t.filter(((t,e)=>!r[e]))}}function l(t){if(void 0===t)return"main";if("main"===t||"test"===t||"stn"===t)return t;throw new Error("Unsupported network: "+t)}function p(t){if("string"==typeof t)return t;throw new Error("Unsupported api: "+t)}function y(t){if(t instanceof u)return t;if(void 0===t)return new Map;throw new Error("Unsupported cache: "+t)}f.create=(t={})=>{const e=n(45),r=n(44),o=n(46);switch(typeof t.api){case"string":switch(t.api){case"run":return new e(t);case"bitindex":case"mattercloud":return new r(t);case"whatsonchain":return new o(t)}break;case"undefined":return"stn"===t.network?new o(t):new e(t)}throw new Error("Invalid blockchain API: "+t.api)},f.Qs=l,f.Xs=p,f.tc=y,t.exports=f},function(t,e){var n,r,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var a,u=[],h=!1,f=-1;function l(){h&&a&&(h=!1,a.length?u=a.concat(u):f=-1,u.length&&p())}function p(){if(!h){var t=c(l);h=!0;for(var e=u.length;e;){for(a=u,u=[];++f<e;)a&&a[f].run();f=-1,e=u.length}a=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function d(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new y(t,e)),1!==u.length||h||c(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=d,o.addListener=d,o.once=d,o.off=d,o.removeListener=d,o.removeAllListeners=d,o.emit=d,o.prependListener=d,o.prependOnceListener=d,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){const Code=n(0);class StandardLock{constructor(t,e){this.address=t,this.testnet=e}script(){if("string"!=typeof this.address)throw new Error("Address is not a string: "+this.address);const t=[],e=[];let n,r,o;const i=this.address;for(let s=0;s<i.length;s++){if(n=0,r="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(i[s]),r<0)throw new Error(`Invalid character in address: ${i}\n\nDetails: i=${s}, c=${i[s]}`);for(r||e.length^s||e.push(0);n in t||r;)o=t[n],o=o?58*o+r:r,r=o>>8,t[n]=o%256,n++}for(;n--;)e.push(t[n]);if(e.length<6)throw new Error("Address too short: "+i);if(0!==e[0]&&111!==e[0])throw new Error("Address may only be a P2PKH type: "+i);if(!0===this.testnet&&0===e[0]||!1===this.testnet&&111===e[0])throw new Error("Invalid network");const s=[118,169,20,...e.slice(1,e.length-4),136,172];return new Uint8Array(s)}domain(){return 108}}StandardLock.sealed=!0,StandardLock.toString();const r=new Code;Code.Yt(r).Mt(StandardLock,!0),t.exports=r},function(t,e,n){const r=n(5),{UnimplementedError}=n(12);class o{get network(){throw new UnimplementedError}async broadcast(t){throw new UnimplementedError}async fetch(t){throw new UnimplementedError}async utxos(t){throw new UnimplementedError}async time(t){throw new UnimplementedError}async spends(t,e){throw new UnimplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("string"==typeof t.network&&("function"==typeof t.broadcast&&("function"==typeof t.fetch&&("function"==typeof t.utxos&&("function"==typeof t.time&&"function"==typeof t.spends))))))}}class i{async pay(t,e){throw new UnimplementedError}async broadcast(t){throw new UnimplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&"function"==typeof t.pay)}}class s{async sign(t,e,n){throw new UnimplementedError}async nextOwner(){throw new UnimplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.sign&&("function"==typeof t.nextOwner||"function"==typeof t.owner)))}}class c{info(...t){}debug(...t){}warn(...t){}error(...t){}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&!!t}}class a{async get(t){throw new UnimplementedError}async set(t,e){throw new UnimplementedError}static[Symbol.hasInstance](t){return("object"==typeof t||"function"==typeof t)&&(!!t&&("function"==typeof t.get&&"function"==typeof t.set))}}class u{script(){throw new UnimplementedError}domain(){throw new UnimplementedError}static[Symbol.hasInstance](t){if("object"!=typeof t||!t)return!1;if("function"!=typeof t.constructor.prototype.script)return!1;if(Object.getOwnPropertyNames(t).includes("script"))return!1;const e=t.script(),n=r.K.Uint8Array;if(!(e instanceof Uint8Array||e instanceof n))return!1;return"function"==typeof t.constructor.prototype.domain&&(!Object.getOwnPropertyNames(t).includes("domain")&&(!!Number.isSafeInteger(t.domain())&&!(t.domain()<0)))}}t.exports={Blockchain:o,Purse:i,Logger:c,Cache:a,Lock:u,Owner:s}},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(51),o=n(52),i=n(53);function s(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=a.prototype:(null===t&&(t=new a(e)),t.length=e),t}function a(t,e,n){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return u(this,t,e,n)}function u(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);a.TYPED_ARRAY_SUPPORT?(t=e).__proto__=a.prototype:t=l(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!a.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|y(e,n),o=(t=c(t,r)).write(e,n);o!==r&&(t=t.slice(0,o));return t}(t,e,n):function(t,e){if(a.isBuffer(e)){var n=0|p(e.length);return 0===(t=c(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?c(t,0):l(t,e);if("Buffer"===e.type&&i(e.data))return l(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(h(e),t=c(t,e<0?0:0|p(e)),!a.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function l(t,e){var n=e.length<0?0:0|p(e.length);t=c(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function y(t,e){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(r)return G(t).length;e=(""+e).toLowerCase(),r=!0}}function d(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return I(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function w(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function g(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,o);if("number"==typeof e)return e&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,o){var i,s=1,c=t.length,a=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,c/=2,a/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){var h=-1;for(i=n;i<c;i++)if(u(t,i)===u(e,-1===h?0:i-h)){if(-1===h&&(h=i),i-h+1===a)return h*s}else-1!==h&&(i-=i-h),h=-1}else for(n+a>c&&(n=c-a),i=n;i>=0;i--){for(var f=!0,l=0;l<a;l++)if(u(t,i+l)!==u(e,l)){f=!1;break}if(f)return i}return-1}function _(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var s=0;s<r;++s){var c=parseInt(e.substr(2*s,2),16);if(isNaN(c))return s;t[n+s]=c}return s}function m(t,e,n,r){return J(G(e,t.length-n),t,n,r)}function E(t,e,n,r){return J(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function v(t,e,n,r){return E(t,e,n,r)}function P(t,e,n,r){return J(L(e),t,n,r)}function O(t,e,n,r){return J(function(t,e){for(var n,r,o,i=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,s,c,a,u=t[o],h=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=n)switch(f){case 1:u<128&&(h=u);break;case 2:128==(192&(i=t[o+1]))&&(a=(31&u)<<6|63&i)>127&&(h=a);break;case 3:i=t[o+1],s=t[o+2],128==(192&i)&&128==(192&s)&&(a=(15&u)<<12|(63&i)<<6|63&s)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:i=t[o+1],s=t[o+2],c=t[o+3],128==(192&i)&&128==(192&s)&&128==(192&c)&&(a=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&c)>65535&&a<1114112&&(h=a)}null===h?(h=65533,f=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),o+=f}return function(t){var e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=x));return n}(r)}e.Buffer=a,e.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},e.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),a.poolSize=8192,a.sa=function(t){return t.__proto__=a.prototype,t},a.from=function(t,e,n){return u(null,t,e,n)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,e,n){return function(t,e,n,r){return h(e),e<=0?c(t,e):void 0!==n?"string"==typeof r?c(t,e).fill(n,r):c(t,e).fill(n):c(t,e)}(null,t,e,n)},a.allocUnsafe=function(t){return f(null,t)},a.allocUnsafeSlow=function(t){return f(null,t)},a.isBuffer=function(t){return!(null==t||!t.ca)},a.compare=function(t,e){if(!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=a.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var s=t[n];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,o),o+=s.length}return r},a.byteLength=y,a.prototype.ca=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)w(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):d.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,e,n,r,o){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),c=Math.min(i,s),u=this.slice(r,o),h=t.slice(e,n),f=0;f<c;++f)if(u[f]!==h[f]){i=u[f],s=h[f];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return g(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return g(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return m(this,t,e,n);case"ascii":return E(this,t,e,n);case"latin1":case"binary":return v(this,t,e,n);case"base64":return P(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.aa||this,0)}};var x=4096;function I(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function R(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=B(t[i]);return o}function j(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function k(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function $(t,e,n,r,o,i){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function C(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function U(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function N(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(t,e,n,r,i){return i||N(t,0,n,4),o.write(t,e,n,r,23,4),n+4}function F(t,e,n,r,i){return i||N(t,0,n,8),o.write(t,e,n,r,52,8),n+8}a.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),a.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=a.prototype;else{var o=e-t;n=new a(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},a.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||k(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},a.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||k(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},a.prototype.readUInt8=function(t,e){return e||k(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return e||k(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return e||k(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return e||k(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return e||k(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||k(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||k(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},a.prototype.readInt8=function(t,e){return e||k(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){e||k(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){e||k(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return e||k(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return e||k(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return e||k(t,4,this.length),o.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return e||k(t,4,this.length),o.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return e||k(t,8,this.length),o.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return e||k(t,8,this.length),o.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||$(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},a.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||$(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},a.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):U(this,t,e,!0),e+4},a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);$(this,t,e,n,o-1,-o)}var i=0,s=1,c=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===c&&0!==this[e+i-1]&&(c=1),this[e+i]=(t/s>>0)-c&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);$(this,t,e,n,o-1,-o)}var i=n-1,s=1,c=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===c&&0!==this[e+i+1]&&(c=1),this[e+i]=(t/s>>0)-c&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):C(this,t,e,!0),e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):C(this,t,e,!1),e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):U(this,t,e,!0),e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||$(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):U(this,t,e,!1),e+4},a.prototype.writeFloatLE=function(t,e,n){return M(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return M(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!a.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},a.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=a.isBuffer(t)?t:G(new a(t,r).toString()),c=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%c]}return this};var D=/[^+\/0-9A-Za-z-_]/g;function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function G(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function L(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(D,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function J(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}}).call(this,n(31))},function(t,e,n){const Code=n(0);function hex(t){if("string"!=typeof t||t.length%2!=0)throw new Error("Bad hex: "+t);t=t.toLowerCase();const e="0123456789abcdef".split(""),n=[];for(let r=0;r<t.length;r+=2){const o=e.indexOf(t[r]),i=e.indexOf(t[r+1]);if(-1===o||-1===i)throw new Error("Bad hex: "+t);n.push(16*o+i)}return n}hex.toString(),t.exports=Code.kt(hex)},function(t,e,n){const r=n(8),{R:o,fe:i}=n(1),Code=n(0),s=n(3),c=["load","sync","publish","update"];class a{constructor(){this.oc=null,this.ic=null,this.H=null,this.sc=null,this.ro=null,this.cc=[],this.$e=1e4,this.Wr=new Set,this.Fr=!0,this._r=!1,this.Ha=!1}Ot(){const t=this.oc;return{get network(){return t.network},async broadcast(e){if(s.Jt){const t=new r.Transaction(e).hash;s.Wt("Blockchain","Broadcast",t)}const n=new Date,o=await t.broadcast(e);return s.rt&&s.ot("Blockchain","Broadcast (end): "+(new Date-n)+"ms"),o},async fetch(e){s.Jt&&s.Wt("Blockchain","Fetch",e);const n=new Date,r=await t.fetch(e);return s.rt&&s.ot("Blockchain","Fetch (end): "+(new Date-n)+"ms"),r},async utxos(e){s.Jt&&s.Wt("Blockchain","Utxos",e);const n=new Date,r=await t.utxos(e);return s.rt&&s.ot("Blockchain","Utxos (end): "+(new Date-n)+"ms"),r},async spends(e,n){s.Jt&&s.Wt("Blockchain",`Spends ${e}_o${n}`);const r=new Date,o=await t.spends(e,n);return s.rt&&s.ot("Blockchain","Spends (end): "+(new Date-r)+"ms"),o},async time(e){s.Jt&&s.Wt("Blockchain","Time",e);const n=new Date,r=await t.time(e);return s.rt&&s.ot("Blockchain","Time (end): "+(new Date-n)+"ms"),r}}}oo(){const t=this.ic;return{async get(e){s.Jt&&s.Wt("Cache","Get",e);const n=new Date,r=await t.get(e);return s.rt&&s.ot("Cache","Get (end): "+(new Date-n)+"ms"),s.rt&&s.ot("Cache","Value",JSON.stringify(r,0,3)),r},async set(e,n){s.Jt&&s.Wt("Cache","Set",e),s.rt&&s.ot("Cache","Value",JSON.stringify(n,0,3));const r=new Date,o=await t.set(e,n);return s.rt&&s.ot("Cache","Set (end): "+(new Date-r)+"ms"),o}}}Zr(){const t=this.H;return{async nextOwner(){s.Jt&&s.Wt("Owner","Next owner");const e=new Date;let n=null;return"function"==typeof t.owner?(s.an("Kernel","Owner.prototype.owner() is deprecated. Please rename owner() to nextOwner()."),n=await t.owner()):n=await t.nextOwner(),s.rt&&s.ot("Owner","Next owner (end): "+(new Date-e)+"ms"),n},async sign(e,n,r){s.Jt&&s.Wt("Owner","Sign");const o=new Date,i=await t.sign(e,n,r);return s.rt&&s.ot("Owner","Sign (end): "+(new Date-o)+"ms"),i}}}Jr(){const t=this.sc;return{async pay(e,n){s.Jt&&s.Wt("Purse","Pay");const r=new Date,o=await t.pay(e,n);return s.rt&&s.ot("Purse","Pay (end): "+(new Date-r)+"ms"),o},async broadcast(e){if("function"==typeof t.broadcast){s.Jt&&s.Wt("Purse","Broadcast");const n=new Date,r=await t.broadcast(e);return s.rt&&s.ot("Purse","Broadcast (end): "+(new Date-n)+"ms"),r}}}}ne(){a.ce!==this&&(a.ce&&a.ce.te(),a.ce=this,r.Networks.defaultNetwork=r.Networks[i(this.Ot().network)],Code.ne())}te(){a.ce&&(Code.te(),a.ce=null)}Bn(t,e){o(c.includes(t)),"publish"===t&&e instanceof Code&&Code.Yt(e).Tt(),this.cc.filter((e=>e.ac===t)).forEach((n=>n.uc(t,e)))}}a.ce=null,a.hc=c,t.exports=a},function(t,e){t.exports=function(t){const e=JSON.stringify;return function(n,r,o){"number"==typeof o&&(o=Array(o+1).join(" ")),"string"!=typeof o&&(o="");const i=new Set;return function n(s,c,a,u){const h=o?"\n"+new Array(u+1).join(o):"",f=o?": ":":";if(a&&"function"==typeof a.toJSON&&(a=a.toJSON()),void 0===(a=r?r.call(s,c,a):a))return;if("object"!=typeof a||null===a)return e(a);if(i.has(a))throw new TypeError("Converting circular structure to JSON");let l;if(i.add(a),Array.isArray(a)){const t=[];for(let r=0;r<a.length;r++){const i=n(a,r,a[r],u+1)||e(null);t.push(h+o+i)}l="["+t.join(",")+(t.length?h:"")+"]"}else{let r=Object.keys(a);t&&(r=r.sort(t));const i=[];for(let t=0;t<r.length;t++){const s=r[t],c=n(a,s,a[s],u+1);if(!c)continue;const l=e(s)+f+c;i.push(h+o+l)}l="{"+i.join(",")+(i.length?h:"")+"}"}return i.delete(a),l}({"":n},"",n,0)}}},function(t,e,n){const r=n(49),{makeDeterministic:o,nonDeterministicIntrinsics:i}=n(50),s=n(37),{G:c}=n(4);t.exports=class{constructor(){const t=`var n=${s.toString()};var m=${o.toString()};m(n);`,e=`(()=>{\n      ${r};\n      ${t};\n      SES.lockdown();\n      var C = this.Compartment;\n      delete this.SES;\n      delete this.Compartment;\n      return C\n    })()`;{document.body||(document.body=document.createElement("body"));const t=document.createElement("iframe");t.style||(t.style={}),t.style.display="none",document.body.appendChild(t),this.iframeEval=t.contentWindow.eval,this.Compartment=this.iframeEval(e)}this.globalOverrides={},i.forEach((t=>{this.globalOverrides[t]=void 0}));const n=this.fc();n.global.c=console,n.global.s=c,this.globalOverrides.console=n.evaluate("\n      const o = { }\n      Object.keys(c).forEach(name => {\n        o[name] = (...args) => s(() => c[name](...args))\n      })\n      o\n    ")}makeCompartment(){const t=this.fc();Object.assign(t.global,this.globalOverrides);return{evaluate:e=>(this.lc(e),t.evaluate(e)),global:new Proxy({},{set:(e,n,r)=>(e[n]=t.global[n]=r,!0),deleteProperty:(e,n)=>(delete e[n],n in this.globalOverrides?t.global[n]=this.globalOverrides[n]:delete t.global[n],!0),defineProperty:(e,n,r)=>(Object.defineProperty(e,n,r),Object.defineProperty(t.global,n,r),!0)})}}fc(){return new this.Compartment}lc(t){if(/for\s*\([^)]+\s+in\s+\S+\)/g.test(t))throw new Error("for-in loops are not supported")}}},function(t,e){t.exports=class{constructor(){this.tasks=[]}async Br(t){return new Promise(((e,n)=>{this.tasks.push({func:t,reject:n,resolve:e}),1===this.tasks.length&&this.dc()}))}async dc(){const t=this.tasks[0];try{const e=t.func();t.resolve(e instanceof Promise?await e:e)}catch(e){t.reject(e)}finally{this.tasks.shift(),this.tasks.length&&this.dc()}}}},function(t,e,n){const{Transaction:r}=n(8),{R:o,g:i,h:s,P:c,Re:a}=n(1),u=n(3),{B:h,qn:f}=n(13),{G:l}=n(4),{J:p}=n(10),y="Sync";async function d(t,e){if(!1===e.forward)return;const{Pr:a}=n(14),h=i();let f=l((()=>t.location)),d=p(f);for(;e.$e.Ne(),void 0===d.vdel;){c(!d.recordid,`Cannot sync ${s(t)}: transaction in progress`),o(d.txid&&void 0!==d.vout);const i=await h.Ot().spends(d.txid,d.vout);if(!i)break;e.$e.Ne(),u.Jt&&u.Wt(y,"Forward syncing to",i);const w=await h.Ot().fetch(i);e.$e.Ne();const g=new r(w);let b=null;try{b=a(g)}catch(t){u.fn&&u.un(y,t);break}const _=n(28),m=!0,E=t,v=!1;await _(g,i,b,h,m,E,e.$e,v),e.$e.Ne(),f=l((()=>t.location)),d=p(f)}h.Bn("sync",t)}t.exports=async function(t,e={}){const Jig=n(2),Code=n(0),r=n(24);c(!r.it,"sync disabled in atomic update"),o(t instanceof Jig||t instanceof Code),e.$e=e.$e||new a("sync"),e.yc=e.yc||new Map,u.Jt&&u.Wt(y,"Sync",s(t));const w=new Date;if(e.yc.has(t))return;t instanceof Code&&l((()=>p(t.location))).undeployed&&Code.Yt(t).Lt();let g=!1,b=null;const _=async function(){try{g=await async function(t,e){const r=n(25);let a=!1;for(;;){const n=l((()=>t.location)),{error:i,commitid:h}=p(n);if(c(!i,"Cannot sync\n\n"+i),!h)break;u.rt&&u.ot(y,"Waiting to publish "+s(t)),a=!0;const f=r.ja(h);o(f),u.rt&&u.ot(y,"Sync",f.wn),await f.Na(),e.$e.Ne()}return i().Bn("sync",t),a}(t,e)}catch(t){b=t}e.$e.Ne();try{g||await d(t,e)}catch(t){b=b||t}return e.$e.Ne(),t}();e.yc.set(t,_),e.yc.set(l((()=>t.origin)),_),await _;try{await async function(t,e,r){if(!1===e.inner)return;if(void 0===e.inner&&r)return;u.rt&&u.ot(y,"Inner sync");const Jig=n(2),Code=n(0),o=new Set;h(t,(e=>e===t||(e instanceof Jig||e instanceof Code?(o.add(e),!1):void 0)));const i=[],s=new Map;for(const t of o){const n=e.yc.get(t)||e.yc.get(l((()=>t.origin)));!1!==e.forward&&n?s.set(t,n):i.push(t.sync(e))}await Promise.all(i);for(const t of s.keys())s.set(t,await s.get(t));e.$e.Ne(),!1!==e.forward&&l((()=>f(t,(t=>s.get(t)))))}(t,e,g)}catch(t){if(!b)throw t}if(e.$e.Ne(),b)throw b;u.rt&&u.ot(y,"Sync (end): "+(new Date-w)+"ms")}},function(t,e,n){const r=n(5),{_:o,h:i}=n(1),{ln:s}=n(4),c=r.K,a=new WeakMap;function u(t){const e=a.get(t);return o(e,"Not a dynamic type: "+i(t)),e}function h(){const t=a.get(this),e=t?t.Vt:this;return c.Function.prototype.toString.apply(e)}class f{constructor(){const t=r.yn("function dynamic() {}")[0];Object.getOwnPropertyNames(t.prototype).forEach((e=>{delete t.prototype[e]}));const e={},n=new p,o=new Proxy(e,n),i=Object.getPrototypeOf(t.prototype);Object.setPrototypeOf(e,i),Object.setPrototypeOf(t.prototype,o),Object.freeze(t.prototype);const s=new l;n.q(o,s);const c=new Proxy(t,s);return s.q(t,e,c),a.set(c,s),c}static At(t){return u(t).Vt}static Rt(t,e){u(t).Rt(e)}static wc(t){return u(t).gc}static Y(t,e){u(t).Y(e)}}class l{q(t,e,n){this._c=t,this.Vt=t,this.gc=n,this.Eo=n,this.bc=e}apply(t,e,n){return Reflect.apply(this.Vt,e,n)}construct(t,e,n){let r=n;try{r=f.wc(n)}catch(t){}return Reflect.construct(this.Vt,e,r)}defineProperty(t,e,n){if("prototype"===e)throw new Error("Cannot define prototype");if("toString"===e)throw new Error("Cannot define toString");if(!n.configurable)throw new Error("Cannot define nonconfigurable property");return Reflect.defineProperty(this.Vt,e,n),!0}deleteProperty(t,e){if("prototype"===e)throw new Error("Cannot delete prototype");if("toString"===e)throw new Error("Cannot delete toString");return Reflect.deleteProperty(this.Vt,e),!0}get(t,e,n){return"prototype"===e?this._c.prototype:"toString"===e?h:Reflect.get(this.Vt,e,n)}getPrototypeOf(t){return Reflect.getPrototypeOf(this.Vt)}getOwnPropertyDescriptor(t,e){if("prototype"===e)return Object.getOwnPropertyDescriptor(this._c,e);const n=Reflect.getOwnPropertyDescriptor(this.Vt,e);if(!n)return n;const r=Reflect.getOwnPropertyDescriptor(t,e);return r&&!r.configurable||(n.configurable=!0),n}has(t,e){return Reflect.has(this.Vt,e)}isExtensible(t){return Reflect.isExtensible(this._c)}ownKeys(t){return Reflect.ownKeys(this.Vt)}preventExtensions(t){return Object.preventExtensions(this._c),Object.preventExtensions(this.Vt),!0}set(t,e,n,r){if("prototype"===e)throw new Error("Cannot set prototype");if("toString"===e)throw new Error("Cannot set toString");return Reflect.set(this.Vt,e,n),!0}setPrototypeOf(t,e){return Reflect.setPrototypeOf(this.Vt,e),!0}Rt(t){o("function"==typeof t,"Inner type must be a function type: "+i(t));let e=t;for(;e&&e!==Function.prototype&&e!==c.Function.prototype;){const n="toString is a reserved property: "+t;o(!Object.getOwnPropertyNames(e).includes("toString"),n),e=Reflect.getPrototypeOf(e)}Reflect.isExtensible(this._c)&&Reflect.isExtensible(t)||(Reflect.preventExtensions(this._c),Reflect.preventExtensions(t));const n=this.Vt.toString().startsWith("class"),r=t.toString().startsWith("class"),s="Classes can only be changed to classes and functions to functions: "+i(t),a=this.Vt===this._c||t===this._c;o(a||n===r,s);Object.getOwnPropertyNames(this.bc).forEach((t=>{delete this.bc[t]}));const u=Reflect.getPrototypeOf(t.prototype);Reflect.setPrototypeOf(this.bc,u);Object.getOwnPropertyNames(t.prototype).forEach((e=>{const n=Reflect.getOwnPropertyDescriptor(t.prototype,e);Reflect.defineProperty(this.bc,e,n)})),this.bc.constructor=this.gc,this.Vt=t}Y(t){this.gc!==this.Eo&&a.delete(this.gc),a.set(t,this),this.gc=t,this.bc.constructor=t}}class p{q(t,e){this.Eo=t,this.mc=e}defineProperty(t,e,n){throw new Error("defineProperty disabled")}deleteProperty(t,e){throw new Error("deleteProperty disabled")}preventExtensions(){throw new Error("preventExtensions disabled")}set(t,e,n,r){if(r===this.Eo)throw new Error("Cannot set property");const o=Reflect.getPrototypeOf(r);try{return Reflect.setPrototypeOf(r,Reflect.getPrototypeOf(Object)),r[e]=n,!0}catch(t){throw new Error("Cannot set property")}finally{Reflect.setPrototypeOf(r,o)}}setPrototypeOf(t,e){if(!s())throw new Error("setPrototypeOf disabled");return Reflect.setPrototypeOf(t,e),Reflect.setPrototypeOf(this.mc.Vt.prototype,e),!0}}t.exports=f},function(t,e,n){const Code=n(0),asm=n(43),hex=n(35);class Group{constructor(t,e){this.pubkeys=t,this.required=void 0===e?this.pubkeys.length:e}script(){if(!Array.isArray(this.pubkeys))throw new Error("pubkeys not an array");if(this.pubkeys.length<1)throw new Error("pubkeys must have at least one entry");if(this.pubkeys.length>16)throw new Error("No more than 16 pubkeys allowed");const t=new Set;for(const e of this.pubkeys)t.add(e);if(t.size!==this.pubkeys.length)throw new Error("pubkeys contains duplicates");this.pubkeys.forEach((t=>hex(t)));if("number"!=typeof this.required||!Number.isInteger(this.required)||this.required<1)throw new Error("required must be a non-negative integer");if(this.required>this.pubkeys.length)throw new Error("required must be <= the number of pubkeys");return asm(`OP_${this.required} ${this.pubkeys.join(" ")} OP_${this.pubkeys.length} OP_CHECKMULTISIG`)}domain(){return 1+74*this.required}add(t){this.pubkeys.includes(t)||this.pubkeys.push(t)}}Group.deps={asm,hex},Group.toString(),t.exports=Code.kt(Group)},function(t,e,n){const Code=n(0),hex=n(35);function asm(t){const e=t.split(" ");let n=[];for(const t of e){if(void 0!==asm.OP_CODES[t]){n.push(asm.OP_CODES[t]);continue}const e=hex(1===t.length?"0"+t:t);if(0===e[0]){n.push(e[0]);continue}if(1===e.length&&e[0]>=1&&e[0]<=16){n.push(e[0]+80);continue}if(e.length<=75){n=n.concat(e.length).concat(e);continue}if(e.length<256){n=n.concat(asm.OP_CODES.OP_PUSHDATA1).concat([e.length]).concat(e);continue}if(e.length<65536){const t=[e.length/256,e.length%256];n=n.concat(asm.OP_CODES.OP_PUSHDATA2).concat(t).concat(e);continue}const r=[e.length/256/256/256,e.length/256/256%256,e.length/256%256,e.length%256];n=n.concat(asm.OP_CODES.OP_PUSHDATA4).concat(r).concat(e)}return new Uint8Array(n)}asm.OP_CODES={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_IF:99,OP_NOTIF:100,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SPLIT:127,OP_NUM2BIN:128,OP_BIN2NUM:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_1ADD:139,OP_1SUB:140,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},asm.deps={hex},asm.toString(),t.exports=Code.kt(asm)},function(t,e,n){const r=n(29),o=n(8),i=n(20),{RequestError}=n(12),{Qs:s}=r;t.exports=class extends r{constructor(t){if(t.network=s(t.network),"main"!==t.network)throw new Error("MatterCloud API only supports mainnet");t.api="mattercloud",super(t)}async Ls(t){const e="https://merchantapi.mattercloud.net/mapi/tx"+this.Pc,n=await i.Ti(e,{rawtx:t}),r=JSON.parse(n.payload);if("failure"===r.returnResult)throw new Error(r.resultDescription)}async Js(t){let e=null;const n=`https://api.mattercloud.net/api/v3/${this.network}/tx/${t}${this.Pc}`;try{const t=await i.Kn(n);e={rawtx:t.rawtx,time:t.time,spends:[]}}catch(t){throw t instanceof RequestError&&404===t.status?new Error("No such mempool or blockchain transaction"):t}const r=new o.Transaction(e.rawtx);let s="";for(let e=0;e<r.outputs.length;e++)s+=`${t}_o${e}`,e!==r.outputs.length-1&&(s+=",");const c=`https://txdb.mattercloud.io/api/v1/spends/${s}${this.Pc}`,a=await i.Kn(c);return e.spends=Object.keys(a.result).map((t=>a.result[t]?a.result[t].spend_txid:null)),e}async Ws(t,e){const n=`https://api.mattercloud.net/api/v3/${this.network}/scripthash/${t}/utxo${this.Pc}`;return(await i.Kn(n)).map((t=>Object.assign({},t,{script:e})))}get Pc(){return this.apiKey?"?api_key="+this.apiKey:""}}},function(t,e,n){const r=n(29),o=n(20),{Qs:i}=r;t.exports=class extends r{constructor(t){if(t.network=i(t.network),"main"!==t.network&&"test"!==t.network)throw new Error("Run Blockchain Server only supports mainnet and testnet");t.api="run",super(t)}async Ls(t){const e=`https://api.run.network/v1/${this.network}/tx`;await o.Ti(e,{rawtx:t})}async Js(t){const e=`https://api.run.network/v1/${this.network}/tx/${t}`,n=await o.Kn(e);return{rawtx:n.hex,time:n.time,spends:n.vout.map((t=>t.spentTxId))}}async Ws(t,e){const n=`https://api.run.network/v1/${this.network}/utxos/${t}`;return await o.Kn(n)}}},function(t,e,n){const r=n(29),o=n(3),i=n(20),{RequestError,UnimplementedError}=n(12),{Qs:s}=r,c="WhatsOnChain";t.exports=class extends r{constructor(t){if(t.network=s(t.network),"main"!==t.network&&"test"!==t.network&&"stn"!==t.network)throw new Error("WhatsOnChain API only supports mainnet, testnet, and STN");t.api="whatsonchain",super(t)}async spends(t,e){throw o.rt&&o.ot(c,"Spends",t,e),new UnimplementedError("WhatsOnChain API does not support spends")}async Ls(t){const e=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/raw`;await i.Ti(e,{txhex:t},this.Ec)}async Js(t){const e=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/hash/${t}`,n=`https://api.whatsonchain.com/v1/bsv/${this.network}/tx/${t}/hex`;try{const[t,r]=await Promise.all([i.Kn(e,void 0,this.Ec),i.Kn(n,void 0,this.Ec)]),{time:o}=t;return{rawtx:r,time:o,spends:[]}}catch(t){throw t instanceof RequestError&&404===t.status?new Error("No such mempool or blockchain transaction"):t}}async Ws(t,e){if("stn"===this.network)return o.hn&&o.an(c,"Utxos are not available on STN"),[];const n=`https://api.whatsonchain.com/v1/bsv/${this.network}/script/${t}/unspent`;return(await i.Kn(n,void 0,this.Ec)).map((t=>({txid:t.tx_hash,vout:t.tx_pos,satoshis:t.value,script:e})))}get Ec(){return this.apiKey?{"woc-api-key":this.apiKey}:{}}}},function(t,e,n){(function(e,r){const o=n(8),i=n(48),{Ri:s}=n(21),{Se:c}=n(1);!function(){if(e&&e.version){if(Number(e.version.match(/^v(\d+\.\d+)/)[1])<10)throw new Error("Run is supported only on Node v10 and above")}if("undefined"!=typeof window){const e=window.navigator.userAgent;if(-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident"))throw new Error("Run is not supported on Internet Explorer. Please upgrade to Edge.");if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);if([parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)][0]<13)throw new Error("Run is not supported on this iOS version. Please upgrade to iOS 13 or above.")}}}(),r.Jig=i.Jig,r.Berry=i.Berry,c(r,"Token",(()=>i.Token)),s(o),t.exports=i}).call(this,n(30),n(31))},function(t,e,n){const r=n(8),{PrivateKey:o,PublicKey:i,Address:s}=r,c=n(36),{Blockchain:a,Logger:u,Purse:h,Cache:f,Lock:l,Owner:p}=n(33),Jig=n(2),Berry=n(7),Code=n(0),y=n(25),d=n(14),w=n(9),g=n(24),{ua:b}=n(26),StandardLock=n(32),_=n(5),m=n(3),{h:E,P:v,Se:P,_:O,Te:S}=n(1),A=n(20),x=n(55),I=n(56),T=n(57),R=n(58),j=n(44),k=n(59),$=n(60),C=n(29),U=n(45),N=n(61),M=n(46),F="Run";class D{constructor(t={}){m.Jt&&m.Wt(F,"Create"),t=Object.assign({},D.defaults,t),this.logger=t.logger,this.networkRetries=t.networkRetries,this.networkTimeout=t.networkTimeout,this.g=new c,this.g.ic=V(t.cache),this.g._r=tt(t.client),this.g.oc=J(t,this.g.oo()),this.g.sc=W(t.purse,this.g.Ot(),t.wallet),this.g.ro=H(t.app),this.g.H=q(t.owner,this.g.Ot(),t.wallet),this.g.$e=Y(t.timeout),this.g.Wr=function(t){const e=c.ce&&c.ce.Wr;if(void 0===t)return e||[];"string"==typeof t&&(t=[t]);if(!Array.isArray(t)||t.some((t=>!nt(t))))throw new Error("Not trustable: "+E(t));return new Set(t)}(t.trust),this.g.Fr=Z(t.preverify),this.g.Ha=Q(t.rollbacks),this.Oc=X(t.autofund),this.vc=et(t.inventory),L(this),this.activate()}get app(){return this.g.ro}get autofund(){return this.Oc}get blockchain(){return this.g.oc}get cache(){return this.g.ic}get client(){return this.g._r}get inventory(){return this.vc}get logger(){return this.sn}get networkRetries(){return this.Sc}get networkTimeout(){return this.Ac}get owner(){return this.g.H}get preverify(){return this.g.Fr}get purse(){return this.g.sc}get rollbacks(){return this.g.Ha}get timeout(){return this.g.$e}get wallet(){return this.g.sc===this.g.H?this.g.sc:void 0}set app(t){this.g.ro=H(t)}set autofund(t){this.Oc=X(t)}set blockchain(t){this.g.oc=J({blockchain:t}),this.g.sc instanceof R&&(this.g.sc.blockchain=this.g.oc),L(this)}set cache(t){this.g.ic=null,this.g.ic=V(t)}set client(t){this.g._r=tt(t)}set inventory(t){this.vc&&this.vc.deactivate(),this.vc=et(t),this.vc&&this.vc.activate(this)}set logger(t){this.sn=function(t){if(t instanceof u)return t;if(void 0===t)return m.cn;if(null===t)return{};throw new Error("Invalid logger: "+E(t))}(t),B(this)&&(m.sn=this.sn)}set networkRetries(t){this.Sc=A.Ii=z(t),B(this)&&(A.Ii=z(t))}set networkTimeout(t){this.Ac=K(t),B(this)&&(A.$e=K(t))}set owner(t){this.g.H=q(t,this.g.Ot()),this.vc&&this.vc.deactivate(),this.vc=new x,this.vc.activate(this)}set rollbacks(t){this.g.Ha=Q(t)}set preverify(t){this.g.Fr=Z(t)}set purse(t){this.g.sc=W(t,this.blockchain)}set timeout(t){this.g.$e=Y(t)}set wallet(t){this.purse=t,this.owner=t}load(t,e={}){G(this),v(!g.it,"load disabled during atomic update"),e.trust&&this.trust(t.slice(0,64));return new d(this.g).cr(t,e.berry)}sync(){return v(!g.it,"sync all disabled during atomic update"),y.Gs()}deploy(t){G(this);const e=D.install(t);return Code.Yt(e).Lt(),e}transaction(t){G(this);const e=new g,n=e.update(t);return e.publish(),n}import(t,e={}){v(!g.it,"import disabled during atomic update");const n=new r.Transaction(t),o=n.hash;return e.trust&&this.trust(o),g.Is(n,o)}trust(t){m.Jt&&m.Wt(F,"Trust",t),O(nt(t),"Not trustable: "+E(t)),this.g.Wr.add(t)}on(t,e){O(c.hc.includes(t),"Invalid event: "+t),O("function"==typeof e,"Invalid listener: "+E(S)),this.g.cc.some((n=>n.ac===t&&n.uc===e))||this.g.cc.push({ac:t,uc:e})}off(t,e){O(c.hc.includes(t),"Invalid event: "+t),O("function"==typeof e,"Invalid listener: "+E(e));this.g.cc=this.g.cc.filter((n=>!(n=>n.ac===t&&n.uc===e)(n)))}activate(){return m.Jt&&m.Wt(F,"Activate"),v(!g.it,"activate disabled during atomic update"),D.instance=this,this.vc&&this.vc.activate(this),this.g.ne(),this.logger=this.sn,this.networkRetries=this.Sc,this.networkTimeout=this.Ac,this}deactivate(){return m.Jt&&m.Wt(F,"Deactivate"),v(!g.it,"deactivate disabled during atomic update"),D.instance=null,this.vc&&this.vc.deactivate(),this.g.te(),this}payload(t){const{Pr:e}=n(14);return e(new r.Transaction(t))}unify(...t){O(t.length,"No jigs to unify"),O(!t.some((t=>!(t instanceof w))),"Must only unify jigs"),b(t,t)}static install(t){const e=Code.Qt(t)||new Code,n=Code.Yt(e);return D.instance?n.bt||n.X(t):n.kt(t),e}static uninstall(t){const e=Code.Qt(t);if(!e)return;Code.Yt(e).$t()}}function B(t){return c.ce===t.g}function G(t){if(c.ce!==t.g){throw new Error("This Run instance is not active\n\n"+"Hint: Call run.activate() on this instance first")}}function L(t){t.blockchain instanceof k&&t.purse instanceof R&&t.autofund&&t.blockchain.fund(t.purse.bsvAddress,1e8)}function J(t,e){const{api:n,apiKey:r,blockchain:o,network:i}=t;if(o instanceof a)return o;const s=c.ce&&c.ce.oc;if(void 0===o)switch(i){case"mock":return s instanceof k?s:new k;case"main":case"test":case"stn":return s instanceof C&&s.api===n&&s.apiKey===r&&s.network===i?s:C.create({api:n,apiKey:r,network:i,cache:e,lastBlockchain:s});default:if(D.defaults.blockchain instanceof a)return D.defaults.blockchain;throw new Error("Unsupported network: "+i)}throw new Error("Invalid blockchain: "+E(o))}function W(t,e,n){if(n){if(!(n instanceof h))throw new Error("wallet does not implement the Purse API");return n}if(t instanceof h)return t;switch(typeof t){case"string":return new R({privkey:t,blockchain:e});case"undefined":return new R({blockchain:e});case"object":if(t instanceof o)return new R({privkey:t,blockchain:e})}throw new Error("Invalid purse: "+E(t))}function H(t){switch(typeof t){case"string":return t;case"undefined":return D.defaults.app;default:throw new Error("Invalid app: "+E(t))}}function V(t){if(t instanceof f)return t;if(void 0===t)return D.instance&&D.instance.cache?D.instance.cache:new I;throw new Error("Invalid cache: "+E(t))}function z(t){switch(typeof t){case"number":if(Number.isNaN(t)||t<0)throw new Error("Invalid network retries: "+t);return t;case"undefined":return 2;default:throw new Error("Invalid timeout: "+t)}}function K(t){switch(typeof t){case"number":if(Number.isNaN(t)||t<0)throw new Error("Invalid network timeout: "+t);return t;case"undefined":return 1e4;default:throw new Error("Invalid network timeout: "+t)}}function Y(t){switch(typeof t){case"number":if(Number.isNaN(t)||t<0)throw new Error("Invalid timeout: "+t);return t;case"undefined":return 3e4;default:throw new Error("Invalid timeout: "+t)}}function q(t,e,n){if(n){if(!(n instanceof p))throw new Error("wallet does not implement the Owner API");return n}if(t instanceof p)return t;if(void 0===t||"string"==typeof t||t instanceof o)try{return new T(t,e.network)}catch(t){}if("string"==typeof t||t instanceof i||t instanceof s)try{return new N(t.toString())}catch(t){}if("object"==typeof t)try{return new N(t)}catch(t){}throw new Error("Invalid owner: "+E(t))}function Z(t){switch(typeof t){case"boolean":return t;case"undefined":return D.defaults.preverify;default:throw new Error("Invalid preverify: "+t)}}function Q(t){switch(typeof t){case"boolean":return t;case"undefined":return D.defaults.rollbacks;default:throw new Error("Invalid rollbacks: "+t)}}function X(t){switch(typeof t){case"boolean":return t;case"undefined":return D.defaults.autofund;default:throw new Error("Invalid autofund: "+t)}}function tt(t){switch(typeof t){case"boolean":return t;case"undefined":return D.defaults.client;default:throw new Error("Invalid client: "+t)}}function et(t){switch(typeof t){case"boolean":return null;case"object":return t;case"undefined":return new x;default:throw new Error("Invalid inventory: "+t)}}function nt(t){return"*"===t||"string"==typeof t&&(64===t.length&&/[a-fA-F0-9]+/.test(t))}D.instance=null,D.defaults={},D.defaults.api=void 0,D.defaults.apiKey=void 0,D.defaults.app="",D.defaults.autofund=!0,D.defaults.blockchain=void 0,D.defaults.client=!1,D.defaults.inventory=void 0,D.defaults.logger=void 0,D.defaults.network="main",D.defaults.networkRetries=2,D.defaults.networkTimeout=1e4,D.defaults.owner=void 0,D.defaults.preverify=!0,D.defaults.purse=void 0,D.defaults.rollbacks=!0,D.defaults.timeout=3e4,D.defaults.trust=[],D.configure=(t,e)=>{if(t.APP&&(D.defaults.app=t.APP),e=e||t.NETWORK||D.defaults.network,D.defaults.network=e,"debug"===t.LOGGER)D.defaults.logger=console;else if(t.LOGGER&&JSON.parse(t.LOGGER)){const t={info:console.info,warn:console.warn,error:console.error};D.defaults.logger=t}else t.LOGGER&&!JSON.parse(t.LOGGER)&&(D.defaults.logger={});m.sn=D.defaults.logger;const n=t.PURSE||t["PURSE_"+e.toUpperCase()];void 0!==n&&(D.defaults.purse=n);const r=t.OWNER||t["OWNER_"+e.toUpperCase()];void 0!==r&&(D.defaults.owner=r),void 0!==t.API&&(D.defaults.api=t.API);const o=t.APIKEY||t["APIKEY_"+(D.defaults.api||"").toUpperCase()];void 0!==o&&(D.defaults.apiKey=o)},D.cover=t=>{_.ee.includes(t)||_.ee.push(t)},D.Berry=Berry,D.Code=Code,D.Jig=Jig,D.StandardLock=StandardLock,D.Transaction=g,D.Inventory=x,D.LocalOwner=T,D.LocalPurse=R,D.MatterCloud=j,D.Mockchain=k,D.PayServer=$,D.RemoteBlockchain=C,D.RunConnect=U,D.LocalCache=I,D.Viewer=N,D.WhatsOnChain=M,P(D,"asm",(()=>n(43))),P(D,"expect",(()=>n(62))),P(D,"Group",(()=>n(42))),P(D,"hex",(()=>n(35))),P(D,"Token",(()=>n(63))),D.ln=n(4).ln,D.wi=n(10),D.xc=n(21),D.Ic=n(23),D.Fa=n(9),D.Le=n(13),D.jc=n(38),D.Tc=n(41),D.Je=n(3),D.We=n(17),D.He=n(1),D.Pr=n(14).Pr,D.Cc=n(22),D.ze=n(6),D.C=n(1).C,D.N=n(1).N,D.U=n(1).U,D.Rc=n(20),D.Ke=n(18),D.Ye=_,D.$c=n(39),D.kc=n(27),D.G=n(4).G,D.Nc=n(11),D.api={},D.api.Blockchain=a,D.api.Logger=u,D.api.Purse=h,D.api.Cache=f,D.api.Lock=l,D.api.Owner=p,D.errors=n(12),D.version="0.6.0",D.protocol=n(16).mr,t.exports=D},function(t){t.exports=JSON.parse('"!function(t,o){\\"object\\"==typeof exports&&\\"undefined\\"!=typeof module?o(exports):\\"function\\"==typeof define&&define.amd?define([\\"exports\\"],o):o((t=t||self).SES={})}(this,(function(t){\\"use strict\\";function o(t,o){if(!t)throw new TypeError(o)}const{getPrototypeOf:r}=Object;const{getOwnPropertyDescriptor:e,getPrototypeOf:n}=Object;function a(t){return n(t).constructor}const i=[\\"Array\\",\\"ArrayBuffer\\",\\"ArrayBufferPrototype\\",\\"ArrayIteratorPrototype\\",\\"ArrayPrototype\\",\\"AsyncFunction\\",\\"AsyncFunctionPrototype\\",\\"AsyncGenerator\\",\\"AsyncGeneratorFunction\\",\\"AsyncGeneratorPrototype\\",\\"AsyncIteratorPrototype\\",\\"Atomics\\",\\"BigInt\\",\\"BigIntPrototype\\",\\"BigInt64Array\\",\\"BigInt64ArrayPrototype\\",\\"BigUint64Array\\",\\"BigUint64ArrayPrototype\\",\\"Boolean\\",\\"BooleanPrototype\\",\\"DataView\\",\\"DataViewPrototype\\",\\"Date\\",\\"DatePrototype\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Error\\",\\"ErrorPrototype\\",\\"eval\\",\\"EvalError\\",\\"EvalErrorPrototype\\",\\"Float32Array\\",\\"Float32ArrayPrototype\\",\\"Float64Array\\",\\"Float64ArrayPrototype\\",\\"Function\\",\\"FunctionPrototype\\",\\"Generator\\",\\"GeneratorFunction\\",\\"GeneratorPrototype\\",\\"Int8Array\\",\\"Int8ArrayPrototype\\",\\"Int16Array\\",\\"Int16ArrayPrototype\\",\\"Int32Array\\",\\"Int32ArrayPrototype\\",\\"isFinite\\",\\"isNaN\\",\\"IteratorPrototype\\",\\"JSON\\",\\"Map\\",\\"MapIteratorPrototype\\",\\"MapPrototype\\",\\"Math\\",\\"Number\\",\\"NumberPrototype\\",\\"Object\\",\\"ObjectPrototype\\",\\"parseFloat\\",\\"parseInt\\",\\"Promise\\",\\"PromisePrototype\\",\\"Proxy\\",\\"RangeError\\",\\"RangeErrorPrototype\\",\\"ReferenceError\\",\\"ReferenceErrorPrototype\\",\\"Reflect\\",\\"RegExp\\",\\"RegExpPrototype\\",\\"RegExpStringIteratorPrototype\\",\\"Set\\",\\"SetIteratorPrototype\\",\\"SetPrototype\\",\\"SharedArrayBuffer\\",\\"SharedArrayBufferPrototype\\",\\"String\\",\\"StringIteratorPrototype\\",\\"StringPrototype\\",\\"Symbol\\",\\"SymbolPrototype\\",\\"SyntaxError\\",\\"SyntaxErrorPrototype\\",\\"ThrowTypeError\\",\\"TypedArray\\",\\"TypedArrayPrototype\\",\\"TypeError\\",\\"TypeErrorPrototype\\",\\"Uint8Array\\",\\"Uint8ArrayPrototype\\",\\"Uint8ClampedArray\\",\\"Uint8ClampedArrayPrototype\\",\\"Uint16Array\\",\\"Uint16ArrayPrototype\\",\\"Uint32Array\\",\\"Uint32ArrayPrototype\\",\\"URIError\\",\\"URIErrorPrototype\\",\\"WeakMap\\",\\"WeakMapPrototype\\",\\"WeakSet\\",\\"WeakSetPrototype\\",\\"escape\\",\\"unescape\\",\\"FunctionPrototypeConstructor\\",\\"Compartment\\",\\"CompartmentPrototype\\",\\"harden\\"],{getOwnPropertyDescriptor:c}=Object;function p(t,r){const e=c(t,r);return o(!(\\"get\\"in e||\\"set\\"in e),`unexpected accessor on global property: ${r}`),e.value}const{apply:s}=Reflect,y=(t=>(o,...r)=>s(t,o,r))(Object.prototype.hasOwnProperty);function l(){const t={__proto__:null},c=function(){const t=Function.prototype.constructor,o=typeof Symbol&&Symbol.iterator||\\"@@iterator\\",r=typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\",i=e(arguments,\\"callee\\").get,c=(new String)[o](),p=n(c);let s=null,y=null;r in new RegExp&&(s=(new RegExp)[r](),y=n(s));const l=(new Array)[o](),u=n(l),g=n(Float32Array),f=(new Map)[o](),P=n(f),b=(new Set)[o](),m=n(b),d=n(u);function*h(){}const A=a(h),E=A.prototype;async function*S(){}const _=a(S),w=_.prototype,I=w.prototype,F=n(I);async function T(){}const v=a(T),O={FunctionPrototypeConstructor:t,ArrayIteratorPrototype:u,AsyncFunction:v,AsyncGenerator:w,AsyncGeneratorFunction:_,AsyncGeneratorPrototype:I,AsyncIteratorPrototype:F,Generator:E,GeneratorFunction:A,IteratorPrototype:d,MapIteratorPrototype:P,RegExpStringIteratorPrototype:y,SetIteratorPrototype:m,StringIteratorPrototype:p,ThrowTypeError:i,TypedArray:g};return O}();!function(t){const{FunctionPrototypeConstructor:e,ArrayIteratorPrototype:n,AsyncFunction:a,AsyncGenerator:i,AsyncGeneratorFunction:c,AsyncGeneratorPrototype:p,AsyncIteratorPrototype:s,Generator:y,GeneratorFunction:l,IteratorPrototype:u,MapIteratorPrototype:g,RegExpStringIteratorPrototype:f,SetIteratorPrototype:P,StringIteratorPrototype:b,ThrowTypeError:m,TypedArray:d}=t;o(r(m)===Function.prototype,\\"ThrowTypeError.__proto__ should be Function.prototype\\"),o(r(b)===u,\\"StringIteratorPrototype.__proto__ should be IteratorPrototype\\"),f&&o(r(f)===u,\\"RegExpStringIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(d)===Function.prototype,\\"TypedArray.__proto__ should be Function.prototype\\"),o(r(g)===u,\\"MapIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(P)===u,\\"SetIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(u)===Object.prototype,\\"IteratorPrototype.__proto__ should be Object.prototype\\"),o(r(s)===Object.prototype,\\"AsyncIteratorPrototype.__proto__ should be Object.prototype\\"),o(r(n)===u,\\"AsyncIteratorPrototype.__proto__ should be IteratorPrototype\\"),o(r(l)===e,\\"GeneratorFunction.__proto__ should be Function\\"),o(\\"GeneratorFunction\\"===l.name,\'GeneratorFunction.name should be \\"GeneratorFunction\\"\'),o(r(y)===Function.prototype,\\"Generator.__proto__ should be Function.prototype\\"),o(r(c)===e,\\"AsyncGeneratorFunction.__proto__ should be Function\\"),o(\\"AsyncGeneratorFunction\\"===c.name,\'AsyncGeneratorFunction.name should be \\"AsyncGeneratorFunction\\"\'),o(r(i)===Function.prototype,\\"AsyncGenerator.__proto__ should be Function.prototype\\"),o(r(p)===s,\\"AsyncGeneratorPrototype.__proto__ should be AsyncIteratorPrototype\\"),o(r(a)===e,\\"AsyncFunction.__proto__ should be Function\\"),o(\\"AsyncFunction\\"===a.name,\'AsyncFunction.name should be \\"AsyncFunction\\"\')}(c);for(const o of i){if(y(c,o)){t[o]=c[o];continue}if(y(globalThis,o)){t[o]=p(globalThis,o);continue}if(o.endsWith(\\"Prototype\\")){const r=o.slice(0,-\\"Prototype\\".length);if(y(c,r)){const e=c[r];t[o]=e.prototype;continue}if(y(globalThis,r)){const e=p(globalThis,r);t[o]=e.prototype;continue}}}return function(t){Object.keys(t).forEach(o=>{if(void 0===t[o])throw new TypeError(`Malformed intrinsic: ${o}`)})}(t),t}const u={\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",name:\\"string\\"},g=u,f={get:g,set:\\"undefined\\"};function P(t){return{\\"**proto**\\":\\"Error\\",prototype:t,length:\\"number\\",name:\\"string\\"}}function b(t){return{\\"**proto**\\":\\"ErrorPrototype\\",constructor:t,message:\\"string\\",name:\\"string\\",toString:g}}function m(t){return{\\"**proto**\\":\\"TypedArray\\",length:\\"number\\",name:\\"string\\",BYTES_PER_ELEMENT:\\"number\\",prototype:t}}function d(t){return{\\"**proto**\\":\\"TypedArrayPrototype\\",BYTES_PER_ELEMENT:\\"number\\",constructor:t}}var h=function(t){return(typeof Symbol&&Symbol.matchAll||\\"@@matchAll\\")in new RegExp||delete t.RegExpStringIteratorPrototype,t}({\\"**proto**\\":null,ThrowTypeError:g,Infinity:\\"number\\",NaN:\\"number\\",undefined:\\"undefined\\",eval:g,isFinite:g,isNaN:g,parseFloat:g,parseInt:g,decodeURI:g,decodeURIComponent:g,encodeURI:g,encodeURIComponent:g,Object:{\\"**proto**\\":\\"FunctionPrototype\\",assign:g,create:g,defineProperties:g,defineProperty:g,entries:g,freeze:g,fromEntries:g,getOwnPropertyDescriptor:g,getOwnPropertyDescriptors:g,getOwnPropertyNames:g,getOwnPropertySymbols:g,getPrototypeOf:g,is:g,isExtensible:g,isFrozen:g,isSealed:g,keys:g,preventExtensions:g,prototype:\\"ObjectPrototype\\",seal:g,setPrototypeOf:g,values:g},ObjectPrototype:{\\"**proto**\\":null,constructor:\\"Object\\",hasOwnProperty:g,isPrototypeOf:g,propertyIsEnumerable:g,toLocaleString:g,toString:g,valueOf:g,__defineGetter__:g,__defineSetter__:g,__lookupGetter__:g,__lookupSetter__:g},Function:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},FunctionPrototype:{length:\\"number\\",name:\\"string\\",apply:g,bind:g,call:g,constructor:\\"FunctionPrototypeConstructor\\",toString:g,\\"@@hasInstance\\":g},Boolean:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"BooleanPrototype\\"},BooleanPrototype:{constructor:\\"Boolean\\",toString:g,valueOf:g},Symbol:{\\"**proto**\\":\\"FunctionPrototype\\",asyncIterator:\\"symbol\\",for:g,hasInstance:\\"symbol\\",isConcatSpreadable:\\"symbol\\",iterator:\\"symbol\\",keyFor:g,match:\\"symbol\\",matchAll:\\"symbol\\",prototype:\\"SymbolPrototype\\",replace:\\"symbol\\",search:\\"symbol\\",species:\\"symbol\\",split:\\"symbol\\",toPrimitive:\\"symbol\\",toStringTag:\\"symbol\\",unscopables:\\"symbol\\"},SymbolPrototype:{constructor:\\"Symbol\\",description:f,toString:g,valueOf:g,\\"@@toPrimitive\\":g,\\"@@toStringTag\\":\\"string\\"},Error:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"ErrorPrototype\\",captureStackTrace:g,stackTraceLimit:\\"number\\"},ErrorPrototype:{constructor:\\"Error\\",message:\\"string\\",name:\\"string\\",toString:g},EvalError:P(\\"EvalErrorPrototype\\"),RangeError:P(\\"RangeErrorPrototype\\"),ReferenceError:P(\\"ReferenceErrorPrototype\\"),SyntaxError:P(\\"SyntaxErrorPrototype\\"),TypeError:P(\\"TypeErrorPrototype\\"),URIError:P(\\"URIErrorPrototype\\"),EvalErrorPrototype:b(\\"EvalError\\"),RangeErrorPrototype:b(\\"RangeError\\"),ReferenceErrorPrototype:b(\\"ReferenceError\\"),SyntaxErrorPrototype:b(\\"SyntaxError\\"),TypeErrorPrototype:b(\\"TypeError\\"),URIErrorPrototype:b(\\"URIError\\"),Number:{\\"**proto**\\":\\"FunctionPrototype\\",EPSILON:\\"number\\",isFinite:g,isInteger:g,isNaN:g,isSafeInteger:g,MAX_SAFE_INTEGER:\\"number\\",MAX_VALUE:\\"number\\",MIN_SAFE_INTEGER:\\"number\\",MIN_VALUE:\\"number\\",NaN:\\"number\\",NEGATIVE_INFINITY:\\"number\\",parseFloat:g,parseInt:g,POSITIVE_INFINITY:\\"number\\",prototype:\\"NumberPrototype\\"},NumberPrototype:{constructor:\\"Number\\",toExponential:g,toFixed:g,toLocaleString:g,toPrecision:g,toString:g,valueOf:g},BigInt:{\\"**proto**\\":\\"FunctionPrototype\\",asIntN:g,asUintN:g,prototype:\\"BigIntPrototype\\"},BigIntPrototype:{constructor:\\"BigInt\\",toLocaleString:g,toString:g,valueOf:g,\\"@@toStringTag\\":\\"string\\"},Math:{E:\\"number\\",LN10:\\"number\\",LN2:\\"number\\",LOG10E:\\"number\\",LOG2E:\\"number\\",PI:\\"number\\",SQRT1_2:\\"number\\",SQRT2:\\"number\\",\\"@@toStringTag\\":\\"string\\",abs:g,acos:g,acosh:g,asin:g,asinh:g,atan:g,atanh:g,atan2:g,cbrt:g,ceil:g,clz32:g,cos:g,cosh:g,exp:g,expm1:g,floor:g,fround:g,hypot:g,imul:g,log:g,log1p:g,log10:g,log2:g,max:g,min:g,pow:g,random:g,round:g,sign:g,sin:g,sinh:g,sqrt:g,tan:g,tanh:g,trunc:g},Date:{\\"**proto**\\":\\"FunctionPrototype\\",now:g,parse:g,prototype:\\"DatePrototype\\",UTC:g},DatePrototype:{constructor:\\"Date\\",getDate:g,getDay:g,getFullYear:g,getHours:g,getMilliseconds:g,getMinutes:g,getMonth:g,getSeconds:g,getTime:g,getTimezoneOffset:g,getUTCDate:g,getUTCDay:g,getUTCFullYear:g,getUTCHours:g,getUTCMilliseconds:g,getUTCMinutes:g,getUTCMonth:g,getUTCSeconds:g,setDate:g,setFullYear:g,setHours:g,setMilliseconds:g,setMinutes:g,setMonth:g,setSeconds:g,setTime:g,setUTCDate:g,setUTCFullYear:g,setUTCHours:g,setUTCMilliseconds:g,setUTCMinutes:g,setUTCMonth:g,setUTCSeconds:g,toDateString:g,toISOString:g,toJSON:g,toLocaleDateString:g,toLocaleString:g,toLocaleTimeString:g,toString:g,toTimeString:g,toUTCString:g,valueOf:g,\\"@@toPrimitive\\":g,getYear:g,setYear:g,toGMTString:g},String:{\\"**proto**\\":\\"FunctionPrototype\\",fromCharCode:g,fromCodePoint:g,prototype:\\"StringPrototype\\",raw:g},StringPrototype:{length:\\"number\\",charAt:g,charCodeAt:g,codePointAt:g,concat:g,constructor:\\"String\\",endsWith:g,includes:g,indexOf:g,lastIndexOf:g,localeCompare:g,match:g,matchAll:g,normalize:g,padEnd:g,padStart:g,repeat:g,replace:g,search:g,slice:g,split:g,startsWith:g,substring:g,toLocaleLowerCase:g,toLocaleUpperCase:g,toLowerCase:g,toString:g,toUpperCase:g,trim:g,trimEnd:g,trimStart:g,valueOf:g,\\"@@iterator\\":g,substr:g,anchor:g,big:g,blink:g,bold:g,fixed:g,fontcolor:g,fontsize:g,italics:g,link:g,small:g,strike:g,sub:g,sup:g,trimLeft:g,trimRight:g},StringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},RegExp:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"RegExpPrototype\\",\\"@@species\\":f},RegExpPrototype:{constructor:\\"RegExp\\",exec:g,dotAll:f,flags:f,global:f,ignoreCase:f,\\"@@match\\":g,\\"@@matchAll\\":g,multiline:f,\\"@@replace\\":g,\\"@@search\\":g,source:f,\\"@@split\\":g,sticky:f,test:g,toString:g,unicode:f,compile:!1},RegExpStringIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Array:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,isArray:g,of:g,prototype:\\"ArrayPrototype\\",\\"@@species\\":f},ArrayPrototype:{length:\\"number\\",concat:g,constructor:\\"Array\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,flat:g,flatMap:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,map:g,pop:g,push:g,reduce:g,reduceRight:g,reverse:g,shift:g,slice:g,some:g,sort:g,splice:g,toLocaleString:g,toString:g,unshift:g,values:g,\\"@@iterator\\":g,\\"@@unscopables\\":{\\"**proto**\\":null,copyWithin:\\"boolean\\",entries:\\"boolean\\",fill:\\"boolean\\",find:\\"boolean\\",findIndex:\\"boolean\\",flat:\\"boolean\\",flatMap:\\"boolean\\",includes:\\"boolean\\",keys:\\"boolean\\",values:\\"boolean\\"}},ArrayIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},TypedArray:{\\"**proto**\\":\\"FunctionPrototype\\",from:g,of:g,prototype:\\"TypedArrayPrototype\\",\\"@@species\\":f},TypedArrayPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"TypedArray\\",copyWithin:g,entries:g,every:g,fill:g,filter:g,find:g,findIndex:g,forEach:g,includes:g,indexOf:g,join:g,keys:g,lastIndexOf:g,length:f,map:g,reduce:g,reduceRight:g,reverse:g,set:g,slice:g,some:g,sort:g,subarray:g,toLocaleString:g,toString:g,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":f},BigInt64Array:m(\\"BigInt64ArrayPrototype\\"),BigUint64Array:m(\\"BigUint64ArrayPrototype\\"),Float32Array:m(\\"Float32ArrayPrototype\\"),Float64Array:m(\\"Float64ArrayPrototype\\"),Int16Array:m(\\"Int16ArrayPrototype\\"),Int32Array:m(\\"Int32ArrayPrototype\\"),Int8Array:m(\\"Int8ArrayPrototype\\"),Uint16Array:m(\\"Uint16ArrayPrototype\\"),Uint32Array:m(\\"Uint32ArrayPrototype\\"),Uint8Array:m(\\"Uint8ArrayPrototype\\"),Uint8ClampedArray:m(\\"Uint8ClampedArrayPrototype\\"),BigInt64ArrayPrototype:d(\\"BigInt64Array\\"),BigUint64ArrayPrototype:d(\\"BigUint64Array\\"),Float32ArrayPrototype:d(\\"Float32Array\\"),Float64ArrayPrototype:d(\\"Float64Array\\"),Int16ArrayPrototype:d(\\"Int16Array\\"),Int32ArrayPrototype:d(\\"Int32Array\\"),Int8ArrayPrototype:d(\\"Int8Array\\"),Uint16ArrayPrototype:d(\\"Uint16Array\\"),Uint32ArrayPrototype:d(\\"Uint32Array\\"),Uint8ArrayPrototype:d(\\"Uint8Array\\"),Uint8ClampedArrayPrototype:d(\\"Uint8ClampedArray\\"),Map:{\\"**proto**\\":\\"FunctionPrototype\\",\\"@@species\\":f,prototype:\\"MapPrototype\\"},MapPrototype:{clear:g,constructor:\\"Map\\",delete:g,entries:g,forEach:g,get:g,has:g,keys:g,set:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},MapIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},Set:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"SetPrototype\\",\\"@@species\\":f},SetPrototype:{add:g,clear:g,constructor:\\"Set\\",delete:g,entries:g,forEach:g,has:g,keys:g,size:f,values:g,\\"@@iterator\\":g,\\"@@toStringTag\\":\\"string\\"},SetIteratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",next:g,\\"@@toStringTag\\":\\"string\\"},WeakMap:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakMapPrototype\\"},WeakMapPrototype:{constructor:\\"WeakMap\\",delete:g,get:g,has:g,set:g,\\"@@toStringTag\\":\\"string\\"},WeakSet:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"WeakSetPrototype\\"},WeakSetPrototype:{add:g,constructor:\\"WeakSet\\",delete:g,has:g,\\"@@toStringTag\\":\\"string\\"},ArrayBuffer:{\\"**proto**\\":\\"FunctionPrototype\\",isView:g,prototype:\\"ArrayBufferPrototype\\",\\"@@species\\":f},ArrayBufferPrototype:{byteLength:f,constructor:\\"ArrayBuffer\\",slice:g,\\"@@toStringTag\\":\\"string\\"},SharedArrayBuffer:!1,DataView:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"DataViewPrototype\\"},DataViewPrototype:{buffer:f,byteLength:f,byteOffset:f,constructor:\\"DataView\\",getBigInt64:g,getBigUint64:g,getFloat32:g,getFloat64:g,getInt8:g,getInt16:g,getInt32:g,getUint8:g,getUint16:g,getUint32:g,setBigInt64:g,setBigUint64:g,setFloat32:g,setFloat64:g,setInt8:g,setInt16:g,setInt32:g,setUint8:g,setUint16:g,setUint32:g,\\"@@toStringTag\\":\\"string\\"},Atomics:!1,JSON:{parse:g,stringify:g,\\"@@toStringTag\\":\\"string\\"},IteratorPrototype:{\\"@@iterator\\":g},AsyncIteratorPrototype:{\\"@@asyncIterator\\":g},GeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"Generator\\"},Generator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"GeneratorFunction\\",prototype:\\"GeneratorPrototype\\"},AsyncGeneratorFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncGenerator\\"},AsyncGenerator:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncGeneratorFunction\\",prototype:\\"AsyncGeneratorPrototype\\",\\"@@toStringTag\\":\\"string\\"},GeneratorPrototype:{\\"**proto**\\":\\"IteratorPrototype\\",constructor:\\"Generator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},AsyncGeneratorPrototype:{\\"**proto**\\":\\"AsyncIteratorPrototype\\",constructor:\\"AsyncGenerator\\",next:g,return:g,throw:g,\\"@@toStringTag\\":\\"string\\"},Promise:{\\"**proto**\\":\\"FunctionPrototype\\",all:g,allSettled:g,prototype:\\"PromisePrototype\\",race:g,reject:g,resolve:g,\\"@@species\\":f},PromisePrototype:{catch:g,constructor:\\"Promise\\",finally:g,then:g,\\"@@toStringTag\\":\\"string\\"},AsyncFunction:{\\"**proto**\\":\\"FunctionPrototypeConstructor\\",name:\\"string\\",length:\\"number\\",prototype:\\"AsyncFunctionPrototype\\"},AsyncFunctionPrototype:{\\"**proto**\\":\\"FunctionPrototype\\",constructor:\\"AsyncFunction\\",\\"@@toStringTag\\":\\"string\\"},Reflect:{apply:g,construct:g,defineProperty:g,deleteProperty:g,get:g,getOwnPropertyDescriptor:g,getPrototypeOf:g,has:g,isExtensible:g,ownKeys:g,preventExtensions:g,set:g,setPrototypeOf:g},Proxy:{\\"**proto**\\":\\"FunctionPrototype\\",revocable:g},escape:g,unescape:g,FunctionPrototypeConstructor:{\\"**proto**\\":\\"FunctionPrototype\\",length:\\"number\\",prototype:\\"FunctionPrototype\\"},Compartment:{\\"**proto**\\":\\"FunctionPrototype\\",prototype:\\"CompartmentPrototype\\"},CompartmentPrototype:{constructor:\\"Compartment\\",evaluate:g,global:f},harden:g});const{getPrototypeOf:A,getOwnPropertyDescriptor:E}=Object,{apply:S,ownKeys:_}=Reflect,w=(t=>(o,...r)=>S(t,o,r))(Object.prototype.hasOwnProperty);function I(t,o){if(\\"string\\"==typeof o)return o;if(\\"symbol\\"==typeof o)return`@@${o.toString().slice(14,-1)}`;throw new TypeError(`Unexpected property name type ${t} ${o}`)}function F(t){const o=[\\"undefined\\",\\"boolean\\",\\"number\\",\\"string\\",\\"symbol\\"];function r(r,e,n,i){if(\\"object\\"==typeof i)return a(r,e,i),!0;if(!1===i)return!1;if(\\"string\\"==typeof i)if(\\"prototype\\"===n||\\"constructor\\"===n){if(w(t,i))return e===t[i]}else if(o.includes(i))return typeof e===i;throw new TypeError(`Unexpected whitelist permit ${r}`)}function e(t,o,e,n){const a=E(o,e);return w(a,\\"value\\")?r(t,a.value,e,n):r(`${t}<get>`,a.get,e,n.get)&&r(`${t}<set>`,a.set,e,n.set)}function n(t,o){return w(t,o)?t[o]:\\"FunctionPrototype\\"===t[\\"**proto**\\"]&&w(u,o)?u[o]:void 0}function a(o,r,a){!function(o,r,e){const n=A(r);if(null!==n||null!==e){if(void 0!==e&&\\"string\\"!=typeof e)throw new TypeError(`Malformed whitelist permit ${o}.__proto__`);if(n!==t[e||\\"ObjectPrototype\\"])throw new Error(`Unexpected intrinsic ${o}.__proto__`)}}(o,r,a[\\"**proto**\\"]);for(const t of _(r)){if(\\"__proto__\\"===t)continue;const i=I(o,t),c=`${o}.${i}`,p=n(a,i);if(!p||!e(c,r,t,p))try{delete r[t]}catch(t){}}}a(\\"intrinsics\\",t,h)}const{defineProperties:T,getOwnPropertyDescriptors:v}=Object;const{getOwnPropertyDescriptor:O}=Object;const{defineProperties:U,getOwnPropertyDescriptors:x,getOwnPropertyDescriptor:R}=Object;const C=!0;var M={ObjectPrototype:\\"*\\",ArrayPrototype:\\"*\\",FunctionPrototype:{constructor:C,bind:C,name:C,toString:C},ErrorPrototype:{constructor:C,message:C,name:C},PromisePrototype:{constructor:C},TypedArrayPrototype:\\"*\\",Generator:{constructor:C,name:C,toString:C},IteratorPrototype:\\"*\\"};const{defineProperties:j,getOwnPropertyNames:G,getOwnPropertyDescriptor:k,getOwnPropertyDescriptors:N}=Object,{ownKeys:$}=Reflect;function D(t){return null!==t&&\\"object\\"==typeof t}const{assign:B,freeze:L,defineProperties:W,getOwnPropertyDescriptor:V,getOwnPropertyNames:z,getPrototypeOf:Y,setPrototypeOf:J,prototype:H}=Object,{apply:K,get:Q,set:X}=Reflect,{isArray:q,prototype:Z}=Array,{revocable:tt}=Proxy,{prototype:ot}=RegExp,{prototype:rt}=String,{prototype:et}=WeakMap,nt=t=>(o,...r)=>K(t,o,r),at=nt(H.hasOwnProperty),it=(nt(Z.filter),nt(Z.join)),ct=(nt(Z.push),nt(Z.pop)),pt=nt(Z.includes),st=nt(ot.test),yt=(nt(rt.match),nt(rt.search)),lt=nt(rt.slice),ut=nt(rt.split),gt=(nt(et.get),nt(et.set),nt(et.has),t=>Q(Y(t),\\"constructor\\")),ft=L({__proto__:null});function Pt(t,o){const r=`please report internal shim error: ${t}`;throw console.error(r),o&&(console.error(`${o}`),console.error(`${o.stack}`)),TypeError(r)}function bt(t,o){t||Pt(o)}const mt=[\\"await\\",\\"break\\",\\"case\\",\\"catch\\",\\"class\\",\\"const\\",\\"continue\\",\\"debugger\\",\\"default\\",\\"delete\\",\\"do\\",\\"else\\",\\"export\\",\\"extends\\",\\"finally\\",\\"for\\",\\"function\\",\\"if\\",\\"import\\",\\"in\\",\\"instanceof\\",\\"new\\",\\"return\\",\\"super\\",\\"switch\\",\\"this\\",\\"throw\\",\\"try\\",\\"typeof\\",\\"var\\",\\"void\\",\\"while\\",\\"with\\",\\"yield\\",\\"let\\",\\"static\\",\\"enum\\",\\"implements\\",\\"package\\",\\"protected\\",\\"interface\\",\\"private\\",\\"public\\",\\"await\\",\\"null\\",\\"true\\",\\"false\\",\\"this\\",\\"arguments\\"],dt=new RegExp(\\"^[a-zA-Z_$][\\\\\\\\w$]*$\\");function ht(t){return\\"eval\\"!==t&&!pt(mt,t)&&st(dt,t)}function At(t,o){const r=V(t,o);return(!1===r.configurable&&!1===r.writable&&at(r,\\"value\\"))}const Et=new Proxy(ft,{get(t,o){Pt(`unexpected scope handler trap called: ${String(o)}`)}});function St(t,o){const r=yt(t,o);return r<0?-1:ut(lt(t,0,r),\\"\\\\n\\").length}const _t=new RegExp(\\"(?:\\\\x3c!--|--\\\\x3e)\\");const wt=new RegExp(\\"\\\\\\\\bimport\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const It=new RegExp(\\"\\\\\\\\beval\\\\\\\\s*(?:\\\\\\\\(|/[/*])\\");const Ft={rewrite:t=>(function(t){const o=St(t,_t);if(o<0)return t;throw new SyntaxError(`possible html comment syntax rejected around line ${o}`)}(t.src),function(t){const o=St(t,wt);if(o<0)return t;throw new SyntaxError(`possible import expression rejected around line ${o}`)}(t.src),function(t){const o=St(t,It);if(o<0)return t;throw new SyntaxError(`possible direct eval expression rejected around line ${o}`)}(t.src),t)};function Tt(t,o=[]){const r=function(t){return 0===t.length?\\"\\":`const {${it(t,\\",\\")}} = this;`}(o);return t.intrinsics.Function(`\\\\n    with (this) {\\\\n      ${r}\\\\n      return function() {\\\\n        \'use strict\';\\\\n        return eval(arguments[0]);\\\\n      };\\\\n    }\\\\n  `)}function vt(t,o,r,e={},{localTransforms:n=[],globalTransforms:a=[],sloppyGlobalsMode:i=!1}={}){let c={src:o,endowments:e};c=function(t,o){for(const r of o)\\"function\\"==typeof r.rewrite&&(t=r.rewrite(t));return t}(c,[...n,...a,Ft]);const p=function(t,o,r={},{sloppyGlobalsMode:e=!1}={}){return{__proto__:Et,useUnsafeEvaluator:!1,get(e,n){if(\\"symbol\\"!=typeof n)return\\"eval\\"===n&&!0===this.useUnsafeEvaluator?(this.useUnsafeEvaluator=!1,t.intrinsics.eval):n in r?Q(r,n,o):Q(o,n)},set(t,e,n){if(e in r){return\\"value\\"in V(r,e)?X(r,e,n):X(r,e,n,o)}return X(o,e,n)},has:(t,n)=>!!(e||\\"eval\\"===n||n in r||n in o||n in globalThis),getPrototypeOf:()=>null}}(t,r,c.endowments,{sloppyGlobalsMode:i}),s=tt(ft,p),y=Tt(t,function(t,o={}){const r=z(t),e=z(o),n=e.filter(t=>ht(t)&&At(o,t));return[...r.filter(o=>!e.includes(o)&&ht(o)&&At(t,o)),...n]}(r,c.endowments)),l=K(y,s.proxy,[]);let u;p.useUnsafeEvaluator=!0;try{return K(l,r,[c.src])}catch(t){throw u=t,t}finally{!0===p.useUnsafeEvaluator&&(Pt(\\"handler did not revoke useUnsafeEvaluator\\",u),s.revoke())}}const Ot=(t,o,r={})=>{const e=e=>\\"string\\"!=typeof e?e:vt(t,e,o,{},r);return W(e,{toString:{value:()=>\\"function eval() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(gt(e)!==Function,\\"eval constructor is Function\\"),bt(gt(e)!==t.intrinsics.Function,\\"eval contructions is %Function%\\"),e};function Ut(t,o,r={}){const e=function(e){const n=`${ct(arguments)||\\"\\"}`,a=`${it(arguments,\\",\\")}`;new t.intrinsics.Function(a,n);const i=`(function anonymous(${a}\\\\n) {\\\\n${n}\\\\n})`;return vt(t,i,o,{},r)};return W(e,{prototype:{value:t.intrinsics.Function.prototype,writable:!1,enumerable:!1,configurable:!1},toString:{value:()=>\\"function Function() { [native code] }\\",writable:!1,enumerable:!1,configurable:!0}}),bt(Y(Function)===Function.prototype),bt(Y(e)===Function.prototype),bt(gt(e)!==Function),bt(gt(e)!==t.intrinsics.Function),e}const xt=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];const{getOwnPropertyDescriptor:Rt}=Object,Ct=[\\"eval\\",\\"isFinite\\",\\"isNaN\\",\\"parseFloat\\",\\"parseInt\\",\\"decodeURI\\",\\"decodeURIComponent\\",\\"encodeURI\\",\\"encodeURIComponent\\",\\"Array\\",\\"ArrayBuffer\\",\\"Boolean\\",\\"DataView\\",\\"Date\\",\\"Error\\",\\"EvalError\\",\\"Float32Array\\",\\"Float64Array\\",\\"Function\\",\\"Int8Array\\",\\"Int16Array\\",\\"Int32Array\\",\\"Map\\",\\"Number\\",\\"Object\\",\\"Promise\\",\\"Proxy\\",\\"RangeError\\",\\"ReferenceError\\",\\"RegExp\\",\\"Set\\",\\"String\\",\\"Symbol\\",\\"SyntaxError\\",\\"TypeError\\",\\"Uint8Array\\",\\"Uint8ClampedArray\\",\\"Uint16Array\\",\\"Uint32Array\\",\\"URIError\\",\\"WeakMap\\",\\"WeakSet\\",\\"JSON\\",\\"Math\\",\\"Reflect\\",\\"escape\\",\\"unescape\\",\\"globalThis\\",\\"Compartment\\",\\"harden\\"];let Mt;function jt(){if(Mt)return Mt;const t=function(){const t={__proto__:null};for(const o of Ct){const r=Rt(globalThis,o);if(r){if(\\"get\\"in r||\\"set\\"in r)throw new TypeError(`Unexpected accessor on global property: ${o}`);t[o]=r.value}}return t}();return Mt={__proto__:null,intrinsics:t},L(Mt)}const Gt=new WeakMap;class kt{constructor(t,o,r={}){const{transforms:e=[]}=r,n=[...e],a=function(t,{globalTransforms:o}){const r={},e={Infinity:{value:1/0,enumerable:!1},NaN:{value:NaN,enumerable:!1},undefined:{value:void 0,enumerable:!1}};for(const n of xt){if(!at(t.intrinsics,n))continue;let a;switch(n){case\\"eval\\":a=Ot(t,r,{globalTransforms:o});break;case\\"Function\\":a=Ut(t,r,{globalTransforms:o});break;case\\"globalThis\\":a=r;break;default:a=t.intrinsics[n]}e[n]={value:a,configurable:!0,writable:!0,enumerable:!1}}return W(r,e),bt(r.eval!==t.intrinsics.eval,\\"eval on global object\\"),bt(r.Function!==t.intrinsics.Function,\\"Function on global object\\"),r}(jt(),{globalTransforms:n});B(a,t),Gt.set(this,{globalTransforms:n,globalObject:a})}get global(){return Gt.get(this).globalObject}evaluate(t,o={}){if(\\"string\\"!=typeof t)throw new TypeError(\\"first argument of evaluate() must be a string\\");const{endowments:r={},transforms:e=[],sloppyGlobalsMode:n=!1}=o,a=[...e],{globalTransforms:i,globalObject:c}=Gt.get(this);return vt(jt(),t,c,r,{globalTransforms:i,localTransforms:a,sloppyGlobalsMode:n})}toString(){return\\"[object Compartment]\\"}static toString(){return\\"function Compartment() { [shim code] }\\"}}let Nt;function $t(t,o){if(!t)throw new TypeError(o)}\\"object\\"!=typeof globalThis&&(Object.prototype.__defineGetter__(\\"__magic__\\",(function(){return this})),__magic__.globalThis=__magic__,delete Object.prototype.__magic__),t.lockdown=function(t={}){const{noTameDate:o=!1,noTameError:r=!1,noTameMath:e=!1,noTameRegExp:n=!1,registerOnly:a=!1,...i}=t,c=Object.keys(i);$t(0===c.length,`lockdown(): non supported option ${c.join(\\", \\")}`);const p={noTameDate:o,noTameError:r,noTameMath:e,noTameRegExp:n,registerOnly:a};if(Nt)return Object.keys(p).forEach(t=>{$t(p[t]===Nt[t],`lockdown(): cannot re-invoke with different option ${t}`)}),!1;Nt=p,function(){try{(0,Function.prototype.constructor)(\\"return 1\\")}catch(t){return}const{defineProperties:t,getPrototypeOf:o,setPrototypeOf:r}=Object;function e(e,n){let a;try{a=(0,eval)(n)}catch(t){if(t instanceof SyntaxError)return;throw t}const i=o(a),c=function(){throw new TypeError(\\"Not available\\")};t(c,{name:{value:e,writable:!1,enumerable:!1,configurable:!0},toString:{value:()=>`function ${e}() { [native code] }`,writable:!1,enumerable:!1,configurable:!0}}),t(i,{constructor:{value:c}}),t(c,{prototype:{value:i}}),c!==Function.prototype.constructor&&r(c,Function.prototype.constructor)}e(\\"Function\\",\\"(function(){})\\"),e(\\"GeneratorFunction\\",\\"(function*(){})\\"),e(\\"AsyncFunction\\",\\"(async function(){})\\"),e(\\"AsyncGeneratorFunction\\",\\"(async function*(){})\\")}(),o||function(){const t={now:()=>NaN};Date.now=t.now;const o={toLocaleString:()=>NaN};Date.prototype.toLocaleString=o.toLocaleString;const r=Date,e=function(){return void 0===new.target?\\"Invalid Date\\":arguments.length>0?Reflect.construct(r,arguments,new.target):Reflect.construct(r,[NaN],new.target)},n=v(r);T(e,n);const a=v(r.prototype);a.constructor.value=e,T(e.prototype,a),globalThis.Date=e;const i={toLocaleString(){throw new TypeError(\\"Object.prototype.toLocaleString is disabled\\")}};Object.prototype.toLocaleString=i.toLocaleString}(),r||function(){if(delete Error.captureStackTrace,O(Error,\\"captureStackTrace\\"))throw Error(\\"Cannot remove Error.captureStackTrace\\");if(delete Error.stackTraceLimit,O(Error,\\"stackTraceLimit\\"))throw Error(\\"Cannot remove Error.stackTraceLimit\\")}(),e||function(){const t={random(){throw TypeError(\\"Math.random() is disabled\\")}};Math.random=t.random}(),n||function(){delete RegExp.prototype.compile;const t=RegExp,o=function(){return Reflect.construct(t,arguments,new.target)},r=R(t,Symbol.species);U(o,Symbol.species,r);const e=x(t.prototype);e.constructor.value=o,U(o.prototype,e),globalThis.RegExp=o}();const s=function(t,o={}){const{freeze:r,getOwnPropertyDescriptors:e,getPrototypeOf:n}=Object,{ownKeys:a}=Reflect;let{fringeSet:i}=o;if(i){if(\\"function\\"!=typeof i.add||\\"function\\"!=typeof i.has)throw new TypeError(\\"options.fringeSet must have add() and has() methods\\");if(t)for(const o of t)i.add(o)}else i=new WeakSet(t);const c=o&&o.naivePrepareObject,{harden:p}={harden(t){const o=new Set,p=new Map,s=new WeakMap;function y(t,r){if(Object(t)!==t)return;const e=typeof t;if(\\"object\\"!==e&&\\"function\\"!==e)throw new TypeError(`Unexpected typeof: ${e}`);i.has(t)||o.has(t)||(o.add(t),s.set(t,r))}function l(t){c&&c(t),r(t);const o=n(t),i=e(t),l=s.get(t)||\\"unknown\\";null===o||p.has(o)||(p.set(o,l),s.set(o,`${l}.__proto__`)),a(i).forEach(t=>{const o=`${l}.${String(t)}`,r=i[t];\\"value\\"in r?y(r.value,`${o}`):(y(r.get,`${o}(get)`),y(r.set,`${o}(set)`))})}return y(t),o.forEach(l),p.forEach((t,r)=>{if(!o.has(r)&&!i.has(r)){let o;try{o=`prototype ${r} of ${t} is not already in the fringeSet`}catch(e){o=\\"a prototype of something is not already in the fringeset (and .toString failed)\\";try{console.log(o),console.log(\\"the prototype:\\",r),console.log(\\"of something:\\",t)}catch(t){}}throw new TypeError(o)}}),o.forEach(i.add,i),t}};return p}();Object.defineProperties(globalThis,{harden:{value:s,configurable:!0,writable:!0,enumerable:!1},Compartment:{value:kt,configurable:!0,writable:!0,enumerable:!1}});const y=l();F(y),function(){try{(0,Object.prototype.__lookupGetter__)(\\"x\\")}catch(t){return}const{defineProperty:t,defineProperties:o,getOwnPropertyDescriptor:r,getPrototypeOf:e,prototype:n}=Object;function a(t){if(null==t)throw new TypeError(\\"can\'t convert undefined or null to object\\");return Object(t)}function i(t){return\\"symbol\\"==typeof t?t:`${t}`}function c(t,o){if(\\"function\\"!=typeof t)throw TypeError(`invalid ${o} usage`);return t}o(n,{__defineGetter__:{value:function(o,r){const e=a(this);t(e,o,{get:c(r,\\"getter\\"),enumerable:!0,configurable:!0})}},__defineSetter__:{value:function(o,r){const e=a(this);t(e,o,{set:c(r,\\"setter\\"),enumerable:!0,configurable:!0})}},__lookupGetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.get}},__lookupSetter__:{value:function(t){let o,n=a(this);for(t=i(t);n&&!(o=r(n,t));)n=e(n);return o&&o.set}}})}();const u=function(t){const o={};function r(t,r,e,n){if(\\"value\\"in n&&n.configurable){const{value:a}=n;o[t]=a,j(r,{[e]:{get:function(){return a},set:function(o){if(r===this)throw new TypeError(`Cannot assign to read only property \'${e}\' of \'${t}\'`);hasOwnProperty.call(this,e)?this[e]=o:j(this,{[e]:{value:o,writable:!0,enumerable:n.enumerable,configurable:n.configurable}})},enumerable:n.enumerable,configurable:n.configurable}})}}function e(t,o,e){const n=k(o,e);n&&r(t,o,e,n)}function n(t,o){const e=N(o);e&&$(e).forEach(n=>r(t,o,n,e[n]))}return function t(o,r,a){for(const i of G(a)){const c=k(r,i);if(!c||c.get||c.set)continue;const p=`${o}.${i}`,s=a[i];if(!0===s)e(p,r,i);else if(\\"*\\"===s)n(p,c.value);else{if(!D(s))throw new TypeError(`Unexpected override enablement plan ${p}`);t(p,c.value,s)}}}(\\"root\\",t,M),o}(y);return s(y,a),s(u,a),!0},Object.defineProperty(t,\\"__esModule\\",{value:!0})}));\\n"')},function(t,e){t.exports={makeDeterministic:function(t){const e=(t,e)=>{if(t===e)return 0;if(void 0===t)return 1;if(void 0===e)return-1;const n=null===t?"null":t.toString(),r=null===e?"null":e.toString();return n<r?-1:n>r?1:0},n=Array.prototype.sort;Array.prototype.sort=function(t=e){const r=new Map;return this.forEach(((t,e)=>r.set(t,e))),n.call(this,((e,n)=>{const o=t(e,n);return 0!==o?o:r.get(e)-r.get(n)}))},delete String.prototype.localeCompare;const r=Object.keys;Object.keys=function(t){const e=r(t),n=Object.getOwnPropertyNames(t);return e.sort(((t,e)=>n.indexOf(t)-n.indexOf(e)))},Object.values=function(t){return Object.keys(t).map((e=>t[e]))},Object.entries=function(t){return Object.keys(t).map((e=>[e,t[e]]))},JSON.stringify=t();const o=Function.prototype.toString;Function.prototype.toString=function t(){if(this===Array.prototype.sort)return"function sort() { [native code ] }";if(this===Object.keys)return"function keys() { [native code ] }";if(this===Object.values)return"function values() { [native code ] }";if(this===Object.entries)return"function entries() { [native code ] }";if(this===JSON.stringify)return"function stringify() { [native code ] }";if(this===t)return"function toString() { [native code ] }";const e=o.call(this),n=e.match(/^([a-zA-Z0-9_$]+)\s*\(/);return n&&"function"!==n[1]?"function "+e:e}},nonDeterministicIntrinsics:["Date","Math","eval","XMLHttpRequest","FileReader","WebSocket","setTimeout","setInterval"]}},function(t,e,n){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=u(t),s=r[0],c=r[1],a=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,c)),h=0,f=c>0?s-4:s;for(n=0;n<f;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;2===c&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,a[h++]=255&e);1===c&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e);return a},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],s=16383,c=0,a=n-o;c<a;c+=s)i.push(h(t,c,c+s>a?a:c+s));1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,a=s.length;c<a;++c)r[c]=s[c],o[s.charCodeAt(c)]=c;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function h(t,e,n){for(var o,i,s=[],c=e;c<n;c+=3)o=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),s.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,o){var i,s,c=8*o-r-1,a=(1<<c)-1,u=a>>1,h=-7,f=n?o-1:0,l=n?-1:1,p=t[e+f];for(f+=l,i=p&(1<<-h)-1,p>>=-h,h+=c;h>0;i=256*i+t[e+f],f+=l,h-=8);for(s=i&(1<<-h)-1,i>>=-h,h+=r;h>0;s=256*s+t[e+f],f+=l,h-=8);if(0===i)i=1-u;else{if(i===a)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=u}return(p?-1:1)*s*Math.pow(2,i-r)},e.write=function(t,e,n,r,o,i){var s,c,a,u=8*i-o-1,h=(1<<u)-1,f=h>>1,l=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,y=r?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-s))<1&&(s--,a*=2),(e+=s+f>=1?l/a:l*Math.pow(2,1-f))*a>=2&&(s++,a/=2),s+f>=h?(c=0,s=h):s+f>=1?(c=(e*a-1)*Math.pow(2,o),s+=f):(c=e*Math.pow(2,f-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&c,p+=y,c/=256,o-=8);for(s=s<<o|c,u+=o;u>0;t[n+p]=255&s,p+=y,s/=256,u-=8);t[n+p-y]|=128*d}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){const r=n(3),o=n(23),i=n(5),{P:s,R:c,j:a}=n(1),{StateError}=n(12);t.exports=function(t,e,u){switch(r.rt&&r.ot("Execute","Executing",t,JSON.stringify(e)),t){case"DEPLOY":return function(t,e){const Code=n(0);s(t instanceof Array&&t.length%2==0,"Invalid deploy data");const r=t.length/2,c=[];for(let t=0;t<r;t++)c.push(new Code);const u=(new o).Ui().Ni((t=>{const n=e[t]||c[t-e.length];return s(n,"Invalid local jig reference: "+t),n})).Di(t);for(let t=0;t<r;t++){const e=u[2*t+0],n=u[2*t+1],[r]=i.yn(e,n.deps);Object.keys(n).forEach((t=>{a(r,t,n[t])}));const o=c[t],s=!1,[h]=Code.re(o,r,s);Code.Yt(o).X(h,s,[],e)}const h=n(6).ct;c.forEach((t=>h.Gn(t))),Code.Zt(...c)}(e,u);case"DESTROY":return function(t,e){const r=(new o).Ui().Ni((t=>e[t])).Di(t),Code=n(0),Jig=n(2);s(r instanceof Code||r instanceof Jig,"Invalid destroy target"),r.destroy()}(e,u);case"AUTH":return function(t,e){const r=(new o).Ui().Ni((t=>e[t])).Di(t),Code=n(0),Jig=n(2);s(r instanceof Code||r instanceof Jig,"Invalid auth target"),r.auth()}(e,u);case"UPGRADE":return function(t,e){const Code=n(0),r=(new o).Ui().Ni((t=>e[t])).Di(t);c(Array.isArray(r)),c(3===r.length),c(r[0]instanceof Code),c("string"==typeof r[1]);const[s,u,h]=r,[f]=i.yn(u,h.deps);Object.keys(h).forEach((t=>{a(f,t,h[t])}));const[l]=Code.re(s,f),p=!1;s.upgrade(l,p,u)}(e,u);case"CALL":return function(t,e){const Code=n(0),Jig=n(2),r=(new o).Ui().Ni((t=>e[t])).Di(t);c(3===r.length),c(r[0]instanceof Code||r[0]instanceof Jig),c("string"==typeof r[1]),c(Array.isArray(r[2]));const[i,s,a]=r;i[s](...a)}(e,u);case"NEW":return function(t,e){const Code=n(0),r=(new o).Ui().Ni((t=>e[t])).Di(t);c(2===r.length),c(r[0]instanceof Code),c(Array.isArray(r[1]));const[i,s]=r;new i(...s)}(e,u);default:throw new StateError("Unknown op: "+t)}}},function(t,e,n){const r=n(3),o=n(8),{H:i}=n(10),{h:s,Re:c}=n(1),{G:a}=n(4),Unbound=n(11),{TimeoutError,RequestError}=n(12),u="Inventory";t.exports=class{constructor(){this.uc=(t,e)=>this.Uc(e),this.Sn=[]}activate(t){this.deactivate(),r.rt&&r.ot(u,"Activate"),this.Dc=t,t.on("update",this.uc),t.on("publish",this.uc),t.on("sync",this.uc),this.Fc=null,this.Mc=[];const e=async()=>{try{const n=await t.g.Zr().nextOwner();if(this.Bc!==e)return;this.Fc=i(n),r.rt&&r.ot(u,"Owner",n),this.Mc.forEach((t=>this.Uc(t))),this.Mc=null}catch(t){if(this.Bc!==e)return;r.fn&&r.un(u,"Inventory disabled: "+t),this.Mc=null}};this.Bc=e,this.Gc=e()}deactivate(){this.Dc&&(r.rt&&r.ot(u,"Deactivate"),this.Dc.off("update",this.uc),this.Dc.off("publish",this.uc),this.Dc.off("sync",this.uc),this.Dc=null,this.Fc=null,this.Mc=null,this.Gc=null)}get jigs(){this.Lc();const Jig=n(2);return this.Sn.filter((t=>t instanceof Jig))}get code(){this.Lc();const Code=n(0);return this.Sn.filter((t=>t instanceof Code))}async sync(){if(r.Jt&&r.Wt(u,"Sync"),this.Gc&&await this.Gc,this.Fc)return this.qe||(this.qe=this.Jc().then((()=>{this.qe=null})).catch((t=>{throw this.qe=null,t}))),this.qe}async Jc(){const t=new o.Script(o.deps.Buffer.from(this.Fc.script())).toString("hex"),e=(await this.Dc.blockchain.utxos(t)).map((t=>`${t.txid}_o${t.vout}`)),i=a((()=>this.Sn.map((t=>t.location)))),s=n(14),h=new c("inventory sync",this.Dc.g.timeout),f=new s(this.Dc.g,h);for(const t of e){if(i.includes(t))continue;try{if(await this.Dc.cache.get("ban://"+t))continue}catch(t){}let e=null;try{e=await f.cr(t)}catch(e){if(e instanceof TimeoutError)throw e;if(e instanceof RequestError)throw e;r.hn&&r.an(u,`Failed to load ${t}\n\n${e.toString()}`);try{await this.Dc.cache.set("ban://"+t,1)}catch(t){}continue}this.Uc(e)}this.Lc()}Uc(t){!this.Fc&&this.Mc&&this.Mc.push(t);const e=this.Sn.find((e=>this.Wc(e,t)));e&&a((()=>e.nonce>t.nonce))||(this.Sn=this.Sn.filter((t=>t!==e)),this.Hc(t)?(!e&&r.Jt&&r.Wt(u,"Add",s(t)),this.Sn.push(t)):e&&r.Jt&&r.Wt(u,"Remove",s(t)))}Wc(t,e){if(t===e)return!0;const n=a((()=>t.origin)),r=a((()=>e.origin));return!n.startsWith("error://")&&(!r.startsWith("error://")&&n===r)}Hc(t){try{if(a((()=>t.location)).startsWith("error://"))return!1;let e=a((()=>t.owner));if(e instanceof Unbound&&(e=e.Dn),void 0===e)return!0;if(!this.Fc)return!1;const n=i(e).script(),r=this.Fc.script();if(n.length!==r.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!1;return!0}catch(t){return!1}}Lc(){this.Sn=this.Sn.filter((t=>!!this.Hc(t)||(r.Jt&&r.Wt(u,"Remove",s(t)),!1)))}}},function(t,e,n){const r=n(3),{h:o,Te:i}=n(1),{Zn:s}=n(13),c="LocalCache";class a{constructor(t={}){this.Vc=new Map,this.zc=0,this.Kc=1e3*u(t.maxSizeMB)*1e3}get maxSizeMB(){return this.Kc/1e3/1e3}set maxSizeMB(t){this.Kc=1e3*u(t)*1e3,this.Yc()}get sizeBytes(){return this.zc}async get(t){const e=this.Vc.has(t),n=this.Vc.get(t);if(e)return this.Vc.delete(t),this.Vc.set(t,n),n}async set(t,e){const n=this.Vc.has(t),o=this.Vc.get(t);if(n&&!s(e,o)){r.fn&&r.un(c,"Expected:",JSON.stringify(o,0,3)),r.fn&&r.un(c,"Actual:",JSON.stringify(e,0,3));throw new Error(`Attempt to set different values for the same key: ${t}\n\n${"This is an internal Run bug. Please report it to the library developers."}`)}this.Vc.delete(t),this.Vc.set(t,e),n||(this.zc+=a.qc(t),this.zc+=a.qc(e),this.Yc())}clear(){r.rt&&r.ot(c,"Clear"),this.Vc.clear(),this.zc=0}Yc(){for(;this.zc>i(this.Kc);){const t=this.Vc.keys().next().value,e=this.Vc.get(t);this.Vc.delete(t),this.zc-=a.qc(t),this.zc-=a.qc(e)}}static qc(t){switch(typeof t){case"undefined":throw new Error("Cannot cache undefined");case"boolean":return 5;case"number":if(Number.isFinite(t))return 9;throw new Error("Cannot cache number: "+o(t));case"string":return 2*t.length+1;case"object":{if(!t)return 5;const e=Object.keys(t);let n=1+4*e.length;return e.forEach((e=>{n+=a.qc(e),n+=a.qc(t[e])})),n}case"function":throw new Error("Cannot cache function: "+o(t));case"symbol":throw new Error("Cannot cache symbol: "+o(t))}}}function u(t){if(void 0===t)return 10;if("number"==typeof t&&!Number.isNaN(t)&&t>=0)return t;throw new Error("Invalid maxSizeMB: "+o(t))}t.exports=a},function(t,e,n){const{PrivateKey:r,Script:o,Transaction:i}=n(8),{fe:s,h:c,g:a}=n(1),{Ci:u}=n(21);t.exports=class{constructor(t,e){try{e=e||a().Ot().network}catch(t){}const n=e&&s(e);if(void 0!==t&&"string"!=typeof t&&!(t instanceof r))throw new Error("Invalid private key: "+c(t));if(n&&t&&t instanceof r&&t.network.name!==n)throw new Error("Private key network mismatch");try{this.bsvPrivateKey=new r(t,n)}catch(e){throw new Error(`Invalid private key: ${c(t)}\n\n${e}`)}if(t&&this.bsvPrivateKey.toString()!==t.toString())throw new Error("Invalid private key: "+c(t));this.bsvPublicKey=this.bsvPrivateKey.publicKey,this.bsvAddress=this.bsvPublicKey.toAddress(),this.privkey=this.bsvPrivateKey.toString(),this.pubkey=this.bsvPublicKey.toString(),this.address=this.bsvAddress.toString()}async sign(t,e,r){const StandardLock=n(32),Group=n(42),s=new i(t);e.forEach(((t,e)=>{t&&(s.inputs[e].output=new i.Output({satoshis:t.satoshis,script:new o(t.script)}))}));for(let t=0;t<s.inputs.length;t++){const n=r[t]instanceof StandardLock,i=s.inputs[t].output&&s.inputs[t].output.script.isPublicKeyHashOut()&&s.inputs[t].output.script.toAddress().toString()===this.address;if(n||i){const n=new o(e[t].script);if(n.toAddress().toString()!==this.address)continue;const r=u(s,t,n,e[t].satoshis,this.bsvPrivateKey),i=o.fromASM(`${r} ${this.pubkey}`);s.inputs[t].setScript(i)}if(r[t]instanceof Group&&r[t].pubkeys.includes(this.pubkey)&&s.inputs[t].script.chunks.length<=r[t].required){const n=new o(e[t].script),r=u(s,t,n,e[t].satoshis,this.bsvPrivateKey);let i=null;i=s.inputs[t].script.toBuffer().length?o.fromASM(`${s.inputs[t].script.toASM()} ${r}`):o.fromASM("OP_0 "+r),s.inputs[t].setScript(i)}}return s.toString("hex")}async nextOwner(){return this.address}}},function(t,e,n){const r=n(8),{PrivateKey:o,Script:i,Transaction:s}=r,{fe:c,h:a}=n(1),u=n(3),{Ci:h}=n(21),f="LocalPurse";function l(t){switch(typeof t){case"number":if(!Number.isInteger(t))throw new Error("splits must be an integer: "+t);if(t<=0)throw new Error("splits must be at least 1: "+t);return t;case"undefined":return 10;default:throw new Error("Invalid splits: "+t)}}function p(t){switch(typeof t){case"number":if(!Number.isFinite(t))throw new Error("feePerKb must be finite: "+t);if(t<0)throw new Error("feePerKb must be non-negative: "+t);return t;case"undefined":return 500;default:throw new Error("Invalid feePerKb: "+t)}}function y(t,e){const n=new s(t);if(!n.outputs.length)return!1;if(n.outputs[0].script.chunks.length<6)return!1;const r=n.outputs[0].script.chunks;if("run"!==r[2].buf.toString("utf8"))return!1;const o=r[5].buf.toString("utf8");try{const t=JSON.parse(o);return e>=1&&e<=t.out.length}catch(t){return!1}}t.exports=class{constructor(t={}){this.blockchain=function(t){switch(typeof t){case"undefined":throw new Error("blockchain is required");case"object":if(t&&t.network)return t}throw new Error("Invalid blockchain: "+a(t))}(t.blockchain),this.Zc=l(t.splits),this.Qc=p(t.feePerKb),this.bsvPrivateKey=new o(t.privkey,c(this.blockchain.network)),this.bsvAddress=this.bsvPrivateKey.toAddress(),this.bsvScript=i.fromAddress(this.bsvAddress),this.privkey=this.bsvPrivateKey.toString(),this.address=this.bsvAddress.toString(),this.script=this.bsvScript.toHex()}get splits(){return this.Zc}set splits(t){this.Zc=l(t)}get feePerKb(){return this.Qc}set feePerKb(t){this.Qc=p(t)}async pay(t,e){const n=new s(t);n.feePerKb(this.feePerKb);const o=this.feePerKb/1e3;e.forEach(((t,e)=>{t&&(n.inputs[e].output=new s.Output({satoshis:t.satoshis,script:new i(t.script)}))}));const c=[];n.inputs.forEach(((t,e)=>{t.script.toBuffer().length||(c.push(e),t.setScript(r.deps.Buffer.alloc(500)))}));const a=0===n.outputs.length?546:0,l=n._getInputAmount(),p=n._getOutputAmount();if(l-p-a>=n.toBuffer().length*o){u.rt&&u.ot(f,"Transaction already paid for. Skipping.");const t=Math.ceil((34+n.toBuffer().length)*o);return l-p>546+t&&(n._fee=t,n.change(this.bsvAddress)),c.forEach((t=>n.inputs[t].setScript(""))),n.toString("hex")}let d=await this.blockchain.utxos(this.script);if(d=function(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}(d),!d.length){const t=`Hint: Have you funded the purse address ${this.address}?`;throw new Error("Not enough funds\n\n"+t)}const w=n.inputs.length;let g=n.toBuffer().length*o,b=g+p-l,_=0,m=1;g+=34*o,b+=34*o,b+=546;for(const t of d){if(y(await this.blockchain.fetch(t.txid),t.vout))continue;n.from(t),b-=t.satoshis,_++,g+=149*o,b+=149*o;const e=this.splits-d.length+_-m;for(let t=0;t<e;t++)g+=34*o,b+=34*o,b+=546,m++;if(b<0)break}if(g=Math.ceil(g),b=Math.ceil(b),b>0){throw new Error("Not enough funds\n\n"+`Required ${b} more satoshis`)}const E=-b-546*m,v=Math.ceil(E/m);for(let t=0;t<m;t++)t===m-1?(n._fee=g,n.change(this.bsvAddress)):n.to(this.bsvAddress,v);for(let t=w;t<n.inputs.length;t++){const e=n.inputs[t].output,r=h(n,t,e.script,e.satoshis,this.bsvPrivateKey),o=this.bsvPrivateKey.publicKey.toString(),s=i.fromASM(`${r} ${o}`);n.inputs[t].setScript(s)}const P=n._getInputAmount()-l-(n._getOutputAmount()-p);return u.rt&&u.ot(f,"Paid about",P,"satoshis"),c.forEach((t=>n.inputs[t].setScript(""))),n.toString("hex")}async balance(){return(await this.utxos()).reduce(((t,e)=>t+e.satoshis),0)}async utxos(){const t=await this.blockchain.utxos(this.script),e=await Promise.all(t.map((t=>this.blockchain.fetch(t.txid))));return t.filter(((t,n)=>!y(e[n],t.vout)))}}},function(t,e,n){const r=n(8),{Address:o,Script:i,Transaction:s}=r,c=n(3),{ki:a}=n(21),{h:u,Te:h}=n(1),{sha256:f}=r.crypto.Hash,l="Mockchain";t.exports=class{constructor(){this.network="mock",this.mempoolChainLimit=25,this.Xc=new Map,this.ta=new Map,this.ea=new Map,this.na=new Map,this.ra=new Map,this.oa=new Map}async broadcast(t){const e=new s(t),n=e.hash;if(this.Xc.has(n))return c.hn&&c.an(l,"Already have transaction",n),n;if(e.inputs.forEach(((t,e)=>{const n=`${t.prevTxId.toString("hex")}_o${t.outputIndex}`,r=this.na.get(n);if(!r){const t=this.ea.get(n),e=this.oa.has(t);throw new Error(e?"txn-mempool-conflict":"Missing inputs")}t.output=new s.Output(r)})),0===e.inputs.length)throw new Error("tx has no inputs");if(0===e.outputs.length)throw new Error("tx has no outputs");if(e.getFee()<e.toBuffer().length*s.FEE_PER_KB/1e3)throw new Error("insufficient priority");if(!0!==e.verify())throw new Error(e.verify());if(!0!==e.isFullySigned())throw new Error("mandatory-script-verify-flag-failed");for(let t=0;t<e.inputs.length;t++)if(!e.isValidSignature({inputIndex:t}))throw new Error("mandatory-script-verify-flag-failed");const o=e.inputs.map((t=>t.prevTxId.toString("hex"))).map((t=>this.oa.get(t)+1)).reduce(((t,e)=>Math.max(t,e)),0);if(o>h(this.mempoolChainLimit)){throw new Error("too-long-mempool-chain\n\n"+"Hint: Use run.blockchain.block() to produce blocks on the mockchain.")}return this.Xc.set(n,t),this.ta.set(n,Date.now()),this.oa.set(n,o),e.inputs.forEach(((t,e)=>{const o=t.prevTxId.toString("hex"),i=`${o}_o${t.outputIndex}`,s=this.Xc.get(o),c=new r.Transaction(s).outputs[t.outputIndex],a=f(c.script.toBuffer()).reverse().toString("hex");this.na.delete(i),this.ra.get(a).delete(i),this.ea.set(i,n)})),e.outputs.forEach(((t,e)=>{const r=`${n}_o${e}`;this.ea.set(r,null);const o={txid:n,vout:e,script:t.script.toHex(),satoshis:t.satoshis};this.na.set(r,o);const i=f(t.script.toBuffer()).reverse().toString("hex"),s=this.ra.get(i)||new Set;s.add(r),this.ra.set(i,s)})),n}async fetch(t){const e=this.Xc.get(t);if(!e)throw new Error("No such mempool or blockchain transaction: "+t);return e}async utxos(t){if("string"==typeof t)try{t=i.fromAddress(t)}catch(e){t=new i(t)}else if(t instanceof o)t=i.fromAddress(t);else if(!(t instanceof i))throw new Error("Invalid script: "+u(t));const e=a(t),n=this.ra.get(e);return n?Array.from(n).map((t=>this.na.get(t))):[]}async spends(t,e){const n=`${t}_o${e}`;if(!this.ea.has(n))throw new Error("location not found: "+n);return this.ea.get(n)}async time(t){const e=this.ta.get(t);if(!e)throw new Error("No such mempool or blockchain transaction: "+t);return e}fund(t,e){c.Jt&&c.Wt(l,"Fund",t.toString(),"with",e);const n=Math.random().toString(),r=(new s).addData(n).to(new o(t,"testnet"),e),a=r.hash,u=r.toString("hex");this.Xc.set(a,u),this.ta.set(a,Date.now()),this.oa.set(a,0);const h={txid:a,vout:1,script:r.outputs[1].script.toHex(),satoshis:r.outputs[1].satoshis},p=a+"_o1";this.na.set(p,h);const y=i.fromAddress(t),d=f(y.toBuffer()).reverse().toString("hex"),w=this.ra.get(d)||new Set;return w.add(p),this.ra.set(d,w),a}block(){c.rt&&c.ot(l,"Block"),this.oa.clear()}}},function(t,e,n){const r=n(8),o=n(20),{h:i}=n(1);t.exports=class{constructor(t){let e=null;try{e=new r.HDPublicKey(t)}catch(e){throw new Error("Invalid API key: "+i(t))}this.network="mainnet"===e.network.name||"livenet"===e.network.name?"main":"test",this.apiKey=t,this.timeout=5e3}async pay(t,e){const n={rawtx:t,parents:e,key:this.apiKey},r=`https://api.run.network/v1/${this.network}/pay`;return(await o.Ti(r,n,this.timeout)).rawtx}}},function(t,e,n){const{h:r}=n(1),{H:o}=n(10),i=n(8),{Script:s}=i,c=n(3);t.exports=class{constructor(t){this.lock=o(t),this.script=new s(i.deps.Buffer.from(this.lock.script()))}async sign(t,e,n){return c.hn&&c.an("Viewer","Viewer cannot sign ",r(this.lock)),t}nextOwner(){return this.lock}}},function(t,e,n){const Jig=n(2),Code=n(0);function expect(t){let e=!1;const n=t=>{if("object"!=typeof t||!t)return t;try{return JSON.stringify(t)}catch(e){return t.toString()}};function r(r,o,i){if(e?r:!r)throw new Error(i||`expected value${e?" not":""} to be ${o} but was ${n(t)}`)}function o(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if("object"!=typeof t)return!1;if(null===t||null===e)return!1;if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;if(Object.keys(t).length!==Object.keys(e).length)return!1;if(!Object.keys(t).every((n=>o(t[n],e[n]))))return!1;if(t instanceof Set){if(t.size!==e.size)return!1;if(!o(Array.from(t.entries()),Array.from(e.entries())))return!1}if(t instanceof Map){if(t.size!==e.size)return!1;if(!o(Array.from(t.entries()),Array.from(e.entries())))return!1}return!0}function i(t,e){if("function"!=typeof t)return!1;if("function"!=typeof e)return!1;for(;t;)if((t=Object.getPrototypeOf(t))===e)return!0;return!1}return{get not(){return e=!e,this},toBe:(e,o)=>r(t===e,""+n(e),o),toEqual:(e,i)=>r(o(t,e),"equal to "+n(e),i),toBeInstanceOf:(e,n)=>r(t&&t instanceof e,"an instance of "+(e&&e.name),n),toBeDefined:e=>r(void 0!==t,"defined",e),toBeNull:e=>r(null===t,"null",e),toBeNumber:e=>r("number"==typeof t,"a number",e),toBeInteger:e=>r(Number.isInteger(t),"an integer",e),toBeLessThan:(e,n)=>r(t<e&&"number"==typeof t&&"number"==typeof e,"less than "+e,n),toBeLessThanOrEqualTo:(e,n)=>r(t<=e&&"number"==typeof t&&"number"==typeof e,"less than or equal to "+e,n),toBeGreaterThan:(e,n)=>r(t>e&&"number"==typeof t&&"number"==typeof e,"greater than "+e,n),toBeGreaterThanOrEqualTo:(e,n)=>r(t>=e&&"number"==typeof t&&"number"==typeof e,"greater than or equal to "+e,n),toBeBoolean:e=>r("boolean"==typeof t,"a boolean",e),toBeString:e=>r("string"==typeof t,"a string",e),toBeObject:e=>r(t&&"object"==typeof t,"an object",e),toBeArray:e=>r(Array.isArray(t),"an array",e),toBeSet:e=>r(t instanceof Set,"a set",e),toBeMap:e=>r(t instanceof Map,"a map",e),toBeUint8Array:e=>r(t instanceof Uint8Array,"a uint8array",e),toBeClass:e=>r("function"==typeof t&&t.toString().startsWith("class"),"a class",e),toBeFunction:e=>r("function"==typeof t&&!t.toString().startsWith("class"),"a function",e),toBeJigClass:e=>r("function"==typeof t&&t.toString().startsWith("class")&&i(t,Jig),"a jig class",e),toExtendFrom:(e,n)=>r(i(t,e),"an extension of "+(e&&e.name),n)}}expect.deps={Jig},expect.toString(),t.exports=Code.kt(expect)},function(t,e,n){const Jig=n(2),Code=n(0);class Token extends Jig{init(...t){if(Object.getPrototypeOf(this.constructor)===Jig)throw new Error("Token must be extended");if(caller===this.constructor)return this.ia(caller.mintAmount),this.amount=caller.mintAmount,void(this.sender=null);if(caller&&caller.constructor===this.constructor)return this.ia(caller.sendAmount),this.amount=caller.sendAmount,this.owner=caller.sendOwner,void(this.sender=caller.owner);if(!Array.isArray(t)||t.length<2)throw new Error("Invalid tokens to combine");if(t.some((t=>t.constructor!==this.constructor)))throw new Error("Cannot combine different token classes");if(t.some((e=>(e=>t.reduce(((t,n)=>n===e?t+1:t),0))(e)>1)))throw new Error("Cannot combine duplicate tokens");this.amount=0,t.forEach((t=>{this.amount+=t.amount,t.destroy()})),this.sender=null,this.ia(this.amount)}static mint(t){this.mintAmount=t;const e=new this;return delete this.mintAmount,this.supply+=t,e}destroy(){super.destroy(),this.amount=0,this.sender=null}send(t,e=this.amount){if(this.ia(e),e>this.amount)throw new Error("Not enough funds");this.sendAmount=e,this.sendOwner=t;const n=new this.constructor;return delete this.sendAmount,delete this.sendOwner,this.amount===e?this.destroy():(this.amount-=e,this.sender=null),n}ia(t){if("number"!=typeof t)throw new Error("amount is not a number");if(!Number.isInteger(t))throw new Error("amount must be an integer");if(t<=0)throw new Error("amount must be positive");if(t>Number.MAX_SAFE_INTEGER)throw new Error("amount too large")}}Token.sealed=!1,Token.decimals=0,Token.icon={emoji:null},Token.symbol=null,Token.supply=0,Token.toString(),Token.presets={main:{location:"b17a9af70ab0f46809f908b2e900e395ba40996000bf4f00e3b27a1e93280cf1_o1",origin:"b17a9af70ab0f46809f908b2e900e395ba40996000bf4f00e3b27a1e93280cf1_o1",nonce:1,owner:"1PytriYokKN3GpKw84L4vvrGBwUvTYzCpx",satoshis:0},test:{location:"0bdf33a334a60909f4c8dab345500cbb313fbfd50b1d98120227eae092b81c39_o1",origin:"0bdf33a334a60909f4c8dab345500cbb313fbfd50b1d98120227eae092b81c39_o1",nonce:1,owner:"n3CiECgxW1pB1rGbYiX67e4U7AnS3MpJeE",satoshis:0}},t.exports=Code.kt(Token)}])}));