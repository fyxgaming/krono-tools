function _loadWasmModule(sync,filepath,src,imports){function _instantiateOrCompile(t,e,r){var n=r?WebAssembly.instantiateStreaming:WebAssembly.instantiate,i=r?WebAssembly.compileStreaming:WebAssembly.compile;return e?n(t,e):i(t)}var buf=null,isNode="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;if(filepath&&isNode){var fs=eval('require("fs")'),path=eval('require("path")');return new Promise(((t,e)=>{fs.readFile(path.resolve(__dirname,filepath),((r,n)=>{null!=r&&e(r),t(_instantiateOrCompile(n,imports,!1))}))}))}if(filepath)return _instantiateOrCompile(fetch(filepath),imports,!0);if(isNode)buf=Buffer.from(src,"base64");else{var raw=globalThis.atob(src),rawLength=raw.length;buf=new Uint8Array(new ArrayBuffer(rawLength));for(var i=0;i<rawLength;i++)buf[i]=raw.charCodeAt(i)}if(sync){var mod=new WebAssembly.Module(buf);return imports?new WebAssembly.Instance(mod,imports):mod}return _instantiateOrCompile(buf,imports,!1)}var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function i(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function u(t){t.parentNode.removeChild(t)}function c(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function l(){return h(" ")}function f(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function p(t){return function(e){return e.preventDefault(),t.call(this,e)}}function d(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function g(t,e){t.value=null==e?"":e}let y;function w(t){y=t}function m(){const t=function(){if(!y)throw new Error("Function called outside component initialization");return y}();return(e,r)=>{const n=t.$$.callbacks[e];if(n){const i=function(t,e){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,!1,!1,e),r}(e,r);n.slice().forEach((e=>{e.call(t,i)}))}}}const v=[],b=[],E=[],_=[],x=Promise.resolve();let A=!1;function S(t){E.push(t)}let P=!1;const T=new Set;function R(){if(!P){P=!0;do{for(let t=0;t<v.length;t+=1){const e=v[t];w(e),j(e.$$)}for(w(null),v.length=0;b.length;)b.pop()();for(let t=0;t<E.length;t+=1){const e=E[t];T.has(e)||(T.add(e),e())}E.length=0}while(v.length);for(;_.length;)_.pop()();A=!1,P=!1,T.clear()}}function j(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const C=new Set;function I(t,e){t&&t.i&&(C.delete(t),t.i(e))}function L(t,r,s){const{fragment:o,on_mount:a,on_destroy:u,after_update:c}=t.$$;o&&o.m(r,s),S((()=>{const r=a.map(e).filter(i);u?u.push(...r):n(r),t.$$.on_mount=[]})),c.forEach(S)}function U(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function O(t,e){-1===t.$$.dirty[0]&&(v.push(t),A||(A=!0,x.then(R)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function $(e,i,s,o,a,c,h=[-1]){const l=y;w(e);const f=i.props||{},p=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:r(),dirty:h,skip_bound:!1};let d=!1;if(p.ctx=s?s(e,f,((t,r,...n)=>{const i=n.length?n[0]:r;return p.ctx&&a(p.ctx[t],p.ctx[t]=i)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](i),d&&O(e,t)),r})):[],p.update(),d=!0,n(p.before_update),p.fragment=!!o&&o(p.ctx),i.target){if(i.hydrate){const t=function(t){return Array.from(t.childNodes)}(i.target);p.fragment&&p.fragment.l(t),t.forEach(u)}else p.fragment&&p.fragment.c();i.intro&&I(e.$$.fragment),L(e,i.target,i.anchor),R()}w(l)}class B{$destroy(){U(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function k(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var M=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function N(){}function D(){D.init.call(this)}function K(t){return void 0===t._maxListeners?D.defaultMaxListeners:t._maxListeners}function Y(t,e,r){if(e)t.call(r);else for(var n=t.length,i=V(t,n),s=0;s<n;++s)i[s].call(r)}function H(t,e,r,n){if(e)t.call(r,n);else for(var i=t.length,s=V(t,i),o=0;o<i;++o)s[o].call(r,n)}function q(t,e,r,n,i){if(e)t.call(r,n,i);else for(var s=t.length,o=V(t,s),a=0;a<s;++a)o[a].call(r,n,i)}function F(t,e,r,n,i,s){if(e)t.call(r,n,i,s);else for(var o=t.length,a=V(t,o),u=0;u<o;++u)a[u].call(r,n,i,s)}function J(t,e,r,n){if(e)t.apply(r,n);else for(var i=t.length,s=V(t,i),o=0;o<i;++o)s[o].apply(r,n)}function z(t,e,r,n){var i,s,o,a;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]):(s=t._events=new N,t._eventsCount=0),o){if("function"==typeof o?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),!o.warned&&(i=K(t))&&i>0&&o.length>i){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=o.length,a=u,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[e]=r,++t._eventsCount;return t}function W(t,e,r){var n=!1;function i(){t.removeListener(e,i),n||(n=!0,r.apply(t,arguments))}return i.listener=r,i}function G(t){var e=this._events;if(e){var r=e[t];if("function"==typeof r)return 1;if(r)return r.length}return 0}function V(t,e){for(var r=new Array(e);e--;)r[e]=t[e];return r}N.prototype=Object.create(null),D.EventEmitter=D,D.usingDomains=!1,D.prototype.domain=void 0,D.prototype._events=void 0,D.prototype._maxListeners=void 0,D.defaultMaxListeners=10,D.init=function(){this.domain=null,D.usingDomains&&undefined.active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new N,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},D.prototype.getMaxListeners=function(){return K(this)},D.prototype.emit=function(t){var e,r,n,i,s,o,a,u="error"===t;if(o=this._events)u=u&&null==o.error;else if(!u)return!1;if(a=this.domain,u){if(e=arguments[1],!a){if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(r=o[t]))return!1;var h="function"==typeof r;switch(n=arguments.length){case 1:Y(r,h,this);break;case 2:H(r,h,this,arguments[1]);break;case 3:q(r,h,this,arguments[1],arguments[2]);break;case 4:F(r,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),s=1;s<n;s++)i[s-1]=arguments[s];J(r,h,this,i)}return!0},D.prototype.addListener=function(t,e){return z(this,t,e,!1)},D.prototype.on=D.prototype.addListener,D.prototype.prependListener=function(t,e){return z(this,t,e,!0)},D.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,W(this,t,e)),this},D.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,W(this,t,e)),this},D.prototype.removeListener=function(t,e){var r,n,i,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[t]))return this;if(r===e||r.listener&&r.listener===e)0==--this._eventsCount?this._events=new N:(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!=typeof r){for(i=-1,s=r.length;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){o=r[s].listener,i=s;break}if(i<0)return this;if(1===r.length){if(r[0]=void 0,0==--this._eventsCount)return this._events=new N,this;delete n[t]}else!function(t,e){for(var r=e,n=r+1,i=t.length;n<i;r+=1,n+=1)t[r]=t[n];t.pop()}(r,i);n.removeListener&&this.emit("removeListener",t,o||e)}return this},D.prototype.removeAllListeners=function(t){var e,r;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=new N,this._eventsCount=0):r[t]&&(0==--this._eventsCount?this._events=new N:delete r[t]),this;if(0===arguments.length){for(var n,i=Object.keys(r),s=0;s<i.length;++s)"removeListener"!==(n=i[s])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new N,this._eventsCount=0,this}if("function"==typeof(e=r[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},D.prototype.listeners=function(t){var e,r=this._events;return r&&(e=r[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}(e):[]},D.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):G.call(t,e)},D.prototype.listenerCount=G,D.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var X="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Z=[],Q=[],tt="undefined"!=typeof Uint8Array?Uint8Array:Array,et=!1;function rt(){et=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=t.length;e<r;++e)Z[e]=t[e],Q[t.charCodeAt(e)]=e;Q["-".charCodeAt(0)]=62,Q["_".charCodeAt(0)]=63}function nt(t,e,r){for(var n,i,s=[],o=e;o<r;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(Z[(i=n)>>18&63]+Z[i>>12&63]+Z[i>>6&63]+Z[63&i]);return s.join("")}function it(t){var e;et||rt();for(var r=t.length,n=r%3,i="",s=[],o=16383,a=0,u=r-n;a<u;a+=o)s.push(nt(t,a,a+o>u?u:a+o));return 1===n?(e=t[r-1],i+=Z[e>>2],i+=Z[e<<4&63],i+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],i+=Z[e>>10],i+=Z[e>>4&63],i+=Z[e<<2&63],i+="="),s.push(i),s.join("")}function st(t,e,r,n,i){var s,o,a=8*i-n-1,u=(1<<a)-1,c=u>>1,h=-7,l=r?i-1:0,f=r?-1:1,p=t[e+l];for(l+=f,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+t[e+l],l+=f,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+t[e+l],l+=f,h-=8);if(0===s)s=1-c;else{if(s===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=c}return(p?-1:1)*o*Math.pow(2,s-n)}function ot(t,e,r,n,i,s){var o,a,u,c=8*s-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,d=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=h):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+l>=1?f/u:f*Math.pow(2,1-l))*u>=2&&(o++,u/=2),o+l>=h?(a=0,o=h):o+l>=1?(a=(e*u-1)*Math.pow(2,i),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;t[r+p]=255&o,p+=d,o/=256,c-=8);t[r+p-d]|=128*g}var at={}.toString,ut=Array.isArray||function(t){return"[object Array]"==at.call(t)};function ct(){return lt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function ht(t,e){if(ct()<e)throw new RangeError("Invalid typed array length");return lt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=lt.prototype:(null===t&&(t=new lt(e)),t.length=e),t}function lt(t,e,r){if(!(lt.TYPED_ARRAY_SUPPORT||this instanceof lt))return new lt(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return dt(this,t)}return ft(this,t,e,r)}function ft(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,n){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);lt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=lt.prototype:t=gt(t,e);return t}(t,e,r,n):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!lt.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|mt(e,r),i=(t=ht(t,n)).write(e,r);i!==n&&(t=t.slice(0,i));return t}(t,e,r):function(t,e){if(wt(e)){var r=0|yt(e.length);return 0===(t=ht(t,r)).length||e.copy(t,0,0,r),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?ht(t,0):gt(t,e);if("Buffer"===e.type&&ut(e.data))return gt(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function pt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function dt(t,e){if(pt(e),t=ht(t,e<0?0:0|yt(e)),!lt.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function gt(t,e){var r=e.length<0?0:0|yt(e.length);t=ht(t,r);for(var n=0;n<r;n+=1)t[n]=255&e[n];return t}function yt(t){if(t>=ct())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ct().toString(16)+" bytes");return 0|t}function wt(t){return!(null==t||!t._isBuffer)}function mt(t,e){if(wt(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Ft(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Jt(t).length;default:if(n)return Ft(t).length;e=(""+e).toLowerCase(),n=!0}}function vt(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Ot(this,e,r);case"utf8":case"utf-8":return Ct(this,e,r);case"ascii":return Lt(this,e,r);case"latin1":case"binary":return Ut(this,e,r);case"base64":return jt(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $t(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function bt(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function Et(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=lt.from(e,n)),wt(e))return 0===e.length?-1:_t(t,e,r,n,i);if("number"==typeof e)return e&=255,lt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):_t(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _t(t,e,r,n,i){var s,o=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,r/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var h=-1;for(s=r;s<a;s++)if(c(t,s)===c(e,-1===h?0:s-h)){if(-1===h&&(h=s),s-h+1===u)return h*o}else-1!==h&&(s-=s-h),h=-1}else for(r+u>a&&(r=a-u),s=r;s>=0;s--){for(var l=!0,f=0;f<u;f++)if(c(t,s+f)!==c(e,f)){l=!1;break}if(l)return s}return-1}function xt(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[r+o]=a}return o}function At(t,e,r,n){return zt(Ft(e,t.length-r),t,r,n)}function St(t,e,r,n){return zt(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function Pt(t,e,r,n){return St(t,e,r,n)}function Tt(t,e,r,n){return zt(Jt(e),t,r,n)}function Rt(t,e,r,n){return zt(function(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function jt(t,e,r){return 0===e&&r===t.length?it(t):it(t.slice(e,r))}function Ct(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,o,a,u,c=t[i],h=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=r)switch(l){case 1:c<128&&(h=c);break;case 2:128==(192&(s=t[i+1]))&&(u=(31&c)<<6|63&s)>127&&(h=u);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(u=(15&c)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(u=(15&c)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,l=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=l}return function(t){var e=t.length;if(e<=It)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=It));return r}(n)}lt.TYPED_ARRAY_SUPPORT=void 0===X.TYPED_ARRAY_SUPPORT||X.TYPED_ARRAY_SUPPORT,lt.poolSize=8192,lt._augment=function(t){return t.__proto__=lt.prototype,t},lt.from=function(t,e,r){return ft(null,t,e,r)},lt.TYPED_ARRAY_SUPPORT&&(lt.prototype.__proto__=Uint8Array.prototype,lt.__proto__=Uint8Array),lt.alloc=function(t,e,r){return function(t,e,r,n){return pt(e),e<=0?ht(t,e):void 0!==r?"string"==typeof n?ht(t,e).fill(r,n):ht(t,e).fill(r):ht(t,e)}(null,t,e,r)},lt.allocUnsafe=function(t){return dt(null,t)},lt.allocUnsafeSlow=function(t){return dt(null,t)},lt.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Wt(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Wt(t.slice(0,0))}(t))},lt.compare=function(t,e){if(!wt(t)||!wt(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},lt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},lt.concat=function(t,e){if(!ut(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return lt.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=lt.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(!wt(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},lt.byteLength=mt,lt.prototype._isBuffer=!0,lt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)bt(this,e,e+1);return this},lt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)bt(this,e,e+3),bt(this,e+1,e+2);return this},lt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)bt(this,e,e+7),bt(this,e+1,e+6),bt(this,e+2,e+5),bt(this,e+3,e+4);return this},lt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Ct(this,0,t):vt.apply(this,arguments)},lt.prototype.equals=function(t){if(!wt(t))throw new TypeError("Argument must be a Buffer");return this===t||0===lt.compare(this,t)},lt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},lt.prototype.compare=function(t,e,r,n,i){if(!wt(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(n,i),c=t.slice(e,r),h=0;h<a;++h)if(u[h]!==c[h]){s=u[h],o=c[h];break}return s<o?-1:o<s?1:0},lt.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},lt.prototype.indexOf=function(t,e,r){return Et(this,t,e,r,!0)},lt.prototype.lastIndexOf=function(t,e,r){return Et(this,t,e,r,!1)},lt.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return xt(this,t,e,r);case"utf8":case"utf-8":return At(this,t,e,r);case"ascii":return St(this,t,e,r);case"latin1":case"binary":return Pt(this,t,e,r);case"base64":return Tt(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},lt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var It=4096;function Lt(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function Ut(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function Ot(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=qt(t[s]);return i}function $t(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function Bt(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function kt(t,e,r,n,i,s){if(!wt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function Mt(t,e,r,n){e<0&&(e=65535+e+1);for(var i=0,s=Math.min(t.length-r,2);i<s;++i)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function Nt(t,e,r,n){e<0&&(e=4294967295+e+1);for(var i=0,s=Math.min(t.length-r,4);i<s;++i)t[r+i]=e>>>8*(n?i:3-i)&255}function Dt(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Kt(t,e,r,n,i){return i||Dt(t,0,r,4),ot(t,e,r,n,23,4),r+4}function Yt(t,e,r,n,i){return i||Dt(t,0,r,8),ot(t,e,r,n,52,8),r+8}lt.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),lt.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=lt.prototype;else{var i=e-t;r=new lt(i,void 0);for(var s=0;s<i;++s)r[s]=this[s+t]}return r},lt.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||Bt(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},lt.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||Bt(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},lt.prototype.readUInt8=function(t,e){return e||Bt(t,1,this.length),this[t]},lt.prototype.readUInt16LE=function(t,e){return e||Bt(t,2,this.length),this[t]|this[t+1]<<8},lt.prototype.readUInt16BE=function(t,e){return e||Bt(t,2,this.length),this[t]<<8|this[t+1]},lt.prototype.readUInt32LE=function(t,e){return e||Bt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},lt.prototype.readUInt32BE=function(t,e){return e||Bt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},lt.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||Bt(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},lt.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||Bt(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},lt.prototype.readInt8=function(t,e){return e||Bt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},lt.prototype.readInt16LE=function(t,e){e||Bt(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},lt.prototype.readInt16BE=function(t,e){e||Bt(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},lt.prototype.readInt32LE=function(t,e){return e||Bt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},lt.prototype.readInt32BE=function(t,e){return e||Bt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},lt.prototype.readFloatLE=function(t,e){return e||Bt(t,4,this.length),st(this,t,!0,23,4)},lt.prototype.readFloatBE=function(t,e){return e||Bt(t,4,this.length),st(this,t,!1,23,4)},lt.prototype.readDoubleLE=function(t,e){return e||Bt(t,8,this.length),st(this,t,!0,52,8)},lt.prototype.readDoubleBE=function(t,e){return e||Bt(t,8,this.length),st(this,t,!1,52,8)},lt.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||kt(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},lt.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e|=0,r|=0,n)||kt(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},lt.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,1,255,0),lt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},lt.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,2,65535,0),lt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Mt(this,t,e,!0),e+2},lt.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,2,65535,0),lt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Mt(this,t,e,!1),e+2},lt.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,4,4294967295,0),lt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Nt(this,t,e,!0),e+4},lt.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,4,4294967295,0),lt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Nt(this,t,e,!1),e+4},lt.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);kt(this,t,e,r,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},lt.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e|=0,!n){var i=Math.pow(2,8*r-1);kt(this,t,e,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},lt.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,1,127,-128),lt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},lt.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,2,32767,-32768),lt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Mt(this,t,e,!0),e+2},lt.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,2,32767,-32768),lt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Mt(this,t,e,!1),e+2},lt.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,4,2147483647,-2147483648),lt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Nt(this,t,e,!0),e+4},lt.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||kt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),lt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Nt(this,t,e,!1),e+4},lt.prototype.writeFloatLE=function(t,e,r){return Kt(this,t,e,!0,r)},lt.prototype.writeFloatBE=function(t,e,r){return Kt(this,t,e,!1,r)},lt.prototype.writeDoubleLE=function(t,e,r){return Yt(this,t,e,!0,r)},lt.prototype.writeDoubleBE=function(t,e,r){return Yt(this,t,e,!1,r)},lt.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,s=n-r;if(this===t&&r<e&&e<n)for(i=s-1;i>=0;--i)t[i+e]=this[i+r];else if(s<1e3||!lt.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},lt.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!lt.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=wt(t)?t:Ft(new lt(t,n).toString()),a=o.length;for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var Ht=/[^+\/0-9A-Za-z-_]/g;function qt(t){return t<16?"0"+t.toString(16):t.toString(16)}function Ft(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function Jt(t){return function(t){var e,r,n,i,s,o;et||rt();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new tt(3*a/4-s),n=s>0?a-4:a;var u=0;for(e=0,r=0;e<n;e+=4,r+=3)i=Q[t.charCodeAt(e)]<<18|Q[t.charCodeAt(e+1)]<<12|Q[t.charCodeAt(e+2)]<<6|Q[t.charCodeAt(e+3)],o[u++]=i>>16&255,o[u++]=i>>8&255,o[u++]=255&i;return 2===s?(i=Q[t.charCodeAt(e)]<<2|Q[t.charCodeAt(e+1)]>>4,o[u++]=255&i):1===s&&(i=Q[t.charCodeAt(e)]<<10|Q[t.charCodeAt(e+1)]<<4|Q[t.charCodeAt(e+2)]>>2,o[u++]=i>>8&255,o[u++]=255&i),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Ht,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function zt(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Wt(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}const Gt=lt.from("Bitcoin Signed Message:\n"),Vt=bsvjs.Bw.varIntBufNum(Gt.length);class Xt{constructor(t){this.from="",this.to=[],this.reply="",this.subject="",this.context=[],this.payload="",this.ts=Date.now(),Object.assign(this,t)}get hash(){const t=lt.concat([lt.from(this.to.join(":")),lt.from(this.reply||""),lt.from(this.subject),lt.from(this.context.join(":")),bsvjs.Bw.varIntBufNum(this.ts),lt.from(this.payload||"")]),e=lt.concat([Vt,Gt,bsvjs.Bw.varIntBufNum(t.length),t]);return bsvjs.Hash.sha256Sha256(e)}get id(){return this.hash.toString("hex")}get payloadObj(){return this.payload&&JSON.parse(this.payload)}sign(t){this.sig=bsvjs.Ecdsa.sign(this.hash,t).toString()}async verify(){return bsvjs.Ecdsa.asyncVerify(this.hash,bsvjs.Sig.fromString(this.sig),bsvjs.PubKey.fromString(this.from))}}class Zt extends D{constructor(t,e,r){super(),this.paymail=t,this.keyPair=e,this.timeouts=new Map,this.blockchain=r.blockchain,this.ownerPair=bsvjs.KeyPair.fromPrivKey(bsvjs.PrivKey.fromString(r.owner.privkey)),this.pursePair=bsvjs.KeyPair.fromPrivKey(bsvjs.PrivKey.fromString(r.purse.privkey)),this.pubkey=e.pubKey.toHex(),this.purse=r.purse.address,this.address=r.owner.address,this.balance=r.purse.balance.bind(r.purse),this.load=r.load.bind(r),this.createTransaction=()=>new Run.Transaction,this.loadTransaction=t=>r.import(t),this.getTxPayload=t=>r.payload(t),console.log("PAYMAIL: "+t),console.log("PUBKEY: "+e.pubKey.toString()),console.log("ADDRESS: "+this.address),console.log("PURSE: "+this.purse)}get now(){return Date.now()}async loadJigIndex(){return this.blockchain.jigIndex(this.address)}async loadJig(t){return await this.load(t).catch((e=>{if(!e.message.match(/not a/i))throw console.error("Load error:",t,e.message),e}))}async loadJigs(){const t=await this.loadJigIndex(),e=await Promise.all(t.map((t=>this.loadJig(t.location))));return console.log("JIGS:",e.length),e}buildMessage(t,e=!0){t.ts=Date.now(),t.from=this.keyPair.pubKey.toString();const r=new Xt(t);return e&&r.sign(this.keyPair),r}async signTx(t){return Promise.all(t.txIns.map((async(e,r)=>{const n=Buffer.from(e.txHashBuf).reverse().toString("hex"),i=bsvjs.Tx.fromHex(await this.blockchain.fetch(n)).txOuts[e.txOutNum];if(i.script.isPubKeyHashOut()){const n=bsvjs.Address.fromTxOutScript(i.script).toString();if(n===this.purse){const n=await t.asyncSign(this.pursePair,void 0,r,i.script,i.valueBn);e.setScript((new bsvjs.Script).writeBuffer(n.toTxFormat()).writeBuffer(this.pursePair.pubKey.toBuffer()))}else if(n===this.address){const n=await t.asyncSign(this.ownerPair,void 0,r,i.script,i.valueBn);e.setScript((new bsvjs.Script).writeBuffer(n.toTxFormat()).writeBuffer(this.ownerPair.pubKey.toBuffer()))}}return i})))}async encrypt(t){}async decrypt(t){}async verifySig(t,e,r){const n=await bsvjs.Hash.asyncSha256(Buffer.from(e)),i=bsvjs.Ecdsa.verify(n,bsvjs.Sig.fromString(t),bsvjs.PubKey.fromString(r));return console.log("SIG:",i,t,e,r),i}randomInt(t){return Math.floor(Math.random()*(t||Number.MAX_SAFE_INTEGER))}randomBytes(t){return bsvjs.Random.getRandomBuffer(t).toString("hex")}setTimeout(t,e){const r=Date.now();return this.timeouts.set(r,setTimeout((async()=>t().catch((t=>console.error("Timeout Error",t)))),e)),r}clearTimeout(t){this.timeouts.has(t)&&clearTimeout(this.timeouts.get(t))}}class Qt{constructor(t,e){this.maxBytes=t,this.maxEntries=e,this.cache=new Map,this.bytes=0}async set(t,e){let r;if("number"==typeof e)r={bytes:8,value:e};else if("string"==typeof e||e instanceof Uint8Array)r={bytes:e.length,value:e};else{const t=JSON.stringify(e);r={json:!0,bytes:t.length,value:t}}this.bytes+=r.bytes,this.cache.set(t,r);for(const t of Array.from(this.cache.keys())){if((!this.maxEntries||this.cache.size<=this.maxEntries)&&(!this.maxBytes||this.bytes<=this.maxBytes))break;const e=this.cache.get(t);this.bytes-=(null==e?void 0:e.bytes)||0,this.cache.delete(t)}}get(t){if(this.cache.has(t)){const e=this.cache.get(t);this.cache.delete(t),this.cache.set(t,e);return e.json?JSON.parse(e.value):e.value}}async delete(t){const e=this.cache.get(t);this.bytes-=(null==e?void 0:e.bytes)||0,this.cache.delete(t)}}function te(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}
/*!
     * depd
     * Copyright(c) 2015 Douglas Christopher Wilson
     * MIT Licensed
     */(null==e&&r.path)}},r.exports),r.exports}var ee=function(t){if(!t)throw new TypeError("argument namespace is required");function e(t){}return e._file=void 0,e._ignored=!0,e._namespace=t,e._traced=!1,e._warned=Object.create(null),e.function=re,e.property=ne,e};function re(t,e){if("function"!=typeof t)throw new TypeError("argument fn must be a function");return t}function ne(t,e,r){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(t,e);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable")}var ie=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){return t.__proto__=e,t}:function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(t,r)||(t[r]=e[r]);return t});var se,oe=(se=Object.freeze({__proto__:null,default:{100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"(Unused)",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}}))&&se.default||se,ae=ue;function ue(t){if("number"==typeof t){if(!ue[t])throw new Error("invalid status code: "+t);return t}if("string"!=typeof t)throw new TypeError("code must be a number or string");var e=parseInt(t,10);if(!isNaN(e)){if(!ue[e])throw new Error("invalid status code: "+e);return e}if(!(e=ue[t.toLowerCase()]))throw new Error('invalid status message: "'+t+'"');return e}ue.STATUS_CODES=oe,ue.codes=function(t,e){var r=[];return Object.keys(e).forEach((function(n){var i=e[n],s=Number(n);t[s]=i,t[i]=s,t[i.toLowerCase()]=s,r.push(s)})),r}(ue,oe),ue.redirect={300:!0,301:!0,302:!0,303:!0,305:!0,307:!0,308:!0},ue.empty={204:!0,205:!0,304:!0},ue.retry={502:!0,503:!0,504:!0};var ce=te((function(t){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}})),he=function(t){return t.split(" ").map((function(t){return t.slice(0,1).toUpperCase()+t.slice(1)})).join("").replace(/[^ _0-9a-z]/gi,"")};
/*!
     * toidentifier
     * Copyright(c) 2016 Douglas Christopher Wilson
     * MIT Licensed
     */var le=te((function(t){var e,r=ee("http-errors");function n(t){return Number(String(t).charAt(0)+"00")}function i(t,e){var r=Object.getOwnPropertyDescriptor(t,"name");r&&r.configurable&&(r.value=e,Object.defineProperty(t,"name",r))}function s(t){return"Error"!==t.substr(-5)?t+"Error":t}t.exports=function t(){for(var e,r,i=500,s={},o=0;o<arguments.length;o++){var a=arguments[o];if(a instanceof Error)i=(e=a).status||e.statusCode||i;else switch(typeof a){case"string":r=a;break;case"number":i=a;break;case"object":s=a}}("number"!=typeof i||!ae[i]&&(i<400||i>=600))&&(i=500);var u=t[i]||t[n(i)];e||(e=u?new u(r):new Error(r||ae[i]),Error.captureStackTrace(e,t));u&&e instanceof u&&e.status===i||(e.expose=i<500,e.status=e.statusCode=i);for(var c in s)"status"!==c&&"statusCode"!==c&&(e[c]=s[c]);return e},t.exports.HttpError=function(){function t(){throw new TypeError("cannot construct abstract class")}return ce(t,Error),t}(),t.exports.isHttpError=(e=t.exports.HttpError,function(t){return!(!t||"object"!=typeof t)&&(t instanceof e||t instanceof Error&&"boolean"==typeof t.expose&&"number"==typeof t.statusCode&&t.status===t.statusCode)}),function(t,e,o){e.forEach((function(e){var r,a=he(ae[e]);switch(n(e)){case 400:r=function(t,e,r){var n=s(e);function o(t){var e=null!=t?t:ae[r],i=new Error(e);return Error.captureStackTrace(i,o),ie(i,o.prototype),Object.defineProperty(i,"message",{enumerable:!0,configurable:!0,value:e,writable:!0}),Object.defineProperty(i,"name",{enumerable:!1,configurable:!0,value:n,writable:!0}),i}return ce(o,t),i(o,n),o.prototype.status=r,o.prototype.statusCode=r,o.prototype.expose=!0,o}(o,a,e);break;case 500:r=function(t,e,r){var n=s(e);function o(t){var e=null!=t?t:ae[r],i=new Error(e);return Error.captureStackTrace(i,o),ie(i,o.prototype),Object.defineProperty(i,"message",{enumerable:!0,configurable:!0,value:e,writable:!0}),Object.defineProperty(i,"name",{enumerable:!1,configurable:!0,value:n,writable:!0}),i}return ce(o,t),i(o,n),o.prototype.status=r,o.prototype.statusCode=r,o.prototype.expose=!1,o}(o,a,e)}r&&(t[e]=r,t[a]=r)})),t["I'mateapot"]=r.function(t.ImATeapot,'"I\'mateapot"; use "ImATeapot" instead')}(t.exports,ae.codes,t.exports.HttpError)}));class fe{constructor(t,e,r=new Qt(1e7),n=!1){this.apiUrl=t,this.network=e,this.cache=r,this.debug=n,this.requests=new Map}get bsvNetwork(){switch(this.network){case"stn":return"stn";case"main":return"mainnet";default:return"testnet"}}async broadcast(t){this.debug&&console.log("BROADCAST:",t);const e=await fetch(this.apiUrl+"/broadcast",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rawtx:t})});if(!e.ok)throw le(e.status,await e.text());const r=await e.text();return this.debug&&console.log("Broadcast:",r),await this.cache.set("tx://"+r,t),r}async populateInputs(t){await Promise.all(t.inputs.map((async t=>{const e=await this.fetch(t.prevTxId.toString("hex"));t.output=e.outputs[t.outputIndex]})))}async fetch(t){this.debug&&console.log("FETCH:",t);let e=await this.cache.get("tx://"+t);if(e)return e;if(!this.requests.has(t)){const r=Promise.resolve().then((async()=>{const r=await fetch(`${this.apiUrl}/tx/${t}`);if(!r.ok)throw le(r.status,await r.text());return e=await r.text(),await this.cache.set("tx://"+t,e),this.requests.delete(t),e}));this.requests.set(t,r)}return this.requests.get(t)}async time(t){return Date.now()}async spends(t,e){this.debug&&console.log("SPENDS:",t,e);const r=`spend://${t}_${e}`;let n=await this.cache.get(r);if(n)return n;if(!this.requests.has(r)){const i=(async()=>{const i=await fetch(`${this.apiUrl}/spends/${t}_o${e}`);if(!i.ok)throw le(i.status,await i.text());return n=await i.text()||null,n&&await this.cache.set(r,n),this.requests.delete(r),n})();this.requests.set(r,i)}return this.requests.get(r)}async utxos(t){this.debug&&console.log("UTXOS:",t);const e=await fetch(`${this.apiUrl}/utxos/${t}`);if(!e.ok)throw new Error(await e.text());return e.json()}async jigIndex(t){const e=await fetch(`${this.apiUrl}/jigs/address/${t}`);if(!e.ok)throw new Error(`${e.status} ${e.statusText}`);return e.json()}async loadJigData(t,e){const r=await fetch(`${this.apiUrl}/jigs/${t}${e&&"?unspent"}`);if(!r.ok)throw new Error(`${r.status} ${r.statusText}`);return r.json()}async kindHistory(t,e){const r=await fetch(`${this.apiUrl}/jigs/kind/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw le(r.status,await r.text());return r.json()}async originHistory(t,e){const r=await fetch(`${this.apiUrl}/jigs/origin/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw le(r.status,await r.text());return r.json()}async fund(t,e){const r=await fetch(`${this.apiUrl}/fund/${t}${e?"?satoshis="+e:""}`);if(!r.ok)throw le(r.status,await r.text());return r.text()}async loadMessage(t){const e=await fetch(`${this.apiUrl}/messages/${t}`);if(!e.ok)throw le(e.status,await e.text());return new Xt(await e.json())}async sendMessage(t,e){const r=e||this.apiUrl+"/messages";console.log("Post TO:",r);const n=await fetch(r,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw le(n.status,await n.text());return n.json()}}class pe{constructor(t,e=new Qt(1e7),r=!1){this.apiUrl=t,this.cache=e,this.debug=r,this.requests=new Map}async get(t){this.debug&&console.log("State:",t);let e=await this.cache.get(t);if(e)return this.debug&&console.log("Cache Hit:",t),e;if(!this.requests.has(t)){const r=(async()=>{const r=await fetch(`${this.apiUrl}/state/${encodeURIComponent(t)}`);if(!r.ok){if(404===r.status)return void(this.debug&&console.log("Remote Miss:",t));throw le(r.status,r.statusText)}return this.debug&&console.log("Remote Hit:",t),e=await r.json(),await this.cache.set(t,e),this.requests.delete(t),e})();this.requests.set(t,r)}return this.requests.get(t)}async set(t,e){await this.cache.set(t,e)}}class de{constructor(){this.store=new Map,this.expires=new Map}_expire(t){const e=this.expires.get(t);e&&e<Date.now()&&(this.store.delete(t),this.expires.delete(t))}get(t){return this._expire(t),this.store.get(t)}set(t,e){this.expires.delete(t),this.store.set(t,e)}del(t){this.expires.delete(t),this.store.delete(t)}hget(t,e){this._expire(t);const r=this.store.get(t);if(r)return r[e]}hset(t,e,r){this._expire(t),this.expires.delete(t);let n=this.store.get(t);n||(n={}),n[e]=r,this.store.set(t,n)}hmset(t,e){this._expire(t),this.expires.delete(t);const r=Object.assign(this.store.get(t)||{},e);this.store.set(t,r)}hdel(t,e){this._expire(t),this.expires.delete(t);const r=this.store.get(t);delete r[e],this.store.set(t,r)}hgetall(t){this._expire(t);const e=this.store.get(t)||{};return Object.assign({},e)}lindex(t,e){this._expire(t);const r=this.store.get(t);if(r)return r[e]}lrange(t,e,r){this._expire(t);return(this.store.get(t)||[]).slice(e,r+1)}lset(t,e,r){this._expire(t),this.expires.delete(t);let n=this.store.get(t)||[];n[e]=r,this.store.set(t,n)}rpush(t,...e){this._expire(t),this.expires.delete(t);let r=this.store.get(t)||[];r.push(...e),this.store.set(t,r)}exists(t){return this._expire(t),this.store.has(t)}expire(t,e){this.expires.set(t,1e3*e+Date.now())}ttl(t){if(this._expire(t),!this.store.has(t))return-2;const e=this.expires.get(t);return e?Math.floor((e-Date.now())/1e3):-1}}class ge{constructor(t,e,r){this.apiUrl=t,this.domain=e,this.network=r}async createKey(t,e){const r=await bsvjs.Hash.asyncSha256(Buffer.from(`${this.domain}|${t}`)),n=await bsvjs.Hash.asyncSha256(Buffer.from(e.normalize("NFKC"))),{hash:i}=await argon2.hash({pass:n,salt:r,time:100,mem:1024,hashLen:32});return Buffer.from(i)}async register(t,e,r){t=t.toLowerCase().normalize("NFKC");const n=await this.createKey(t,e),i="main"===this.network?bsvjs.Constants.Mainnet.PrivKey.versionByteNum:bsvjs.Constants.Testnet.PrivKey.versionByteNum,s=Buffer.concat([Buffer.from([i]),n,Buffer.from([1])]),o=(new bsvjs.PrivKey).fromBuffer(s),a=bsvjs.KeyPair.fromPrivKey(o),u=bsvjs.PubKey.fromPrivKey(o),c=bsvjs.Bip32.fromRandom(),h=await bsvjs.Ecies.asyncBitcoreEncrypt(Buffer.from(c.toString()),u,a),l={pubkey:u.toString(),xpub:c.toPublic().toString(),recovery:h.toString("base64"),email:r},f=Buffer.from(`${this.domain}|${t}|${l.xpub}|${l.recovery}|${r}`),p=await bsvjs.Hash.asyncSha256(f),d=bsvjs.Ecdsa.sign(p,a);l.sig=d.toString();const g=await fetch(`${this.apiUrl}/api/accounts/${t}@${this.domain}`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(l)});if(!g.ok)throw console.error(g.status,g.statusText),new Error("Registration Failed");return a}async login(t,e){t=t.toLowerCase().normalize("NFKC");const r=await this.createKey(t,e),n="main"===this.network?bsvjs.Constants.Mainnet.PrivKey.versionByteNum:bsvjs.Constants.Testnet.PrivKey.versionByteNum,i=Buffer.concat([Buffer.from([n]),r,Buffer.from([1])]),s=(new bsvjs.PrivKey).fromBuffer(i);return bsvjs.KeyPair.fromPrivKey(s)}async recover(t,e){const r=new Xt({from:e.pubKey.toString()});r.sign(e);const n=await fetch(`${this.apiUrl}/api/accounts/${encodeURIComponent(t)}/recover`,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(r)});if(!n.ok)throw new Error(`${n.status} - ${n.statusText}`);const i=await n.json();return bsvjs.Ecies.bitcoreDecrypt(Buffer.from(i,"base64"),e.privKey).toString()}async isHandleAvailable(t){t=t.toLowerCase();const e=`${this.apiUrl}/api/bsvalias/id/${encodeURIComponent(t)}@${this.domain}`;console.log("Requesting:",e);try{return 404===(await fetch(e)).status}catch(t){return console.error("Error Fetching",t.message),!1}}}const ye="testnet",we="",me="true";let ve={};const be=window.location.href.split("?");if(be[1]){const[t]=be[1].split("#");ve=function(t,e,r,n){e=e||"&",r=r||"=";var i={};if("string"!=typeof t||0===t.length)return i;var s=/\+/g;t=t.split(e);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var a=t.length;o>0&&a>o&&(a=o);for(var u=0;u<a;++u){var c,h,l,f,p=t[u].replace(s,"%20"),d=p.indexOf(r);d>=0?(c=p.substr(0,d),h=p.substr(d+1)):(c=p,h=""),l=decodeURIComponent(c),f=decodeURIComponent(h),k(i,l)?M(i[l])?i[l].push(f):i[l]=[i[l],f]:i[l]=f}return i}(t)}bsvjs.Constants.Default=bsvjs.Constants.Testnet,bsvjs.Constants.Default=bsvjs.Constants.Default,console.log("LOAD");class Ee extends D{constructor(){super(),this.printLog=console.log.bind(console),this.printError=console.error.bind(console),this.logId=0,this.logs=[],this.sessionId=`${Date.now()}-${Math.random()*Number.MAX_SAFE_INTEGER}`,this.timeLabels={},this.apiUrl=ve.apiUrl||we,this.domain=document.location.hash.slice(1).split("@")[1],this.overrideConsole(),this.auth=new ge(this.apiUrl,this.domain,ye)}get channel(){const t=window.vuplex;return t||window}get channelScope(){const t=document.referrer;return t&&!this.isInUnity?t.match(/^.+:\/\/[^\/]+/)[0]:null}get isInUnity(){return!!window.vuplex}get handle(){return window.localStorage.getItem("HANDLE")||""}set handle(t){window.localStorage.setItem("HANDLE",t)}get keyPair(){const t=window.localStorage.getItem("WIF");return t?bsvjs.KeyPair.fromPrivKey(bsvjs.PrivKey.fromString(t)):null}set keyPair(t){window.localStorage.setItem("WIF",t.privKey.toString())}get agentId(){return document.location.hash.slice(1).split("@")[0]}get paymail(){return`${this.handle}@${this.domain}`}async init(){console.log("INIT");let t=!1;for(;!t;){await new Promise((t=>setTimeout((()=>t()),5e3)));const e=await fetch(this.apiUrl+"/initialize");t=e.ok&&await e.json()}this.clientEmit("WALLET_READY"),this.channel.addEventListener("message",this.onClientEvent.bind(this)),console.log("BLOCKCHAIN:",this.apiUrl);const e=`${this.apiUrl}/agents/${this.domain}/${this.agentId}`;console.log("fetching:",e);const r=await fetch(e);if(!r.ok)throw new Error(`${r.status} - ${r.statusText}`);if(this.agentDef=await r.json(),!this.agentDef)throw new Error("AGENT MISSING");if(setInterval((async()=>{const t=this.logs;if(this.logs=[],!t.length)return;const e=await fetch(me,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok)throw new Error(`${e.status} - ${e.statusText}`)}),5e3),this.agentDef.anonymous)return this.initializeWallet();try{await this.initializeUser()}catch(t){console.error("Login Error:",t.message),this.clientEmit("NO_KEYS")}}async initializeWallet(t,e){const r=new Run.LocalCache({maxSizeMB:100}),n=new fe(this.apiUrl,ye,r),i=new Run({network:ye,owner:t,blockchain:n,purse:e,cache:new pe(this.apiUrl,r),app:"kronoverse",trust:"*",timeout:6e4,logger:{error:console.error}}),s=this.wallet=new Zt(this.paymail,this.keyPair,i),o=new de;this.keyPair.pubKey.toString();let a;console.log("DOMAIN:",this.domain),console.log("AGENT_ID:",this.agentId),console.log("LOC:",this.agentDef.location);const u=await i.load(this.agentDef.location),c=this.agent=new u(s,n,o,bsvjs,{fetch:fetch,Buffer:Buffer,ws:a,SignedMessage:Xt});c.on("client",this.clientEmit.bind(this)),c.on("subscribe",((t,e)=>{a.subscribe(t,e)})),c.on("unsubscribe",(t=>{a.unsubscribe(t)})),await c.init(),this.clientEmit("AGENT_LOADED"),a.on("jig",((t,e)=>{console.log("JIG:",JSON.stringify(t)),c.onJig(t).catch(console.error)})),a.on("msg",((t,e)=>{console.log("MSG:",JSON.stringify(t)),c.onMessage(new Xt(t)).catch(console.error)}))}async initializeUser(t){let e;console.log("Initializing User"),t&&(this.handle=t),e=bsvjs.Bip32.fromRandom(),this.keyPair=bsvjs.KeyPair.fromPrivKey(e.privKey),this.initializeWallet(e.derive("m/1/0").privKey.toString(),e.derive("m/0/0").privKey.toString())}async login(t,e){this.keyPair=await this.auth.login(t,e),await this.initializeUser(t)}async register(t,e,r){this.keyPair=await this.auth.register(t,e,r),await this.initializeUser(t)}async logout(){window.localStorage.removeItem("WIF"),window.localStorage.removeItem("HANDLE")}async onClientEvent(t){const e={};if(!this.tryParseMessageData(t.data,e))return;["Register","Login"].includes(e.name)?console.log("WALLET RECEIVED EVENT:",e.name):console.log("WALLET RECEIVED EVENT:",JSON.stringify(e));const r={name:"On"+e.name};try{const t=e.payload&&JSON.parse(e.payload);switch(e.name){case"Register":await this.register(t.handle,t.password,t.email);break;case"Login":await this.login(t.handle,t.password);break;case"Logout":await this.logout();break;case"Cashout":if(!this.wallet)throw new Error("Wallet not initialized");this.clientEmit("BalanceUpdated",0);break;case"IsHandleAvailable":r.payload=JSON.stringify(await this.auth.isHandleAvailable(t));break;default:if(!this.agent)throw new Error("Agent not initialized");const n=await this.agent.onEvent(e.name,t);r.payload=n&&JSON.stringify(n)}r.success=!0}catch(t){r.success=!1,r.payload=JSON.stringify(t.message),t.message.includes("Not enough funds")?r.statusCode=402:r.statusCode=t.status||500}console.log(r.name,r.payload),this.postMessage(r)}tryParseMessageData(t,e){const r=e||{};return"string"==typeof t?Object.assign(r,JSON.parse(Buffer.from(t,"base64").toString())):"object"==typeof t&&Object.assign(r,t),r&&r.name}clientEmit(t,e){const r={name:t,payload:e&&JSON.stringify(e),success:!0};this.logs.push({idx:this.logId++,sessionId:this.sessionId,handle:this.handle,type:"log",ts:Date.now(),message:{name:t,payload:e}}),this.postMessage(r)}postMessage(t){t.target="kronoverse",this.isInUnity?this.channel.postMessage(t):this.channelScope&&this.channel.parent.postMessage(t,this.channelScope)}overrideConsole(){console.log=(...t)=>{t.unshift(Date.now());const e=t.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"log",ts:Date.now(),message:e}),this.printLog(...t)},console.error=(...t)=>{t.unshift(Date.now());const e=t.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"error",ts:Date.now(),message:e}),this.printError(...t)},console.time=t=>{this.timeLabels[t]=Date.now()},console.timeEnd=t=>{console.log(`${t}: ${Date.now()-this.timeLabels[t]||0}ms`)}}}class _e{get wallet(){return walletService}}function xe(t){let e,r,i,s,h,y,w,m,v,b,E,_,x,A,S,P,T,R,j,C,I,L,U,O,$,B,k,M,N,D,K,Y,H,q,F,J,z,W,G,V,X,Z,Q,tt,et;return{c(){e=c("section"),r=c("h2"),r.textContent="Register",i=l(),s=c("form"),h=c("div"),y=c("label"),y.innerHTML='<span class="field-label svelte-1b5hwl4">Gamer Handle</span> \n                    <span class="field-hint svelte-1b5hwl4">Must contain 4+ characters.</span>',w=l(),m=c("input"),v=l(),b=c("div"),E=c("label"),E.innerHTML='<span class="field-label svelte-1b5hwl4">Password</span> \n                    <span class="field-hint svelte-1b5hwl4">Must contain 8+ characters with at\n                        least 1 number and 1 uppercase letter.</span>',_=l(),x=c("input"),A=l(),S=c("div"),P=c("label"),P.innerHTML='<span class="field-label svelte-1b5hwl4">Email</span> \n                    <span class="field-hint svelte-1b5hwl4"></span>',T=l(),R=c("input"),j=l(),C=c("div"),C.innerHTML='<button class="action svelte-1b5hwl4" type="submit">Register</button>',I=l(),L=c("p"),U=c("a"),U.textContent="Login",$=l(),B=c("section"),k=c("h2"),k.textContent="Login",M=l(),N=c("form"),D=c("div"),K=c("label"),K.innerHTML='<span class="field-label svelte-1b5hwl4">Gamer Handle</span> \n                    <span class="field-hint svelte-1b5hwl4">Must contain 4+ characters.</span>',Y=l(),H=c("input"),q=l(),F=c("div"),J=c("label"),J.innerHTML='<span class="field-label svelte-1b5hwl4">Password</span> \n                    <span class="field-hint svelte-1b5hwl4">Must contain 8+ characters with at\n                        least 1 number and 1 uppercase letter.</span>',z=l(),W=c("input"),G=l(),V=c("div"),V.innerHTML='<button class="action svelte-1b5hwl4" type="submit">Login</button>',X=l(),Z=c("p"),Q=c("a"),Q.textContent="Register",d(y,"for","rhandle"),d(m,"id","rhandle"),d(m,"class","field-cntrl svelte-1b5hwl4"),d(m,"placeholder","enter your gamer handle"),d(h,"class","field svelte-1b5hwl4"),d(E,"for","rpassword"),d(x,"id","rpassword"),d(x,"class","field svelte-1b5hwl4"),d(x,"placeholder","enter your password"),d(x,"type","password"),d(b,"class","field svelte-1b5hwl4"),d(P,"for","remail"),d(R,"id","remail"),d(R,"class","field svelte-1b5hwl4"),d(R,"placeholder","enter your email"),d(R,"type","email"),d(S,"class","field svelte-1b5hwl4"),d(C,"class","actions"),d(U,"href","/"),e.hidden=O=!t[1],d(K,"for","handle"),d(H,"id","handle"),d(H,"class","field-cntrl svelte-1b5hwl4"),d(H,"placeholder","enter your gamer handle"),d(D,"class","field svelte-1b5hwl4"),d(J,"for","password"),d(W,"id","password"),d(W,"class","field svelte-1b5hwl4"),d(W,"placeholder","enter your password"),d(W,"type","password"),d(F,"class","field svelte-1b5hwl4"),d(V,"class","actions"),d(Q,"href","/"),B.hidden=t[1]},m(n,u){a(n,e,u),o(e,r),o(e,i),o(e,s),o(s,h),o(h,y),o(h,w),o(h,m),g(m,t[2]),o(s,v),o(s,b),o(b,E),o(b,_),o(b,x),g(x,t[3]),o(s,A),o(s,S),o(S,P),o(S,T),o(S,R),g(R,t[4]),o(s,j),o(s,C),o(e,I),o(e,L),o(L,U),a(n,$,u),a(n,B,u),o(B,k),o(B,M),o(B,N),o(N,D),o(D,K),o(D,Y),o(D,H),g(H,t[2]),o(N,q),o(N,F),o(F,J),o(F,z),o(F,W),g(W,t[3]),o(N,G),o(N,V),o(B,X),o(B,Z),o(Z,Q),tt||(et=[f(m,"input",t[8]),f(x,"input",t[9]),f(R,"input",t[10]),f(s,"submit",p(t[5])),f(U,"click",p(t[11])),f(H,"input",t[12]),f(W,"input",t[13]),f(N,"submit",p(t[6])),f(Q,"click",p(t[14]))],tt=!0)},p(t,r){4&r&&m.value!==t[2]&&g(m,t[2]),8&r&&x.value!==t[3]&&g(x,t[3]),16&r&&R.value!==t[4]&&g(R,t[4]),2&r&&O!==(O=!t[1])&&(e.hidden=O),4&r&&H.value!==t[2]&&g(H,t[2]),8&r&&W.value!==t[3]&&g(W,t[3]),2&r&&(B.hidden=t[1])},d(t){t&&u(e),t&&u($),t&&u(B),tt=!1,n(et)}}}function Ae(e){let r,n,i,s,h;return{c(){r=c("section"),n=c("div"),i=c("button"),i.textContent="Logout",d(n,"class","actions")},m(t,u){a(t,r,u),o(r,n),o(n,i),s||(h=f(i,"click",e[7]),s=!0)},p:t,d(t){t&&u(r),s=!1,h()}}}function Se(e){let r;function n(t,e){return t[0]?Ae:xe}let i=n(e),s=i(e);return{c(){s.c(),r=h("")},m(t,e){s.m(t,e),a(t,r,e)},p(t,[e]){i===(i=n(t))&&s?s.p(t,e):(s.d(1),s=i(t),s&&(s.c(),s.m(r.parentNode,r)))},i:t,o:t,d(t){s.d(t),t&&u(r)}}}function Pe(t,e,r){var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function a(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}u((n=n.apply(t,e||[])).next())}))};const i=new _e,s=m();let o,a,u,{loggedIn:c}=e,h=!1;const l=()=>{s("statusChanged",{loggedIn:c})};return t.$$set=t=>{"loggedIn"in t&&r(0,c=t.loggedIn)},[c,h,o,a,u,()=>n(void 0,void 0,void 0,(function*(){console.log("register"),yield i.wallet.register(o,a,u),r(0,c=!0),l()})),()=>n(void 0,void 0,void 0,(function*(){console.log("login"),yield i.wallet.login(o,a),r(0,c=!0),l()})),()=>{console.log("logout"),i.wallet.logout(),r(0,c=!1),l()},function(){o=this.value,r(2,o)},function(){a=this.value,r(3,a)},function(){u=this.value,r(4,u)},()=>r(1,h=!1),function(){o=this.value,r(2,o)},function(){a=this.value,r(3,a)},()=>r(1,h=!0)]}class Te extends B{constructor(t){super(),$(this,t,Pe,Se,s,{loggedIn:0})}}function Re(t){let e,r,n,i,s,f,p,g;return p=new Te({props:{loggedIn:t[1]}}),p.$on("statusChanged:{changed}",t[2]),{c(){var o;e=c("main"),r=c("h1"),n=h("Hello "),i=h(t[0]),s=h("!"),f=l(),(o=p.$$.fragment)&&o.c(),d(r,"class","svelte-1ykrvfv"),d(e,"class","svelte-1ykrvfv")},m(t,u){a(t,e,u),o(e,r),o(r,n),o(r,i),o(r,s),o(e,f),L(p,e,null),g=!0},p(t,[e]){(!g||1&e)&&function(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}(i,t[0])},i(t){g||(I(p.$$.fragment,t),g=!0)},o(t){!function(t,e,r,n){if(t&&t.o){if(C.has(t))return;C.add(t),(void 0).c.push((()=>{C.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}}(p.$$.fragment,t),g=!1},d(t){t&&u(e),U(p)}}}function je(t,e,r){(new Ee).init();let{name:n}=e;return t.$$set=t=>{"name"in t&&r(0,n=t.name)},[n,undefined,function(e){!function(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach((t=>t(e)))}(t,e)}]}return new class extends B{constructor(t){super(),$(this,t,je,Re,s,{name:0})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
