!function(e){function t(t){for(var o,a,r=t[0],l=t[1],c=t[2],g=0,d=[];g<r.length;g++)a=r[g],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(h&&h(t);d.length;)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,r=1;r<n.length;r++){var l=n[r];0!==i[l]&&(o=!1)}o&&(s.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={0:0},s=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/wallet";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var h=l;s.push([63,1,4,2,3,5]),n()}({101:function(e,t){},103:function(e,t){},29:function(e,t){e.exports=fetch},57:function(e,t){e.exports=Run},63:function(e,t,n){e.exports=n(64)},64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(65);function i(){Array.from(document.getElementsByClassName("panel")).forEach(e=>e.style.display="none")}document.addEventListener("DOMContentLoaded",async e=>{var t,n;console.log("LOADED");const s=new o.WalletService;s.on("show",e=>{console.log("SHOW:",e),function(e){i();const t=document.getElementById(e);t&&(t.style.display="block")}(e)}),s.on("hide",e=>{i()});try{await s.init()}catch(e){console.log(e)}null===(t=document.getElementById("login-btn"))||void 0===t||t.addEventListener("click",e=>{var t,n;const o=null===(t=document.getElementById("l-handle"))||void 0===t?void 0:t.value,i=null===(n=document.getElementById("l-password"))||void 0===n?void 0:n.value;s.login(o,i)}),null===(n=document.getElementById("register-btn"))||void 0===n||n.addEventListener("click",e=>{var t,n,o;const i=null===(t=document.getElementById("r-handle"))||void 0===t?void 0:t.value,a=null===(n=document.getElementById("r-email"))||void 0===n?void 0:n.value,r=null===(o=document.getElementById("r-password"))||void 0===o?void 0:o.value;s.register(i,r,a)});const a=document.createElement("h1");document.body.appendChild(a)})},65:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WalletService=void 0;const o=n(16),i=n(115),s=n(116),a=n(119),r=n(120),l=n(127),c=n(128),h=n(21),g=n(129),d=n(7),u=n(133),f=n(57);let p={};const m=window.location.href.split("?");if(m[1]){const[e]=m[1].split("#");p=s.decode(e)}o.Constants.Default="main"===i.config.network?o.Constants.Mainnet:o.Constants.Testnet;const y=n(16);y.Constants.Default=o.Constants.Default,console.log("LOAD");class w extends d.EventEmitter{constructor(){super(),this.printLog=console.log.bind(console),this.printError=console.error.bind(console),this.logId=0,this.logs=[],this.sessionId=`${Date.now()}-${Math.random()*Number.MAX_SAFE_INTEGER}`,this.timeLabels={},this.apiUrl=p.apiUrl||i.config.apiUrl,this.domain=document.location.hash.slice(1).split("@")[1],this.overrideConsole(),this.auth=new g.KronoAuth(this.apiUrl,this.domain,i.config.network)}get channel(){const e=window.vuplex;return e||window}get channelScope(){const e=document.referrer;return e&&!this.isInUnity?e.match(/^.+:\/\/[^\/]+/)[0]:null}get isInUnity(){return!!window.vuplex}get handle(){return window.localStorage.getItem("HANDLE")||""}set handle(e){window.localStorage.setItem("HANDLE",e)}get keyPair(){const e=window.localStorage.getItem("WIF");return e?o.KeyPair.fromPrivKey(o.PrivKey.fromString(e)):null}set keyPair(e){window.localStorage.setItem("WIF",e.privKey.toString())}get agentId(){return document.location.hash.slice(1).split("@")[0]}get paymail(){return`${this.handle}@${this.domain}`}async init(){console.log("INIT");let e=!1;for(;i.config.ephemeral&&!e;){await new Promise(e=>setTimeout(()=>e(),5e3));const t=await fetch(this.apiUrl+"/initialize");e=t.ok&&await t.json()}this.clientEmit("WALLET_READY"),this.channel.addEventListener("message",this.onClientEvent.bind(this)),console.log("BLOCKCHAIN:",this.apiUrl);const t=`${this.apiUrl}/agents/${this.domain}/${this.agentId}`;console.log("fetching:",t);const n=await fetch(t);if(!n.ok)throw new Error(`${n.status} - ${n.statusText}`);if(this.agentDef=await n.json(),!this.agentDef)throw new Error("AGENT MISSING");if(i.config.errorLog&&setInterval(async()=>{const e=this.logs;if(this.logs=[],!e.length)return;const t=await fetch(i.config.errorLog,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`${t.status} - ${t.statusText}`)},5e3),this.agentDef.anonymous)return this.initializeWallet();if(!i.config.ephemeral&&!this.keyPair)return this.clientEmit("NO_KEYS");try{await this.initializeUser()}catch(e){console.error("Login Error:",e.message),this.clientEmit("NO_KEYS")}}async initializeWallet(t,n){const o=new f.LocalCache({maxSizeMB:100}),s=new r.RestBlockchain(this.apiUrl,i.config.network,o),g=new f({network:i.config.network,owner:t,blockchain:s,purse:n,cache:new l.RestStateCache(this.apiUrl,o),app:i.config.app||"kronoverse",trust:"*",timeout:6e4,logger:{error:console.error}}),d=this.wallet=new a.Wallet(this.paymail,this.keyPair,g),p=new c.IORedisMock,m=[this.keyPair.pubKey.toString()];let w;i.config.ephemeral&&m.push(g.owner.address),i.config.sockets&&(console.log("Sockets:",i.config.sockets),w=new u.WSClient(WebSocket,i.config.sockets,m)),console.log("DOMAIN:",this.domain),console.log("AGENT_ID:",this.agentId),console.log("LOC:",this.agentDef.location);const v=await g.load(this.agentDef.location),E=this.agent=new v(d,s,p,y,{fetch:fetch,Buffer:e,ws:w,SignedMessage:h.SignedMessage});E.on("client",this.clientEmit.bind(this)),E.on("subscribe",(e,t)=>{w.subscribe(e,t)}),E.on("unsubscribe",e=>{w.unsubscribe(e)}),await E.init(),this.clientEmit("AGENT_LOADED"),w.on("jig",(e,t)=>{console.log("JIG:",JSON.stringify(e)),E.onJig(e).catch(console.error)}),w.on("msg",(e,t)=>{console.log("MSG:",JSON.stringify(e)),E.onMessage(new h.SignedMessage(e)).catch(console.error)})}async initializeUser(e){let t;if(console.log("Initializing User"),e&&(this.handle=e),i.config.ephemeral)t=o.Bip32.fromRandom(),this.keyPair=o.KeyPair.fromPrivKey(t.privKey);else{console.log("Recovering account");const e=await this.auth.recover(this.paymail,this.keyPair);t=o.Bip32.fromString(e)}this.initializeWallet(t.derive("m/1/0").privKey.toString(),t.derive("m/0/0").privKey.toString())}async login(e,t){this.keyPair=await this.auth.login(e,t),await this.initializeUser(e)}async register(e,t,n){this.keyPair=await this.auth.register(e,t,n),await this.initializeUser(e)}async logout(){window.localStorage.removeItem("WIF"),window.localStorage.removeItem("HANDLE")}async onClientEvent(e){var t;const n={};if(!this.tryParseMessageData(e.data,n))return;["Register","Login"].includes(n.name)?console.log("WALLET RECEIVED EVENT:",n.name):console.log("WALLET RECEIVED EVENT:",JSON.stringify(n));const o={name:"On"+n.name};try{const e=n.payload&&JSON.parse(n.payload);switch(n.name){case"Register":await this.register(e.handle,e.password,e.email);break;case"Login":await this.login(e.handle,e.password);break;case"Logout":await this.logout();break;case"Cashout":if(!this.wallet)throw new Error("Wallet not initialized");this.clientEmit("BalanceUpdated",0);break;case"IsHandleAvailable":o.payload=JSON.stringify(await this.auth.isHandleAvailable(e));break;default:if(!this.agent)throw new Error("Agent not initialized");const i=await(null===(t=this.agent)||void 0===t?void 0:t.onEvent(n.name,e));o.payload=i&&JSON.stringify(i)}o.success=!0}catch(e){o.success=!1,o.payload=JSON.stringify(e.message),e.message.includes("Not enough funds")?o.statusCode=402:o.statusCode=e.status||500}console.log(o.name,o.payload),this.postMessage(o)}tryParseMessageData(t,n){const o=n||{};return"string"==typeof t?Object.assign(o,JSON.parse(e.from(t,"base64").toString())):"object"==typeof t&&Object.assign(o,t),o&&o.name}clientEmit(e,t){const n={name:e,payload:t&&JSON.stringify(t),success:!0};this.logs.push({idx:this.logId++,sessionId:this.sessionId,handle:this.handle,type:"log",ts:Date.now(),message:{name:e,payload:t}}),this.postMessage(n)}postMessage(e){e.target="kronoverse",this.isInUnity?this.channel.postMessage(e):this.channelScope&&this.channel.parent.postMessage(e,this.channelScope)}overrideConsole(){console.log=(...e)=>{e.unshift(Date.now());const t=e.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"log",ts:Date.now(),message:t}),i.config.emitLogs&&this.clientEmit("Log",t),this.printLog(...e)},console.error=(...e)=>{e.unshift(Date.now());const t=e.join(" ");this.logs.push({idx:this.logId++,sessionId:this.sessionId,paymail:this.paymail,type:"error",ts:Date.now(),message:t}),i.config.emitLogs&&this.clientEmit("Error",t),this.printError(...e)},console.time=e=>{this.timeLabels[e]=Date.now()},console.timeEnd=e=>{console.log(`${e}: ${Date.now()-this.timeLabels[e]||0}ms`)}}}t.WalletService=w}).call(this,n(3).Buffer)},68:function(e,t){},71:function(e,t){},72:function(e,t){},88:function(e,t){},90:function(e,t){}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiZmV0Y2hcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJSdW5cIiIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3NlcnZpY2VzL3dhbGxldC1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbIndlYnBhY2tKc29ucENhbGxiYWNrIiwiZGF0YSIsIm1vZHVsZUlkIiwiY2h1bmtJZCIsImNodW5rSWRzIiwibW9yZU1vZHVsZXMiLCJleGVjdXRlTW9kdWxlcyIsImkiLCJyZXNvbHZlcyIsImxlbmd0aCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImluc3RhbGxlZENodW5rcyIsInB1c2giLCJtb2R1bGVzIiwicGFyZW50SnNvbnBGdW5jdGlvbiIsInNoaWZ0IiwiZGVmZXJyZWRNb2R1bGVzIiwiYXBwbHkiLCJjaGVja0RlZmVycmVkTW9kdWxlcyIsInJlc3VsdCIsImRlZmVycmVkTW9kdWxlIiwiZnVsZmlsbGVkIiwiaiIsImRlcElkIiwic3BsaWNlIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsInMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiMCIsImV4cG9ydHMiLCJtb2R1bGUiLCJsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInAiLCJqc29ucEFycmF5Iiwid2luZG93Iiwib2xkSnNvbnBGdW5jdGlvbiIsInNsaWNlIiwiZmV0Y2giLCJSdW4iLCJ3YWxsZXRfc2VydmljZV8xIiwiaGlkZSIsIkFycmF5IiwiZnJvbSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImZvckVhY2giLCJzdHlsZSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwiYXN5bmMiLCJldmVudCIsIl9hIiwiX2IiLCJjb25zb2xlIiwibG9nIiwid2FsbGV0IiwiV2FsbGV0U2VydmljZSIsIm9uIiwicGFuZWwiLCJwYW5lbEVsZW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInNob3ciLCJpbml0IiwiZXJyIiwiZSIsImhhbmRsZSIsInBhc3N3b3JkIiwibG9naW4iLCJfYyIsImVtYWlsIiwicmVnaXN0ZXIiLCJlbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsImJvZHkiLCJhcHBlbmRDaGlsZCIsImJzdl8xIiwibm9kZV9jb25maWdfdHNfMSIsInF1ZXJ5c3RyaW5nIiwid2FsbGV0XzEiLCJyZXN0X2Jsb2NrY2hhaW5fMSIsInJlc3Rfc3RhdGVfY2FjaGVfMSIsImlvcmVkaXNfbW9ja18xIiwic2lnbmVkX21lc3NhZ2VfMSIsImF1dGhfMSIsImV2ZW50c18xIiwid3NfY2xpZW50XzEiLCJxdWVyeVBhcmFtcyIsInVybFBhcnRzIiwibG9jYXRpb24iLCJocmVmIiwic3BsaXQiLCJxdWVyeSIsImRlY29kZSIsIkNvbnN0YW50cyIsIkRlZmF1bHQiLCJjb25maWciLCJuZXR3b3JrIiwiTWFpbm5ldCIsIlRlc3RuZXQiLCJic3YiLCJFdmVudEVtaXR0ZXIiLCJzdXBlciIsInRoaXMiLCJwcmludExvZyIsInByaW50RXJyb3IiLCJlcnJvciIsImxvZ0lkIiwibG9ncyIsInNlc3Npb25JZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwiTnVtYmVyIiwiTUFYX1NBRkVfSU5URUdFUiIsInRpbWVMYWJlbHMiLCJhcGlVcmwiLCJkb21haW4iLCJoYXNoIiwib3ZlcnJpZGVDb25zb2xlIiwiYXV0aCIsIktyb25vQXV0aCIsInYiLCJ2dXBsZXgiLCJyZWYiLCJyZWZlcnJlciIsImlzSW5Vbml0eSIsIm1hdGNoIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNldEl0ZW0iLCJ3aWYiLCJLZXlQYWlyIiwiZnJvbVByaXZLZXkiLCJQcml2S2V5IiwiZnJvbVN0cmluZyIsImtleVBhaXIiLCJwcml2S2V5IiwidG9TdHJpbmciLCJpbml0aWFsaXplZCIsImVwaGVtZXJhbCIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsInJlc3AiLCJvayIsImpzb24iLCJjbGllbnRFbWl0IiwiY2hhbm5lbCIsIm9uQ2xpZW50RXZlbnQiLCJ1cmwiLCJhZ2VudElkIiwiRXJyb3IiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiYWdlbnREZWYiLCJlcnJvckxvZyIsInNldEludGVydmFsIiwibWV0aG9kIiwiaGVhZGVycyIsIkpTT04iLCJzdHJpbmdpZnkiLCJhbm9ueW1vdXMiLCJpbml0aWFsaXplV2FsbGV0IiwiaW5pdGlhbGl6ZVVzZXIiLCJtZXNzYWdlIiwib3duZXIiLCJwdXJzZSIsImNhY2hlIiwiTG9jYWxDYWNoZSIsIm1heFNpemVNQiIsImJsb2NrY2hhaW4iLCJSZXN0QmxvY2tjaGFpbiIsInJ1biIsIlJlc3RTdGF0ZUNhY2hlIiwiYXBwIiwidHJ1c3QiLCJ0aW1lb3V0IiwibG9nZ2VyIiwiV2FsbGV0IiwicGF5bWFpbCIsInN0b3JhZ2UiLCJJT1JlZGlzTW9jayIsImNoYW5uZWxzIiwicHViS2V5Iiwid3MiLCJhZGRyZXNzIiwic29ja2V0cyIsIldTQ2xpZW50IiwiV2ViU29ja2V0IiwiQWdlbnQiLCJsb2FkIiwiYWdlbnQiLCJCdWZmZXIiLCJTaWduZWRNZXNzYWdlIiwibGFzdElkIiwic3Vic2NyaWJlIiwidW5zdWJzY3JpYmUiLCJqaWciLCJvbkppZyIsImNhdGNoIiwib25NZXNzYWdlIiwiYmlwMzIiLCJCaXAzMiIsImZyb21SYW5kb20iLCJ4cHJpdiIsInJlY292ZXIiLCJkZXJpdmUiLCJyZW1vdmVJdGVtIiwidHJ5UGFyc2VNZXNzYWdlRGF0YSIsImluY2x1ZGVzIiwicmVzcG9uc2UiLCJwYXlsb2FkIiwicGFyc2UiLCJsb2dvdXQiLCJpc0hhbmRsZUF2YWlsYWJsZSIsIm9uRXZlbnQiLCJzdWNjZXNzIiwic3RhdHVzQ29kZSIsInBvc3RNZXNzYWdlIiwib3V0QnlSZWYiLCJhc3NpZ24iLCJpZHgiLCJ0eXBlIiwidHMiLCJ0YXJnZXQiLCJjaGFubmVsU2NvcGUiLCJwYXJlbnQiLCJtZXNzYWdlcyIsInVuc2hpZnQiLCJqb2luIiwiZW1pdExvZ3MiLCJ0aW1lIiwibGFiZWwiLCJ0aW1lRW5kIl0sIm1hcHBpbmdzIjoiYUFDRSxTQUFTQSxFQUFxQkMsR0FRN0IsSUFQQSxJQU1JQyxFQUFVQyxFQU5WQyxFQUFXSCxFQUFLLEdBQ2hCSSxFQUFjSixFQUFLLEdBQ25CSyxFQUFpQkwsRUFBSyxHQUlITSxFQUFJLEVBQUdDLEVBQVcsR0FDcENELEVBQUlILEVBQVNLLE9BQVFGLElBQ3pCSixFQUFVQyxFQUFTRyxHQUNoQkcsT0FBT0MsVUFBVUMsZUFBZUMsS0FBS0MsRUFBaUJYLElBQVlXLEVBQWdCWCxJQUNwRkssRUFBU08sS0FBS0QsRUFBZ0JYLEdBQVMsSUFFeENXLEVBQWdCWCxHQUFXLEVBRTVCLElBQUlELEtBQVlHLEVBQ1pLLE9BQU9DLFVBQVVDLGVBQWVDLEtBQUtSLEVBQWFILEtBQ3BEYyxFQUFRZCxHQUFZRyxFQUFZSCxJQUtsQyxJQUZHZSxHQUFxQkEsRUFBb0JoQixHQUV0Q08sRUFBU0MsUUFDZEQsRUFBU1UsT0FBVFYsR0FPRCxPQUhBVyxFQUFnQkosS0FBS0ssTUFBTUQsRUFBaUJiLEdBQWtCLElBR3ZEZSxJQUVSLFNBQVNBLElBRVIsSUFEQSxJQUFJQyxFQUNJZixFQUFJLEVBQUdBLEVBQUlZLEVBQWdCVixPQUFRRixJQUFLLENBRy9DLElBRkEsSUFBSWdCLEVBQWlCSixFQUFnQlosR0FDakNpQixHQUFZLEVBQ1JDLEVBQUksRUFBR0EsRUFBSUYsRUFBZWQsT0FBUWdCLElBQUssQ0FDOUMsSUFBSUMsRUFBUUgsRUFBZUUsR0FDRyxJQUEzQlgsRUFBZ0JZLEtBQWNGLEdBQVksR0FFM0NBLElBQ0ZMLEVBQWdCUSxPQUFPcEIsSUFB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LEVBQVUrRCxFQUFTRSxLQUFLLEtBQzlCaEksS0FBS0ssS0FBS3RILEtBQUssQ0FDWHlPLElBQUt4SCxLQUFLSSxRQUNWRSxVQUFXTixLQUFLTSxVQUNoQndFLFFBQVM5RSxLQUFLOEUsUUFDZDJDLEtBQU0sTUFDTkMsR0FBSW5ILEtBQUtDLE1BQ1R1RCxZQUVBekYsRUFBaUJtQixPQUFPd0ksVUFDeEJqSSxLQUFLNkMsV0FBVyxNQUFPa0IsR0FDM0IvRCxLQUFLQyxZQUFZNkgsSUFFckIvSyxRQUFRb0QsTUFBUSxJQUFJMkgsS0FDaEJBLEVBQVNDLFFBQVF4SCxLQUFLQyxPQUN0QixNQUFNdUQsRUFBVStELEVBQVNFLEtBQUssS0FDOUJoSSxLQUFLSyxLQUFLdEgsS0FBSyxDQUNYeU8sSUFBS3hILEtBQUtJLFFBQ1ZFLFVBQVdOLEtBQUtNLFVBQ2hCd0UsUUFBUzlFLEtBQUs4RSxRQUNkMkMsS0FBTSxRQUNOQyxHQUFJbkgsS0FBS0MsTUFDVHVELFlBRUF6RixFQUFpQm1CLE9BQU93SSxVQUN4QmpJLEtBQUs2QyxXQUFXLFFBQVNrQixHQUM3Qi9ELEtBQUtFLGNBQWM0SCxJQUV2Qi9LLFFBQVFtTCxLQUFRQyxJQUNabkksS0FBS2EsV0FBV3NILEdBQVM1SCxLQUFLQyxPQUVsQ3pELFFBQVFxTCxRQUFXRCxJQUNmcEwsUUFBUUMsSUFBSSxHQUFHbUwsTUFBVTVILEtBQUtDLE1BQVFSLEtBQUthLFdBQVdzSCxJQUFVLFNBSTVFbk8sRUFBUWtELGNBQWdCQSxJIiwiZmlsZSI6ImFwcH5lMmU5MzU5Mi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIGluc3RhbGwgYSBKU09OUCBjYWxsYmFjayBmb3IgY2h1bmsgbG9hZGluZ1xuIFx0ZnVuY3Rpb24gd2VicGFja0pzb25wQ2FsbGJhY2soZGF0YSkge1xuIFx0XHR2YXIgY2h1bmtJZHMgPSBkYXRhWzBdO1xuIFx0XHR2YXIgbW9yZU1vZHVsZXMgPSBkYXRhWzFdO1xuIFx0XHR2YXIgZXhlY3V0ZU1vZHVsZXMgPSBkYXRhWzJdO1xuXG4gXHRcdC8vIGFkZCBcIm1vcmVNb2R1bGVzXCIgdG8gdGhlIG1vZHVsZXMgb2JqZWN0LFxuIFx0XHQvLyB0aGVuIGZsYWcgYWxsIFwiY2h1bmtJZHNcIiBhcyBsb2FkZWQgYW5kIGZpcmUgY2FsbGJhY2tcbiBcdFx0dmFyIG1vZHVsZUlkLCBjaHVua0lkLCBpID0gMCwgcmVzb2x2ZXMgPSBbXTtcbiBcdFx0Zm9yKDtpIDwgY2h1bmtJZHMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHRjaHVua0lkID0gY2h1bmtJZHNbaV07XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGluc3RhbGxlZENodW5rcywgY2h1bmtJZCkgJiYgaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdKSB7XG4gXHRcdFx0XHRyZXNvbHZlcy5wdXNoKGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSk7XG4gXHRcdFx0fVxuIFx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXSA9IDA7XG4gXHRcdH1cbiBcdFx0Zm9yKG1vZHVsZUlkIGluIG1vcmVNb2R1bGVzKSB7XG4gXHRcdFx0aWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcbiBcdFx0XHRcdG1vZHVsZXNbbW9kdWxlSWRdID0gbW9yZU1vZHVsZXNbbW9kdWxlSWRdO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRpZihwYXJlbnRKc29ucEZ1bmN0aW9uKSBwYXJlbnRKc29ucEZ1bmN0aW9uKGRhdGEpO1xuXG4gXHRcdHdoaWxlKHJlc29sdmVzLmxlbmd0aCkge1xuIFx0XHRcdHJlc29sdmVzLnNoaWZ0KCkoKTtcbiBcdFx0fVxuXG4gXHRcdC8vIGFkZCBlbnRyeSBtb2R1bGVzIGZyb20gbG9hZGVkIGNodW5rIHRvIGRlZmVycmVkIGxpc3RcbiBcdFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2guYXBwbHkoZGVmZXJyZWRNb2R1bGVzLCBleGVjdXRlTW9kdWxlcyB8fCBbXSk7XG5cbiBcdFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiBhbGwgY2h1bmtzIHJlYWR5XG4gXHRcdHJldHVybiBjaGVja0RlZmVycmVkTW9kdWxlcygpO1xuIFx0fTtcbiBcdGZ1bmN0aW9uIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCkge1xuIFx0XHR2YXIgcmVzdWx0O1xuIFx0XHRmb3IodmFyIGkgPSAwOyBpIDwgZGVmZXJyZWRNb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0dmFyIGRlZmVycmVkTW9kdWxlID0gZGVmZXJyZWRNb2R1bGVzW2ldO1xuIFx0XHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuIFx0XHRcdGZvcih2YXIgaiA9IDE7IGogPCBkZWZlcnJlZE1vZHVsZS5sZW5ndGg7IGorKykge1xuIFx0XHRcdFx0dmFyIGRlcElkID0gZGVmZXJyZWRNb2R1bGVbal07XG4gXHRcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbZGVwSWRdICE9PSAwKSBmdWxmaWxsZWQgPSBmYWxzZTtcbiBcdFx0XHR9XG4gXHRcdFx0aWYoZnVsZmlsbGVkKSB7XG4gXHRcdFx0XHRkZWZlcnJlZE1vZHVsZXMuc3BsaWNlKGktLSwgMSk7XG4gXHRcdFx0XHRyZXN1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IGRlZmVycmVkTW9kdWxlWzBdKTtcbiBcdFx0XHR9XG4gXHRcdH1cblxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0MDogMFxuIFx0fTtcblxuIFx0dmFyIGRlZmVycmVkTW9kdWxlcyA9IFtdO1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi93YWxsZXRcIjtcblxuIFx0dmFyIGpzb25wQXJyYXkgPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBcIl0gPSB3aW5kb3dbXCJ3ZWJwYWNrSnNvbnBcIl0gfHwgW107XG4gXHR2YXIgb2xkSnNvbnBGdW5jdGlvbiA9IGpzb25wQXJyYXkucHVzaC5iaW5kKGpzb25wQXJyYXkpO1xuIFx0anNvbnBBcnJheS5wdXNoID0gd2VicGFja0pzb25wQ2FsbGJhY2s7XG4gXHRqc29ucEFycmF5ID0ganNvbnBBcnJheS5zbGljZSgpO1xuIFx0Zm9yKHZhciBpID0gMDsgaSA8IGpzb25wQXJyYXkubGVuZ3RoOyBpKyspIHdlYnBhY2tKc29ucENhbGxiYWNrKGpzb25wQXJyYXlbaV0pO1xuIFx0dmFyIHBhcmVudEpzb25wRnVuY3Rpb24gPSBvbGRKc29ucEZ1bmN0aW9uO1xuXG5cbiBcdC8vIGFkZCBlbnRyeSBtb2R1bGUgdG8gZGVmZXJyZWQgbGlzdFxuIFx0ZGVmZXJyZWRNb2R1bGVzLnB1c2goWzYzLDEsNCwyLDMsNV0pO1xuIFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiByZWFkeVxuIFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZldGNoOyIsIm1vZHVsZS5leHBvcnRzID0gUnVuOyIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3Qgd2FsbGV0X3NlcnZpY2VfMSA9IHJlcXVpcmUoXCIuL3NlcnZpY2VzL3dhbGxldC1zZXJ2aWNlXCIpO1xuLy8gaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnbm9kZS1jb25maWctdHMnO1xuZnVuY3Rpb24gaGlkZSgpIHtcbiAgICBBcnJheS5mcm9tKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BhbmVsJykpXG4gICAgICAgIC5mb3JFYWNoKChwKSA9PiBwLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpO1xufVxuZnVuY3Rpb24gc2hvdyhwYW5lbCkge1xuICAgIGhpZGUoKTtcbiAgICBjb25zdCBwYW5lbEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYW5lbCk7XG4gICAgaWYgKHBhbmVsRWxlbWVudCkge1xuICAgICAgICBwYW5lbEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxufVxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGFzeW5jIChldmVudCkgPT4ge1xuICAgIHZhciBfYSwgX2I7XG4gICAgY29uc29sZS5sb2coJ0xPQURFRCcpO1xuICAgIGNvbnN0IHdhbGxldCA9IG5ldyB3YWxsZXRfc2VydmljZV8xLldhbGxldFNlcnZpY2UoKTtcbiAgICB3YWxsZXQub24oJ3Nob3cnLCAocGFuZWwpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ1NIT1c6JywgcGFuZWwpO1xuICAgICAgICBzaG93KHBhbmVsKTtcbiAgICB9KTtcbiAgICB3YWxsZXQub24oJ2hpZGUnLCAocGFuZWwpID0+IHtcbiAgICAgICAgaGlkZSgpO1xuICAgIH0pO1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHdhbGxldC5pbml0KCk7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9XG4gICAgKF9hID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ2luLWJ0bicpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBjb25zdCBoYW5kbGUgPSAoX2EgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbC1oYW5kbGUnKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnZhbHVlO1xuICAgICAgICBjb25zdCBwYXNzd29yZCA9IChfYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsLXBhc3N3b3JkJykpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi52YWx1ZTtcbiAgICAgICAgd2FsbGV0LmxvZ2luKGhhbmRsZSwgcGFzc3dvcmQpO1xuICAgIH0pO1xuICAgIChfYiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWdpc3Rlci1idG4nKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgICAgIGNvbnN0IGhhbmRsZSA9IChfYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyLWhhbmRsZScpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudmFsdWU7XG4gICAgICAgIGNvbnN0IGVtYWlsID0gKF9iID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ItZW1haWwnKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnZhbHVlO1xuICAgICAgICBjb25zdCBwYXNzd29yZCA9IChfYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyLXBhc3N3b3JkJykpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy52YWx1ZTtcbiAgICAgICAgd2FsbGV0LnJlZ2lzdGVyKGhhbmRsZSwgcGFzc3dvcmQsIGVtYWlsKTtcbiAgICB9KTtcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDEnKTtcbiAgICAvLyBlbGVtZW50LmlubmVySFRNTCA9IGAke2NvbmZpZy5jb25maWd9OiAke2NvbmZpZy5tb2RlfWA7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtZW50KTtcbn0pO1xuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLldhbGxldFNlcnZpY2UgPSB2b2lkIDA7XG5jb25zdCBic3ZfMSA9IHJlcXVpcmUoXCJic3ZcIik7XG5jb25zdCBub2RlX2NvbmZpZ190c18xID0gcmVxdWlyZShcIm5vZGUtY29uZmlnLXRzXCIpO1xuY29uc3QgcXVlcnlzdHJpbmcgPSByZXF1aXJlKFwicXVlcnlzdHJpbmdcIik7XG5jb25zdCB3YWxsZXRfMSA9IHJlcXVpcmUoXCJAa3Jvbm92ZXJzZS90b29scy9saWIvd2FsbGV0XCIpO1xuY29uc3QgcmVzdF9ibG9ja2NoYWluXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3Jlc3QtYmxvY2tjaGFpblwiKTtcbmNvbnN0IHJlc3Rfc3RhdGVfY2FjaGVfMSA9IHJlcXVpcmUoXCJAa3Jvbm92ZXJzZS90b29scy9saWIvc3RvcmFnZS9yZXN0LXN0YXRlLWNhY2hlXCIpO1xuY29uc3QgaW9yZWRpc19tb2NrXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL2lvcmVkaXMtbW9ja1wiKTtcbmNvbnN0IHNpZ25lZF9tZXNzYWdlXzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3NpZ25lZC1tZXNzYWdlXCIpO1xuY29uc3QgYXV0aF8xID0gcmVxdWlyZShcIkBrcm9ub3ZlcnNlL3Rvb2xzL2xpYi9hdXRoXCIpO1xuY29uc3QgZXZlbnRzXzEgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xuY29uc3Qgd3NfY2xpZW50XzEgPSByZXF1aXJlKFwiQGtyb25vdmVyc2UvdG9vbHMvbGliL3dzLWNsaWVudFwiKTtcbmNvbnN0IFJ1biA9IHJlcXVpcmUoJ0Brcm9ub3ZlcnNlL3J1bicpO1xubGV0IHF1ZXJ5UGFyYW1zID0ge307XG5jb25zdCB1cmxQYXJ0cyA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmLnNwbGl0KCc/Jyk7XG5pZiAodXJsUGFydHNbMV0pIHtcbiAgICBjb25zdCBbcXVlcnldID0gdXJsUGFydHNbMV0uc3BsaXQoJyMnKTtcbiAgICBxdWVyeVBhcmFtcyA9IHF1ZXJ5c3RyaW5nLmRlY29kZShxdWVyeSk7XG59XG5ic3ZfMS5Db25zdGFudHMuRGVmYXVsdCA9IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmsgPT09ICdtYWluJyA/IGJzdl8xLkNvbnN0YW50cy5NYWlubmV0IDogYnN2XzEuQ29uc3RhbnRzLlRlc3RuZXQ7XG5jb25zdCBic3YgPSByZXF1aXJlKCdic3YnKTtcbmJzdi5Db25zdGFudHMuRGVmYXVsdCA9IGJzdl8xLkNvbnN0YW50cy5EZWZhdWx0O1xuY29uc29sZS5sb2coJ0xPQUQnKTtcbmNsYXNzIFdhbGxldFNlcnZpY2UgZXh0ZW5kcyBldmVudHNfMS5FdmVudEVtaXR0ZXIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnByaW50TG9nID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcbiAgICAgICAgdGhpcy5wcmludEVycm9yID0gY29uc29sZS5lcnJvci5iaW5kKGNvbnNvbGUpO1xuICAgICAgICAvLyBwcml2YXRlIHJlcXVlc3RTZXJ2aWNlOiBSZXF1ZXN0U2VydmljZTtcbiAgICAgICAgdGhpcy5sb2dJZCA9IDA7XG4gICAgICAgIHRoaXMubG9ncyA9IFtdO1xuICAgICAgICB0aGlzLnNlc3Npb25JZCA9IGAke0RhdGUubm93KCl9LSR7TWF0aC5yYW5kb20oKSAqIE51bWJlci5NQVhfU0FGRV9JTlRFR0VSfWA7XG4gICAgICAgIHRoaXMudGltZUxhYmVscyA9IHt9O1xuICAgICAgICB0aGlzLmFwaVVybCA9IHF1ZXJ5UGFyYW1zLmFwaVVybCB8fCBub2RlX2NvbmZpZ190c18xLmNvbmZpZy5hcGlVcmw7XG4gICAgICAgIHRoaXMuZG9tYWluID0gZG9jdW1lbnQubG9jYXRpb24uaGFzaC5zbGljZSgxKS5zcGxpdCgnQCcpWzFdO1xuICAgICAgICB0aGlzLm92ZXJyaWRlQ29uc29sZSgpO1xuICAgICAgICB0aGlzLmF1dGggPSBuZXcgYXV0aF8xLktyb25vQXV0aCh0aGlzLmFwaVVybCwgdGhpcy5kb21haW4sIG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmspO1xuICAgIH1cbiAgICBnZXQgY2hhbm5lbCgpIHtcbiAgICAgICAgY29uc3QgdiA9IHdpbmRvdy52dXBsZXg7XG4gICAgICAgIHJldHVybiAodikgPyB2IDogd2luZG93O1xuICAgIH1cbiAgICBnZXQgY2hhbm5lbFNjb3BlKCkge1xuICAgICAgICBjb25zdCByZWYgPSBkb2N1bWVudC5yZWZlcnJlcjtcbiAgICAgICAgaWYgKHJlZiAmJiAhdGhpcy5pc0luVW5pdHkpIHtcbiAgICAgICAgICAgIHJldHVybiByZWYubWF0Y2goL14uKzpcXC9cXC9bXlxcL10rLylbMF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBnZXQgaXNJblVuaXR5KCkge1xuICAgICAgICByZXR1cm4gKHdpbmRvdy52dXBsZXgpID8gdHJ1ZSA6IGZhbHNlO1xuICAgIH1cbiAgICBnZXQgaGFuZGxlKCkge1xuICAgICAgICByZXR1cm4gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdIQU5ETEUnKSB8fCAnJztcbiAgICB9XG4gICAgc2V0IGhhbmRsZSh2YWx1ZSkge1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ0hBTkRMRScsIHZhbHVlKTtcbiAgICB9XG4gICAgZ2V0IGtleVBhaXIoKSB7XG4gICAgICAgIGNvbnN0IHdpZiA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnV0lGJyk7XG4gICAgICAgIGlmICghd2lmKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBic3ZfMS5LZXlQYWlyLmZyb21Qcml2S2V5KGJzdl8xLlByaXZLZXkuZnJvbVN0cmluZyh3aWYpKTtcbiAgICB9XG4gICAgc2V0IGtleVBhaXIoa2V5UGFpcikge1xuICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ1dJRicsIGtleVBhaXIucHJpdktleS50b1N0cmluZygpKTtcbiAgICB9XG4gICAgZ2V0IGFnZW50SWQoKSB7XG4gICAgICAgIHJldHVybiBkb2N1bWVudC5sb2NhdGlvbi5oYXNoLnNsaWNlKDEpLnNwbGl0KCdAJylbMF07XG4gICAgfVxuICAgIGdldCBwYXltYWlsKCkge1xuICAgICAgICByZXR1cm4gYCR7dGhpcy5oYW5kbGV9QCR7dGhpcy5kb21haW59YDtcbiAgICB9XG4gICAgYXN5bmMgaW5pdCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0lOSVQnKTtcbiAgICAgICAgbGV0IGluaXRpYWxpemVkID0gZmFsc2U7XG4gICAgICAgIHdoaWxlIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcGhlbWVyYWwgJiYgIWluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCksIDUwMDApKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmFwaVVybH0vaW5pdGlhbGl6ZWApO1xuICAgICAgICAgICAgaW5pdGlhbGl6ZWQgPSByZXNwLm9rICYmIGF3YWl0IHJlc3AuanNvbigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xpZW50RW1pdCgnV0FMTEVUX1JFQURZJyk7XG4gICAgICAgIHRoaXMuY2hhbm5lbC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5vbkNsaWVudEV2ZW50LmJpbmQodGhpcykpO1xuICAgICAgICBjb25zb2xlLmxvZygnQkxPQ0tDSEFJTjonLCB0aGlzLmFwaVVybCk7XG4gICAgICAgIGNvbnN0IHVybCA9IGAke3RoaXMuYXBpVXJsfS9hZ2VudHMvJHt0aGlzLmRvbWFpbn0vJHt0aGlzLmFnZW50SWR9YDtcbiAgICAgICAgY29uc29sZS5sb2coJ2ZldGNoaW5nOicsIHVybCk7XG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgICAgICBpZiAoIXJlc3Aub2spXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cmVzcC5zdGF0dXN9IC0gJHtyZXNwLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIHRoaXMuYWdlbnREZWYgPSBhd2FpdCByZXNwLmpzb24oKTtcbiAgICAgICAgaWYgKCF0aGlzLmFnZW50RGVmKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBR0VOVCBNSVNTSU5HJyk7XG4gICAgICAgIGlmIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcnJvckxvZykge1xuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvZ3MgPSB0aGlzLmxvZ3M7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dzID0gW107XG4gICAgICAgICAgICAgICAgaWYgKCFsb2dzLmxlbmd0aClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcnJvckxvZywge1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGxvZ3MpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwLm9rKVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cmVzcC5zdGF0dXN9IC0gJHtyZXNwLnN0YXR1c1RleHR9YCk7XG4gICAgICAgICAgICB9LCA1MDAwKTtcbiAgICAgICAgfVxuICAgICAgICAvLyB0aGlzLmVtaXQoJ3Nob3cnLCAnbG9naW4nKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ1NIT1cgTE9HSU4nKTtcbiAgICAgICAgaWYgKHRoaXMuYWdlbnREZWYuYW5vbnltb3VzKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5pdGlhbGl6ZVdhbGxldCgpO1xuICAgICAgICBpZiAoIW5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmVwaGVtZXJhbCAmJiAhdGhpcy5rZXlQYWlyKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50RW1pdCgnTk9fS0VZUycpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVXNlcigpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdMb2dpbiBFcnJvcjonLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhpcy5jbGllbnRFbWl0KCdOT19LRVlTJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZVdhbGxldChvd25lciwgcHVyc2UpIHtcbiAgICAgICAgY29uc3QgY2FjaGUgPSBuZXcgUnVuLkxvY2FsQ2FjaGUoeyBtYXhTaXplTUI6IDEwMCB9KTtcbiAgICAgICAgY29uc3QgYmxvY2tjaGFpbiA9IG5ldyByZXN0X2Jsb2NrY2hhaW5fMS5SZXN0QmxvY2tjaGFpbih0aGlzLmFwaVVybCwgbm9kZV9jb25maWdfdHNfMS5jb25maWcubmV0d29yaywgY2FjaGUpO1xuICAgICAgICBjb25zdCBydW4gPSBuZXcgUnVuKHtcbiAgICAgICAgICAgIG5ldHdvcms6IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLm5ldHdvcmssXG4gICAgICAgICAgICBvd25lcixcbiAgICAgICAgICAgIGJsb2NrY2hhaW4sXG4gICAgICAgICAgICBwdXJzZSxcbiAgICAgICAgICAgIGNhY2hlOiBuZXcgcmVzdF9zdGF0ZV9jYWNoZV8xLlJlc3RTdGF0ZUNhY2hlKHRoaXMuYXBpVXJsLCBjYWNoZSksXG4gICAgICAgICAgICBhcHA6IG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmFwcCB8fCAna3Jvbm92ZXJzZScsXG4gICAgICAgICAgICB0cnVzdDogJyonLFxuICAgICAgICAgICAgdGltZW91dDogNjAwMDAsXG4gICAgICAgICAgICBsb2dnZXI6IHtcbiAgICAgICAgICAgICAgICBlcnJvcjogY29uc29sZS5lcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgd2FsbGV0ID0gdGhpcy53YWxsZXQgPSBuZXcgd2FsbGV0XzEuV2FsbGV0KHRoaXMucGF5bWFpbCwgdGhpcy5rZXlQYWlyLCBydW4pO1xuICAgICAgICBjb25zdCBzdG9yYWdlID0gbmV3IGlvcmVkaXNfbW9ja18xLklPUmVkaXNNb2NrKCk7XG4gICAgICAgIGNvbnN0IGNoYW5uZWxzID0gW3RoaXMua2V5UGFpci5wdWJLZXkudG9TdHJpbmcoKV07XG4gICAgICAgIGlmIChub2RlX2NvbmZpZ190c18xLmNvbmZpZy5lcGhlbWVyYWwpXG4gICAgICAgICAgICBjaGFubmVscy5wdXNoKHJ1bi5vd25lci5hZGRyZXNzKTtcbiAgICAgICAgbGV0IHdzO1xuICAgICAgICBpZiAobm9kZV9jb25maWdfdHNfMS5jb25maWcuc29ja2V0cykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1NvY2tldHM6Jywgbm9kZV9jb25maWdfdHNfMS5jb25maWcuc29ja2V0cyk7XG4gICAgICAgICAgICB3cyA9IG5ldyB3c19jbGllbnRfMS5XU0NsaWVudChXZWJTb2NrZXQsIG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLnNvY2tldHMsIGNoYW5uZWxzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZygnRE9NQUlOOicsIHRoaXMuZG9tYWluKTtcbiAgICAgICAgY29uc29sZS5sb2coJ0FHRU5UX0lEOicsIHRoaXMuYWdlbnRJZCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdMT0M6JywgdGhpcy5hZ2VudERlZi5sb2NhdGlvbik7XG4gICAgICAgIGNvbnN0IEFnZW50ID0gYXdhaXQgcnVuLmxvYWQodGhpcy5hZ2VudERlZi5sb2NhdGlvbik7XG4gICAgICAgIGNvbnN0IGFnZW50ID0gdGhpcy5hZ2VudCA9IG5ldyBBZ2VudCh3YWxsZXQsIGJsb2NrY2hhaW4sIHN0b3JhZ2UsIGJzdiwgeyBmZXRjaCwgQnVmZmVyLCB3cywgU2lnbmVkTWVzc2FnZTogc2lnbmVkX21lc3NhZ2VfMS5TaWduZWRNZXNzYWdlIH0pO1xuICAgICAgICBhZ2VudC5vbignY2xpZW50JywgdGhpcy5jbGllbnRFbWl0LmJpbmQodGhpcykpO1xuICAgICAgICBhZ2VudC5vbignc3Vic2NyaWJlJywgKGNoYW5uZWwsIGxhc3RJZCkgPT4ge1xuICAgICAgICAgICAgd3Muc3Vic2NyaWJlKGNoYW5uZWwsIGxhc3RJZCk7XG4gICAgICAgIH0pO1xuICAgICAgICBhZ2VudC5vbigndW5zdWJzY3JpYmUnLCAoY2hhbm5lbCkgPT4ge1xuICAgICAgICAgICAgd3MudW5zdWJzY3JpYmUoY2hhbm5lbCk7XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCBhZ2VudC5pbml0KCk7XG4gICAgICAgIHRoaXMuY2xpZW50RW1pdCgnQUdFTlRfTE9BREVEJyk7XG4gICAgICAgIHdzLm9uKCdqaWcnLCAoamlnLCBjaGFubmVsKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnSklHOicsIEpTT04uc3RyaW5naWZ5KGppZykpO1xuICAgICAgICAgICAgYWdlbnQub25KaWcoamlnKS5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHdzLm9uKCdtc2cnLCAobWVzc2FnZSwgY2hhbm5lbCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ01TRzonLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG4gICAgICAgICAgICBhZ2VudC5vbk1lc3NhZ2UobmV3IHNpZ25lZF9tZXNzYWdlXzEuU2lnbmVkTWVzc2FnZShtZXNzYWdlKSkuY2F0Y2goY29uc29sZS5lcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBpbml0aWFsaXplVXNlcihoYW5kbGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0luaXRpYWxpemluZyBVc2VyJyk7XG4gICAgICAgIGlmIChoYW5kbGUpXG4gICAgICAgICAgICB0aGlzLmhhbmRsZSA9IGhhbmRsZTtcbiAgICAgICAgbGV0IGJpcDMyO1xuICAgICAgICBpZiAobm9kZV9jb25maWdfdHNfMS5jb25maWcuZXBoZW1lcmFsKSB7XG4gICAgICAgICAgICBiaXAzMiA9IGJzdl8xLkJpcDMyLmZyb21SYW5kb20oKTtcbiAgICAgICAgICAgIHRoaXMua2V5UGFpciA9IGJzdl8xLktleVBhaXIuZnJvbVByaXZLZXkoYmlwMzIucHJpdktleSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmVjb3ZlcmluZyBhY2NvdW50Jyk7XG4gICAgICAgICAgICBjb25zdCB4cHJpdiA9IGF3YWl0IHRoaXMuYXV0aC5yZWNvdmVyKHRoaXMucGF5bWFpbCwgdGhpcy5rZXlQYWlyKTtcbiAgICAgICAgICAgIGJpcDMyID0gYnN2XzEuQmlwMzIuZnJvbVN0cmluZyh4cHJpdik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplV2FsbGV0KGJpcDMyLmRlcml2ZSgnbS8xLzAnKS5wcml2S2V5LnRvU3RyaW5nKCksIGJpcDMyLmRlcml2ZSgnbS8wLzAnKS5wcml2S2V5LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBhc3luYyBsb2dpbihoYW5kbGUsIHBhc3N3b3JkKSB7XG4gICAgICAgIHRoaXMua2V5UGFpciA9IGF3YWl0IHRoaXMuYXV0aC5sb2dpbihoYW5kbGUsIHBhc3N3b3JkKTtcbiAgICAgICAgYXdhaXQgdGhpcy5pbml0aWFsaXplVXNlcihoYW5kbGUpO1xuICAgIH1cbiAgICBhc3luYyByZWdpc3RlcihoYW5kbGUsIHBhc3N3b3JkLCBlbWFpbCkge1xuICAgICAgICB0aGlzLmtleVBhaXIgPSBhd2FpdCB0aGlzLmF1dGgucmVnaXN0ZXIoaGFuZGxlLCBwYXNzd29yZCwgZW1haWwpO1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVVc2VyKGhhbmRsZSk7XG4gICAgfVxuICAgIGFzeW5jIGxvZ291dCgpIHtcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdXSUYnKTtcbiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdIQU5ETEUnKTtcbiAgICB9XG4gICAgYXN5bmMgb25DbGllbnRFdmVudChldmVudCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7fTtcbiAgICAgICAgaWYgKCF0aGlzLnRyeVBhcnNlTWVzc2FnZURhdGEoZXZlbnQuZGF0YSwgbWVzc2FnZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGlmIChbJ1JlZ2lzdGVyJywgJ0xvZ2luJ10uaW5jbHVkZXMobWVzc2FnZS5uYW1lKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFdBTExFVCBSRUNFSVZFRCBFVkVOVDpgLCBtZXNzYWdlLm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYFdBTExFVCBSRUNFSVZFRCBFVkVOVDpgLCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7XG4gICAgICAgICAgICBuYW1lOiBgT24ke21lc3NhZ2UubmFtZX1gXG4gICAgICAgIH07XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwYXlsb2FkID0gbWVzc2FnZS5wYXlsb2FkICYmIEpTT04ucGFyc2UobWVzc2FnZS5wYXlsb2FkKTtcbiAgICAgICAgICAgIHN3aXRjaCAobWVzc2FnZS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnUmVnaXN0ZXInOlxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJlZ2lzdGVyKHBheWxvYWQuaGFuZGxlLCBwYXlsb2FkLnBhc3N3b3JkLCBwYXlsb2FkLmVtYWlsKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTG9naW4nOlxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvZ2luKHBheWxvYWQuaGFuZGxlLCBwYXlsb2FkLnBhc3N3b3JkKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnTG9nb3V0JzpcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2dvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnQ2FzaG91dCc6XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy53YWxsZXQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dhbGxldCBub3QgaW5pdGlhbGl6ZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXdhaXQgdGhpcy53YWxsZXQuY2FzaG91dChwYXlsb2FkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGllbnRFbWl0KCdCYWxhbmNlVXBkYXRlZCcsIDApO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdJc0hhbmRsZUF2YWlsYWJsZSc6XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShhd2FpdCB0aGlzLmF1dGguaXNIYW5kbGVBdmFpbGFibGUocGF5bG9hZCkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYWdlbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FnZW50IG5vdCBpbml0aWFsaXplZCcpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAoKF9hID0gdGhpcy5hZ2VudCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm9uRXZlbnQobWVzc2FnZS5uYW1lLCBwYXlsb2FkKSk7XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLnBheWxvYWQgPSByZXN1bHQgJiYgSlNPTi5zdHJpbmdpZnkocmVzdWx0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlc3BvbnNlLnN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICByZXNwb25zZS5zdWNjZXNzID0gZmFsc2U7XG4gICAgICAgICAgICByZXNwb25zZS5wYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkoZS5tZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoJ05vdCBlbm91Z2ggZnVuZHMnKSkge1xuICAgICAgICAgICAgICAgIHJlc3BvbnNlLnN0YXR1c0NvZGUgPSA0MDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXNwb25zZS5zdGF0dXNDb2RlID0gZS5zdGF0dXMgfHwgNTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlLm5hbWUsIHJlc3BvbnNlLnBheWxvYWQpO1xuICAgICAgICB0aGlzLnBvc3RNZXNzYWdlKHJlc3BvbnNlKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0cnlQYXJzZU1lc3NhZ2VEYXRhKGRhdGEsIG91dEJ5UmVmKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSAob3V0QnlSZWYgfHwge30pO1xuICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKG1lc3NhZ2UsIEpTT04ucGFyc2UoQnVmZmVyLmZyb20oZGF0YSwgJ2Jhc2U2NCcpLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24obWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1lc3NhZ2UgJiYgbWVzc2FnZS5uYW1lO1xuICAgIH1cbiAgICBjbGllbnRFbWl0KG5hbWUsIHBheWxvYWQpIHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ0VtaXR0aW5nJywgbmFtZSwgcGF5bG9hZCAmJiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSk7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgcGF5bG9hZDogcGF5bG9hZCAmJiBKU09OLnN0cmluZ2lmeShwYXlsb2FkKSxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2dzLnB1c2goe1xuICAgICAgICAgICAgaWR4OiB0aGlzLmxvZ0lkKyssXG4gICAgICAgICAgICBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLFxuICAgICAgICAgICAgaGFuZGxlOiB0aGlzLmhhbmRsZSxcbiAgICAgICAgICAgIHR5cGU6ICdsb2cnLFxuICAgICAgICAgICAgdHM6IERhdGUubm93KCksXG4gICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICBwYXlsb2FkXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLnBvc3RNZXNzYWdlKG1lc3NhZ2UpO1xuICAgIH1cbiAgICBwb3N0TWVzc2FnZShtZXNzYWdlKSB7XG4gICAgICAgIG1lc3NhZ2UudGFyZ2V0ID0gJ2tyb25vdmVyc2UnO1xuICAgICAgICBpZiAodGhpcy5pc0luVW5pdHkpIHtcbiAgICAgICAgICAgIHRoaXMuY2hhbm5lbC5wb3N0TWVzc2FnZShtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmNoYW5uZWxTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5jaGFubmVsLnBhcmVudC5wb3N0TWVzc2FnZShtZXNzYWdlLCB0aGlzLmNoYW5uZWxTY29wZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb3ZlcnJpZGVDb25zb2xlKCkge1xuICAgICAgICBjb25zb2xlLmxvZyA9ICguLi5tZXNzYWdlcykgPT4ge1xuICAgICAgICAgICAgbWVzc2FnZXMudW5zaGlmdChEYXRlLm5vdygpKTtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBtZXNzYWdlcy5qb2luKCcgJyk7XG4gICAgICAgICAgICB0aGlzLmxvZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgaWR4OiB0aGlzLmxvZ0lkKyssXG4gICAgICAgICAgICAgICAgc2Vzc2lvbklkOiB0aGlzLnNlc3Npb25JZCxcbiAgICAgICAgICAgICAgICBwYXltYWlsOiB0aGlzLnBheW1haWwsXG4gICAgICAgICAgICAgICAgdHlwZTogJ2xvZycsXG4gICAgICAgICAgICAgICAgdHM6IERhdGUubm93KCksXG4gICAgICAgICAgICAgICAgbWVzc2FnZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAobm9kZV9jb25maWdfdHNfMS5jb25maWcuZW1pdExvZ3MpXG4gICAgICAgICAgICAgICAgdGhpcy5jbGllbnRFbWl0KCdMb2cnLCBtZXNzYWdlKTtcbiAgICAgICAgICAgIHRoaXMucHJpbnRMb2coLi4ubWVzc2FnZXMpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zb2xlLmVycm9yID0gKC4uLm1lc3NhZ2VzKSA9PiB7XG4gICAgICAgICAgICBtZXNzYWdlcy51bnNoaWZ0KERhdGUubm93KCkpO1xuICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IG1lc3NhZ2VzLmpvaW4oJyAnKTtcbiAgICAgICAgICAgIHRoaXMubG9ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZHg6IHRoaXMubG9nSWQrKyxcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IHRoaXMuc2Vzc2lvbklkLFxuICAgICAgICAgICAgICAgIHBheW1haWw6IHRoaXMucGF5bWFpbCxcbiAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgICAgICAgIHRzOiBEYXRlLm5vdygpLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKG5vZGVfY29uZmlnX3RzXzEuY29uZmlnLmVtaXRMb2dzKVxuICAgICAgICAgICAgICAgIHRoaXMuY2xpZW50RW1pdCgnRXJyb3InLCBtZXNzYWdlKTtcbiAgICAgICAgICAgIHRoaXMucHJpbnRFcnJvciguLi5tZXNzYWdlcyk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUudGltZSA9IChsYWJlbCkgPT4ge1xuICAgICAgICAgICAgdGhpcy50aW1lTGFiZWxzW2xhYmVsXSA9IERhdGUubm93KCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUudGltZUVuZCA9IChsYWJlbCkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYCR7bGFiZWx9OiAke0RhdGUubm93KCkgLSB0aGlzLnRpbWVMYWJlbHNbbGFiZWxdIHx8IDB9bXNgKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5leHBvcnRzLldhbGxldFNlcnZpY2UgPSBXYWxsZXRTZXJ2aWNlO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==